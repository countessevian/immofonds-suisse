"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4419],{70094:function(o,f,v){function _arrayLikeToArray(o,f){(null==f||f>o.length)&&(f=o.length);for(var v=0,P=Array(f);v<f;v++)P[v]=o[v];return P}function asyncGeneratorStep(o,f,v,P,k,S,A){try{var C=o[S](A),I=C.value}catch(o){return void v(o)}C.done?f(I):Promise.resolve(I).then(P,k)}function _asyncToGenerator(o){return function(){var f=this,v=arguments;return new Promise(function(P,k){var S=o.apply(f,v);function _next(o){asyncGeneratorStep(S,P,k,_next,_throw,"next",o)}function _throw(o){asyncGeneratorStep(S,P,k,_next,_throw,"throw",o)}_next(void 0)})}}function _callSuper(o,f,v){return f=_getPrototypeOf(f),function(o,f){if(f&&("object"==typeof f||"function"==typeof f))return f;if(void 0!==f)throw TypeError("Derived constructors may only return object or undefined");return function(o){if(void 0===o)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return o}(o)}(o,_isNativeReflectConstruct()?Reflect.construct(f,v||[],_getPrototypeOf(o).constructor):f.apply(o,v))}function _classCallCheck(o,f){if(!(o instanceof f))throw TypeError("Cannot call a class as a function")}function _defineProperties(o,f){for(var v=0;v<f.length;v++){var P=f[v];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(o,_toPropertyKey(P.key),P)}}function _createClass(o,f,v){return f&&_defineProperties(o.prototype,f),v&&_defineProperties(o,v),Object.defineProperty(o,"prototype",{writable:!1}),o}function _defineProperty(o,f,v){return(f=_toPropertyKey(f))in o?Object.defineProperty(o,f,{value:v,enumerable:!0,configurable:!0,writable:!0}):o[f]=v,o}function _get(){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(o,f,v){var P=function(o,f){for(;!({}).hasOwnProperty.call(o,f)&&null!==(o=_getPrototypeOf(o)););return o}(o,f);if(P){var k=Object.getOwnPropertyDescriptor(P,f);return k.get?k.get.call(arguments.length<3?o:v):k.value}}).apply(null,arguments)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _inherits(o,f){if("function"!=typeof f&&null!==f)throw TypeError("Super expression must either be null or a function");o.prototype=Object.create(f&&f.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),f&&_setPrototypeOf(o,f)}function _isNativeReflectConstruct(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(o){}return(_isNativeReflectConstruct=function(){return!!o})()}function ownKeys(o,f){var v=Object.keys(o);if(Object.getOwnPropertySymbols){var P=Object.getOwnPropertySymbols(o);f&&(P=P.filter(function(f){return Object.getOwnPropertyDescriptor(o,f).enumerable})),v.push.apply(v,P)}return v}function _objectSpread2(o){for(var f=1;f<arguments.length;f++){var v=null!=arguments[f]?arguments[f]:{};f%2?ownKeys(Object(v),!0).forEach(function(f){_defineProperty(o,f,v[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(v)):ownKeys(Object(v)).forEach(function(f){Object.defineProperty(o,f,Object.getOwnPropertyDescriptor(v,f))})}return o}function _regeneratorRuntime(){_regeneratorRuntime=function(){return f};var o,f={},v=Object.prototype,P=v.hasOwnProperty,k="function"==typeof Symbol?Symbol:{},S=k.iterator||"@@iterator",A=k.asyncIterator||"@@asyncIterator",C=k.toStringTag||"@@toStringTag";function c(o,f,v,P){return Object.defineProperty(o,f,{value:v,enumerable:!P,configurable:!P,writable:!P})}try{c({},"")}catch(o){c=function(o,f,v){return o[f]=v}}function h(f,v,P,k){var S,A,C=Object.create((v&&v.prototype instanceof Generator?v:Generator).prototype);return c(C,"_invoke",(S=new Context(k||[]),A=1,function(v,k){if(3===A)throw Error("Generator is already running");if(4===A){if("throw"===v)throw k;return{value:o,done:!0}}for(S.method=v,S.arg=k;;){var C=S.delegate;if(C){var T=function d(f,v){var P=v.method,k=f.i[P];if(k===o)return v.delegate=null,"throw"===P&&f.i.return&&(v.method="return",v.arg=o,d(f,v),"throw"===v.method)||"return"!==P&&(v.method="throw",v.arg=TypeError("The iterator does not provide a '"+P+"' method")),I;var S=s(k,f.i,v.arg);if("throw"===S.type)return v.method="throw",v.arg=S.arg,v.delegate=null,I;var A=S.arg;return A?A.done?(v[f.r]=A.value,v.next=f.n,"return"!==v.method&&(v.method="next",v.arg=o),v.delegate=null,I):A:(v.method="throw",v.arg=TypeError("iterator result is not an object"),v.delegate=null,I)}(C,S);if(T){if(T===I)continue;return T}}if("next"===S.method)S.sent=S._sent=S.arg;else if("throw"===S.method){if(1===A)throw A=4,S.arg;S.dispatchException(S.arg)}else"return"===S.method&&S.abrupt("return",S.arg);A=3;var O=s(f,P,S);if("normal"===O.type){if(A=S.done?4:2,O.arg===I)continue;return{value:O.arg,done:S.done}}"throw"===O.type&&(A=4,S.method="throw",S.arg=O.arg)}}),!0),C}function s(o,f,v){try{return{type:"normal",arg:o.call(f,v)}}catch(o){return{type:"throw",arg:o}}}f.wrap=h;var I={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var T={};c(T,S,function(){return this});var O=Object.getPrototypeOf,D=O&&O(O(x([])));D&&D!==v&&P.call(D,S)&&(T=D);var R=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(T);function g(o){["next","throw","return"].forEach(function(f){c(o,f,function(o){return this._invoke(f,o)})})}function AsyncIterator(o,f){var v;c(this,"_invoke",function(k,S){function i(){return new f(function(v,A){!function e(v,k,S,A){var C=s(o[v],o,k);if("throw"!==C.type){var I=C.arg,T=I.value;return T&&"object"==typeof T&&P.call(T,"__await")?f.resolve(T.__await).then(function(o){e("next",o,S,A)},function(o){e("throw",o,S,A)}):f.resolve(T).then(function(o){I.value=o,S(I)},function(o){return e("throw",o,S,A)})}A(C.arg)}(k,S,v,A)})}return v=v?v.then(i,i):i()},!0)}function w(o){this.tryEntries.push(o)}function m(f){var v=f[4]||{};v.type="normal",v.arg=o,f[4]=v}function Context(o){this.tryEntries=[[-1]],o.forEach(w,this),this.reset(!0)}function x(f){if(null!=f){var v=f[S];if(v)return v.call(f);if("function"==typeof f.next)return f;if(!isNaN(f.length)){var k=-1,a=function e(){for(;++k<f.length;)if(P.call(f,k))return e.value=f[k],e.done=!1,e;return e.value=o,e.done=!0,e};return a.next=a}}throw TypeError(typeof f+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,c(R,"constructor",GeneratorFunctionPrototype),c(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=c(GeneratorFunctionPrototype,C,"GeneratorFunction"),f.isGeneratorFunction=function(o){var f="function"==typeof o&&o.constructor;return!!f&&(f===GeneratorFunction||"GeneratorFunction"===(f.displayName||f.name))},f.mark=function(o){return Object.setPrototypeOf?Object.setPrototypeOf(o,GeneratorFunctionPrototype):(o.__proto__=GeneratorFunctionPrototype,c(o,C,"GeneratorFunction")),o.prototype=Object.create(R),o},f.awrap=function(o){return{__await:o}},g(AsyncIterator.prototype),c(AsyncIterator.prototype,A,function(){return this}),f.AsyncIterator=AsyncIterator,f.async=function(o,v,P,k,S){void 0===S&&(S=Promise);var A=new AsyncIterator(h(o,v,P,k),S);return f.isGeneratorFunction(v)?A:A.next().then(function(o){return o.done?o.value:A.next()})},g(R),c(R,C,"Generator"),c(R,S,function(){return this}),c(R,"toString",function(){return"[object Generator]"}),f.keys=function(o){var f=Object(o),v=[];for(var P in f)v.unshift(P);return function t(){for(;v.length;)if((P=v.pop())in f)return t.value=P,t.done=!1,t;return t.done=!0,t}},f.values=x,Context.prototype={constructor:Context,reset:function(f){if(this.prev=this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(m),!f)for(var v in this)"t"===v.charAt(0)&&P.call(this,v)&&!isNaN(+v.slice(1))&&(this[v]=o)},stop:function(){this.done=!0;var o=this.tryEntries[0][4];if("throw"===o.type)throw o.arg;return this.rval},dispatchException:function(f){if(this.done)throw f;var v=this;function n(o){S.type="throw",S.arg=f,v.next=o}for(var P=v.tryEntries.length-1;P>=0;--P){var k=this.tryEntries[P],S=k[4],A=this.prev,C=k[1],I=k[2];if(-1===k[0])return n("end"),!1;if(!C&&!I)throw Error("try statement without catch or finally");if(null!=k[0]&&k[0]<=A){if(A<C)return this.method="next",this.arg=o,n(C),!0;if(A<I)return n(I),!1}}},abrupt:function(o,f){for(var v=this.tryEntries.length-1;v>=0;--v){var P=this.tryEntries[v];if(P[0]>-1&&P[0]<=this.prev&&this.prev<P[2]){var k=P;break}}k&&("break"===o||"continue"===o)&&k[0]<=f&&f<=k[2]&&(k=null);var S=k?k[4]:{};return S.type=o,S.arg=f,k?(this.method="next",this.next=k[2],I):this.complete(S)},complete:function(o,f){if("throw"===o.type)throw o.arg;return"break"===o.type||"continue"===o.type?this.next=o.arg:"return"===o.type?(this.rval=this.arg=o.arg,this.method="return",this.next="end"):"normal"===o.type&&f&&(this.next=f),I},finish:function(o){for(var f=this.tryEntries.length-1;f>=0;--f){var v=this.tryEntries[f];if(v[2]===o)return this.complete(v[4],v[3]),m(v),I}},catch:function(o){for(var f=this.tryEntries.length-1;f>=0;--f){var v=this.tryEntries[f];if(v[0]===o){var P=v[4];if("throw"===P.type){var k=P.arg;m(v)}return k}}throw Error("illegal catch attempt")},delegateYield:function(f,v,P){return this.delegate={i:x(f),r:v,n:P},"next"===this.method&&(this.arg=o),I}},f}function _setPrototypeOf(o,f){return(_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,f){return o.__proto__=f,o})(o,f)}function _slicedToArray(o,f){return function(o){if(Array.isArray(o))return o}(o)||function(o,f){var v=null==o?null:"undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(null!=v){var P,k,S,A,C=[],I=!0,T=!1;try{if(S=(v=v.call(o)).next,0===f);else for(;!(I=(P=S.call(v)).done)&&(C.push(P.value),C.length!==f);I=!0);}catch(o){T=!0,k=o}finally{try{if(!I&&null!=v.return&&(A=v.return(),Object(A)!==A))return}finally{if(T)throw k}}return C}}(o,f)||_unsupportedIterableToArray(o,f)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _superPropGet(o,f,v,P){var k=_get(_getPrototypeOf(o.prototype),f,v);return 2&P&&"function"==typeof k?function(o){return k.apply(v,o)}:k}function _toConsumableArray(o){return function(o){if(Array.isArray(o))return _arrayLikeToArray(o)}(o)||function(o){if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator]||null!=o["@@iterator"])return Array.from(o)}(o)||_unsupportedIterableToArray(o)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toPropertyKey(o){var f=function(o,f){if("object"!=typeof o||!o)return o;var v=o[Symbol.toPrimitive];if(void 0!==v){var P=v.call(o,f);if("object"!=typeof P)return P;throw TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(o,"string");return"symbol"==typeof f?f:f+""}function _typeof(o){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o})(o)}function _unsupportedIterableToArray(o,f){if(o){if("string"==typeof o)return _arrayLikeToArray(o,f);var v=({}).toString.call(o).slice(8,-1);return"Object"===v&&o.constructor&&(v=o.constructor.name),"Map"===v||"Set"===v?Array.from(o):"Arguments"===v||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v)?_arrayLikeToArray(o,f):void 0}}function _isPlaceholder(o){return null!=o&&"object"===_typeof(o)&&!0===o["@@functional/placeholder"]}function _curry1(o){return function f1(f){return 0==arguments.length||_isPlaceholder(f)?f1:o.apply(this,arguments)}}function _curry2(o){return function f2(f,v){switch(arguments.length){case 0:return f2;case 1:return _isPlaceholder(f)?f2:_curry1(function(v){return o(f,v)});default:return _isPlaceholder(f)&&_isPlaceholder(v)?f2:_isPlaceholder(f)?_curry1(function(f){return o(f,v)}):_isPlaceholder(v)?_curry1(function(v){return o(f,v)}):o(f,v)}}}function _curry3(o){return function f3(f,v,P){switch(arguments.length){case 0:return f3;case 1:return _isPlaceholder(f)?f3:_curry2(function(v,P){return o(f,v,P)});case 2:return _isPlaceholder(f)&&_isPlaceholder(v)?f3:_isPlaceholder(f)?_curry2(function(f,P){return o(f,v,P)}):_isPlaceholder(v)?_curry2(function(v,P){return o(f,v,P)}):_curry1(function(P){return o(f,v,P)});default:return _isPlaceholder(f)&&_isPlaceholder(v)&&_isPlaceholder(P)?f3:_isPlaceholder(f)&&_isPlaceholder(v)?_curry2(function(f,v){return o(f,v,P)}):_isPlaceholder(f)&&_isPlaceholder(P)?_curry2(function(f,P){return o(f,v,P)}):_isPlaceholder(v)&&_isPlaceholder(P)?_curry2(function(v,P){return o(f,v,P)}):_isPlaceholder(f)?_curry1(function(f){return o(f,v,P)}):_isPlaceholder(v)?_curry1(function(v){return o(f,v,P)}):_isPlaceholder(P)?_curry1(function(P){return o(f,v,P)}):o(f,v,P)}}}function _has(o,f){return Object.prototype.hasOwnProperty.call(f,o)}v.d(f,{T:function(){return a3}});var P,k,S,A,C,I,T,O,D,R,N,M,L,B,U,j,G,z,H,V=_curry1(function(o){return null===o?"Null":void 0===o?"Undefined":Object.prototype.toString.call(o).slice(8,-1)});function _isObject(o){return"[object Object]"===Object.prototype.toString.call(o)}for(var Q,K,$=Number.isInteger||function(o){return o<<0===o},W=function(){function _ObjectMap(){this.map={},this.length=0}return _ObjectMap.prototype.set=function(o,f){var v=this.hash(o),P=this.map[v];P||(this.map[v]=P=[]),P.push([o,f]),this.length+=1},_ObjectMap.prototype.hash=function(o){var f=[];for(var v in o)f.push(Object.prototype.toString.call(o[v]));return f.join()},_ObjectMap.prototype.get=function(o){if(this.length<=180){for(var f in this.map)for(var v=this.map[f],P=0;P<v.length;P+=1){var k=v[P];if(k[0]===o)return k[1]}return}var S=this.hash(o),v=this.map[S];if(v)for(var P=0;P<v.length;P+=1){var k=v[P];if(k[0]===o)return k[1]}},_ObjectMap}(),q=_curry1(function(o){return null!=o&&"function"==typeof o.clone?o.clone():function _clone(o,f,v){if(v||(v=new W),P=_typeof(o),null==o||"object"!=P&&"function"!=P)return o;var P,copy=function(f){var P=v.get(o);if(P)return P;for(var k in v.set(o,f),o)Object.prototype.hasOwnProperty.call(o,k)&&(f[k]=_clone(o[k],!0,v));return f};switch(V(o)){case"Object":return copy(Object.create(Object.getPrototypeOf(o)));case"Array":return copy(Array(o.length));case"Date":return new Date(o.valueOf());case"RegExp":return new RegExp(o.source,o.flags?o.flags:(o.global?"g":"")+(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.sticky?"y":"")+(o.unicode?"u":"")+(o.dotAll?"s":""));case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":return o.slice();default:return o}}(o)}),X=_curry3(function(o,f,v){var P,k={};for(P in v=v||{},f=f||{})_has(P,f)&&(k[P]=_has(P,v)?o(P,f[P],v[P]):f[P]);for(P in v)_has(P,v)&&!_has(P,k)&&(k[P]=v[P]);return k}),J=_curry3(function mergeDeepWithKey(o,f,v){return X(function(f,v,P){return _isObject(v)&&_isObject(P)?mergeDeepWithKey(o,v,P):o(f,v,P)},f,v)}),Y=_curry3(function(o,f,v){return J(function(f,v,P){return o(v,P)},f,v)}),Z=_curry2(function(o,f){for(var v=f,P=0;P<o.length;P+=1){if(null==v)return;var k=o[P];v=$(k)?function(o,f){var v=o<0?f.length+o:o;return"[object String]"===Object.prototype.toString.call(f)?f.charAt(v):f[v]}(k,v):v[k]}return v}),ee=_curry2(function(o,f){var v={};for(var P in f)o(f[P],P,f)&&(v[P]=f[P]);return v}),isFunction=function(o){return"function"==typeof o&&!!(o.constructor&&o.call&&o.apply)},isString=function(o){return"string"==typeof o},isNull=function(o){return null===o},isUndefined=function(o){return void 0===o},isNullOrUndefined=function(o){return isNull(o)||isUndefined(o)},isDefined=function(o){return!isUndefined(o)},isDefinedAndNotNull=function(o){return!isNullOrUndefined(o)},isTypeOfError=function(o){switch(Object.prototype.toString.call(o)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return o instanceof Error}},getValueByPath=function(o,f){return Z(f.split("."),o)},isObjectLiteralAndNotNull=function(o){return!isNull(o)&&"[object Object]"===Object.prototype.toString.call(o)},mergeDeepRightObjectArrays=function(o,f){if(!Array.isArray(o)||!Array.isArray(f))return q(f);var v=q(o);return f.forEach(function(o,f){v[f]=!Array.isArray(o)&&(isNull(o)||"object"!==_typeof(o)||Array.isArray(o))?o:mergeDeepRight(v[f],o)}),v},mergeDeepRight=function(o,f){return Y(mergeDeepRightObjectArrays,o,f)},isNonEmptyObject=function(o){return isObjectLiteralAndNotNull(o)&&Object.keys(o).length>0},_removeUndefinedValues=function(o){var f=ee(isDefined,o);return Object.keys(f).forEach(function(o){var v=f[o];isObjectLiteralAndNotNull(v)&&(f[o]=_removeUndefinedValues(v))}),f},_removeUndefinedAndNullValues=function(o){var f=ee(isDefinedAndNotNull,o);return Object.keys(f).forEach(function(o){var v=f[o];isObjectLiteralAndNotNull(v)&&(f[o]=_removeUndefinedAndNullValues(v))}),f},getNormalizedObjectValue=function(o){if(isNonEmptyObject(o))return _removeUndefinedAndNullValues(o)},getNormalizedBooleanValue=function(o,f){return"boolean"==typeof o?o:f},removeLeadingPeriod=function(o){return o.replace(/^\.+/,"")},tryStringify=function(o){var f=o;if(!isString(o)&&!isNullOrUndefined(o))try{f=JSON.stringify(o)}catch(o){f=null}return f},base64ToBytes=function(o){var f=globalThis.atob(o).split("").map(function(o){return o.charCodeAt(0)});return new Uint8Array(f)},toBase64=function(o){return globalThis.btoa(Array.from(new TextEncoder().encode(o),function(o){return String.fromCodePoint(o)}).join(""))},fromBase64=function(o){return new TextDecoder().decode(base64ToBytes(o))},pageArgumentsToCallOptions=function(o,f,v,P,k){var S={category:o,name:f,properties:v,options:P,callback:void 0};isFunction(k)&&(S.callback=k),isFunction(P)&&(S.category=o,S.name=f,S.properties=v,S.options=void 0,S.callback=P),isFunction(v)&&(S.category=o,S.name=f,S.properties=void 0,S.options=void 0,S.callback=v),isFunction(f)&&(S.category=o,S.name=void 0,S.properties=void 0,S.options=void 0,S.callback=f),isFunction(o)&&(S.category=void 0,S.name=void 0,S.properties=void 0,S.options=void 0,S.callback=o),isObjectLiteralAndNotNull(o)?(S.name=void 0,S.category=void 0,S.properties=o,isFunction(f)?S.options=void 0:S.options=f):isObjectLiteralAndNotNull(f)&&(S.name=void 0,S.properties=f,isFunction(v)?S.options=void 0:S.options=v),isString(o)&&!isString(f)&&(S.category=void 0,S.name=o),isDefined(S.category)||(S.category=void 0),isDefined(S.name)||(S.name=void 0),S.properties=S.properties?q(S.properties):{},isDefined(S.options)?S.options=q(S.options):S.options=void 0;var A=isString(S.name)?S.name:S.properties.name,C=isString(S.category)?S.category:S.properties.category;return S.properties=mergeDeepRight(isObjectLiteralAndNotNull(S.properties)?S.properties:{},_objectSpread2(_objectSpread2({},A&&{name:A}),C&&{category:C})),S},trackArgumentsToCallOptions=function(o,f,v,P){var k={name:o,properties:f,options:v,callback:void 0};return isFunction(P)&&(k.callback=P),isFunction(v)&&(k.properties=f,k.options=void 0,k.callback=v),isFunction(f)&&(k.properties=void 0,k.options=void 0,k.callback=f),k.properties=isDefinedAndNotNull(k.properties)?q(k.properties):{},isDefined(k.options)?k.options=q(k.options):k.options=void 0,k},identifyArgumentsToCallOptions=function(o,f,v,P){var k={userId:o,traits:f,options:v,callback:void 0};return isFunction(P)&&(k.callback=P),isFunction(v)&&(k.userId=o,k.traits=f,k.options=void 0,k.callback=v),isFunction(f)&&(k.userId=o,k.traits=void 0,k.options=void 0,k.callback=f),(isObjectLiteralAndNotNull(o)||isNull(o))&&(k.userId=null,k.traits=o,isFunction(f)?k.options=void 0:k.options=f),k.userId=tryStringify(k.userId),isObjectLiteralAndNotNull(k.traits)?k.traits=q(k.traits):k.traits=void 0,isDefined(k.options)?k.options=q(k.options):k.options=void 0,k},aliasArgumentsToCallOptions=function(o,f,v,P){var k={to:o,from:f,options:v,callback:void 0};return isFunction(P)&&(k.callback=P),isFunction(v)&&(k.to=o,k.from=f,k.options=void 0,k.callback=v),isFunction(f)?(k.to=o,k.from=void 0,k.options=void 0,k.callback=f):(isObjectLiteralAndNotNull(f)||isNull(f))&&(k.to=o,k.from=void 0,k.options=f),isDefined(k.to)&&(k.to=tryStringify(k.to)),isDefined(k.from)?k.from=tryStringify(k.from):k.from=void 0,isDefined(k.options)?k.options=q(k.options):k.options=void 0,k},groupArgumentsToCallOptions=function(o,f,v,P){var k={groupId:o,traits:f,options:v,callback:void 0};return isFunction(P)&&(k.callback=P),isFunction(v)&&(k.groupId=o,k.traits=f,k.options=void 0,k.callback=v),isFunction(f)&&(k.groupId=o,k.traits=void 0,k.options=void 0,k.callback=f),(isObjectLiteralAndNotNull(o)||isNull(o))&&(k.groupId=null,k.traits=o,isFunction(f)?k.options=void 0:k.options=f),k.groupId=tryStringify(k.groupId),isObjectLiteralAndNotNull(k.traits)?k.traits=q(k.traits):k.traits=void 0,isDefined(k.options)?k.options=q(k.options):k.options=void 0,k},et=((Q={}).UNLOADED="Page Unloaded",Q),en="CapabilitiesManager",er="ConfigManager",ei="EventManager",eo="PluginsManager",ea="UserSessionManager",es="ErrorHandler",el="PluginEngine",eu="Ready".concat("API"),ec="Load".concat("API"),ed="AnalyticsCore",ef=[],eg=0;eg<256;eg++)ef[eg]=(eg+256).toString(16).substring(1);for(var ev,ep=256,eh=[];ep--;)eh[ep]=(ep+256).toString(16).substring(1);var generateUUID=function(){return!isNullOrUndefined(globalThis.crypto)&&isFunction(globalThis.crypto.getRandomValues)?function(){(!K||eg+16>4096)&&(K=crypto.getRandomValues(new Uint8Array(4096)),eg=0);for(var o,f=0,v="";f<16;f++)o=K[eg+f],6==f?v+=ef[15&o|64]:8==f?v+=ef[63&o|128]:v+=ef[o],1&f&&f>1&&f<11&&(v+="-");return eg+=16,v}():function(){var o,f=0,v="";if(!ev||ep+16>256){for(ev=Array(f=256);f--;)ev[f]=256*Math.random()|0;f=ep=0}for(;f<16;f++)o=ev[ep+f],6==f?v+=eh[15&o|64]:8==f?v+=eh[63&o|128]:v+=eh[o],1&f&&f>1&&f<11&&(v+="-");return ep++,v}()},onPageLeave=function(o){var f=!1,v=!1;function handleOnLeave(){f||(f=!0,o(v),setTimeout(function(){f=!1},0))}globalThis.addEventListener("beforeunload",function(){v=!1,handleOnLeave()}),globalThis.addEventListener("blur",function(){v=!0,handleOnLeave()}),globalThis.addEventListener("focus",function(){f=!1}),document.addEventListener("pagehide",function(){v="hidden"===document.visibilityState,handleOnLeave()}),document.addEventListener("visibilitychange",function(){v=!0,"hidden"===document.visibilityState?handleOnLeave():f=!1})},getFormattedTimestamp=function(o){return o.toISOString()},getCurrentTimeFormatted=function(){return getFormattedTimestamp(new Date)},SCRIPT_LOAD_ERROR=function(o,f){return'Failed to load the script with the id "'.concat(o,'" from URL "').concat(f,'".')},ey="[Circular Reference]",getCircularReplacer=function(o,f,v){var P=[];return function(k,S){if(!(null!=f&&f.includes(k)||o&&isNullOrUndefined(S))){if("object"!==_typeof(S)||isNull(S))return S;for(;P.length>0&&P[P.length-1]!==this;)P.pop();return P.includes(S)?(null==v||v.warn("".concat("JSONStringify").concat(":: ",'A circular reference has been detected in the object and the property "').concat(k,'" has been dropped from the output.')),ey):(P.push(S),S)}}},stringifyWithoutCircular=function(o,f,v,P){try{return JSON.stringify(o,getCircularReplacer(f,v,P))}catch(o){return null==P||P.warn("Failed to convert the value to a JSON string.",o),null}},getReplacer=function(o){var f=[];return function(o,v){if("bigint"==typeof v)return"[BigInt]";for(;f.length>0&&f[f.length-1]!==this;)f.pop();return f.includes(v)?ey:(f.push(v),v)}},_traverseWithThis=function(o,f){var v=Array.isArray(o)?[]:{};for(var P in o)if(Object.hasOwnProperty.call(o,P)){var k=o[P],S=f.call(o,P,k);isObjectLiteralAndNotNull(S)||Array.isArray(S)?v[P]=_traverseWithThis(S,f):v[P]=S}return v},getSanitizedValue=function(o,f){var v=getReplacer(),P=v.call(o,"",o);return isObjectLiteralAndNotNull(o)||Array.isArray(o)?_traverseWithThis(o,v):P},em="[SDK DISPATCHED ERROR]",getStacktrace=function(o){var f,v=o.stack,P=o.stacktrace,k=o["opera#sourceloc"],S=null!==(f=null!=v?v:P)&&void 0!==f?f:k;if(S&&"string"==typeof S)return S},getMutatedError=function(o,f){var v=o;return isTypeOfError(o)?v.message="".concat(f,": ").concat(o.message):v=Error("".concat(f,": ").concat(stringifyWithoutCircular(o))),v},dispatchErrorEvent=function(o){if(isTypeOfError(o)){var f=getStacktrace(o);if(f){var v=o.stack,P=o.stacktrace,k=o["opera#sourceloc"];switch(f){case v:o.stack="".concat(v,"\n").concat(em);break;case P:o.stacktrace="".concat(P,"\n").concat(em);break;default:o["opera#sourceloc"]="".concat(k,"\n").concat(em)}}}globalThis.dispatchEvent(new ErrorEvent("error",{error:o,bubbles:!0,cancelable:!0,composed:!0}))},e_="RudderLabs JavaScript SDK",eP="3.18.1",eb="RudderJS-Initiated",ek="preloadedEventsBuffer",eS="ajs_aid",eE="ajs_uid",eA="ajs_event",createExposedGlobals=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"app";globalThis.RudderStackGlobals||(globalThis.RudderStackGlobals={}),globalThis.RudderStackGlobals[o]||(globalThis.RudderStackGlobals[o]={})},setExposedGlobal=function(o,f){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"app";createExposedGlobals(v),globalThis.RudderStackGlobals[v][o]=f},getExposedGlobal=function(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"app";return createExposedGlobals(f),globalThis.RudderStackGlobals[f][o]},getEventDataFromQueryString=function(o,f){var v={};return o.forEach(function(P,k){k.startsWith(f)&&(v[k.substring(f.length)]=o.get(k))}),v},retrieveEventsFromQueryString=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],f={trait:"ajs_trait_",properties:"ajs_prop_"},v=new URLSearchParams(globalThis.location.search);v.get(eA)&&o.unshift(["track",v.get(eA),getEventDataFromQueryString(v,f.properties)]),v.get(eE)&&o.unshift(["identify",v.get(eE),getEventDataFromQueryString(v,f.trait)]),v.get(eS)&&o.unshift(["setAnonymousId",v.get(eS)])},getPreloadedLoadEvent=function(o){for(var f=[],v=0;v<o.length;){if(o[v]&&"load"===o[v][0]){f=q(o[v]),o.splice(v,1);break}v+=1}return f},promotePreloadedConsentEventsToTop=function(o){var f="consent",v=o.filter(function(o){return o[0]===f}),P=o.filter(function(o){return o[0]!==f});o.splice.apply(o,[0,o.length].concat(_toConsumableArray(v),_toConsumableArray(P)))},retrievePreloadBufferEvents=function(o){var f=getExposedGlobal(ek)||[];retrieveEventsFromQueryString(f),f.length>0&&(o.enqueuePreloadBufferEvents(f),setExposedGlobal(ek,[]))},consumePreloadBufferedEvent=function(o,f){var v,P=o.shift();if(isFunction(f[P])){switch(P){case"page":v=pageArgumentsToCallOptions.apply(void 0,_toConsumableArray(o));break;case"track":v=trackArgumentsToCallOptions.apply(void 0,_toConsumableArray(o));break;case"identify":v=identifyArgumentsToCallOptions.apply(void 0,_toConsumableArray(o));break;case"alias":v=aliasArgumentsToCallOptions.apply(void 0,_toConsumableArray(o));break;case"group":v=groupArgumentsToCallOptions.apply(void 0,_toConsumableArray(o));break;default:f[P].apply(f,_toConsumableArray(o))}v&&f[P](v)}},createScriptElement=function(o,f){var v=!(arguments.length>2)||void 0===arguments[2]||arguments[2],P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,k=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,S=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},A=document.createElement("script");return A.type="text/javascript",A.onload=P,A.onerror=k,A.src=o,A.id=f,A.async=v,Object.keys(S).forEach(function(o){A.setAttribute(o,S[o])}),A.setAttribute("data-loader","RS_JS_SDK"),A},insertScript=function(o){var f,v,P,k,S=document.getElementsByTagName("head");if(S.length>0){null===(v=S[0])||void 0===v||v.insertBefore(o,null===(P=S[0])||void 0===P?void 0:P.firstChild);return}var A=document.getElementsByTagName("script");if(A.length>0&&null!==(f=A[0])&&void 0!==f&&f.parentNode){null===(k=A[0])||void 0===k||k.parentNode.insertBefore(o,A[0]);return}var C=document.createElement("head");C.appendChild(o);var I=document.getElementsByTagName("html")[0];null==I||I.insertBefore(C,I.firstChild)},jsFileLoader=function(o,f,v){var P=!(arguments.length>3)||void 0===arguments[3]||arguments[3],k=arguments.length>4?arguments[4]:void 0;return new Promise(function(S,A){var C;document.getElementById(f)&&A(Error('A script with the id "'.concat(f,'" is already loaded. Skipping the loading of this script to prevent conflicts.')));try{insertScript(createScriptElement(o,f,P,function(){globalThis.clearTimeout(C),S(f)},function(){globalThis.clearTimeout(C),A(Error(SCRIPT_LOAD_ERROR(f,o)))},k)),C=globalThis.setTimeout(function(){A(Error("A timeout of ".concat(v,' ms occurred while trying to load the script with id "').concat(f,'" from URL "').concat(o,'".')))},v)}catch(v){A(getMutatedError(v,SCRIPT_LOAD_ERROR(f,o)))}})},eC=_createClass(function ExternalSrcLoader(o,f){var v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4;_classCallCheck(this,ExternalSrcLoader),this.errorHandler=o,this.logger=f,this.timeout=v,this.onError=this.onError.bind(this)},[{key:"loadJSFile",value:function(o){var f=this,v=o.url,P=o.id,k=o.timeout,S=o.async,A=o.callback,C=o.extraAttributes,I=!isFunction(A);jsFileLoader(v,P,k||this.timeout,S,C).then(function(o){I||A(o)}).catch(function(o){f.onError(o),I||A()})}},{key:"onError",value:function(o){this.errorHandler.onError(o,"ExternalSrcLoader")}}]),eI=Symbol.for("preact-signals");function t$1(){if(eD>1)eD--;else{for(var o,f=!1;void 0!==eO;){var v=eO;for(eO=void 0,eR++;void 0!==v;){var P=v.o;if(v.o=void 0,v.f&=-3,!(8&v.f)&&c(v))try{v.c()}catch(v){f||(o=v,f=!0)}v=P}}if(eR=0,eD--,f)throw o}}function r(o){if(eD>0)return o();eD++;try{return o()}finally{t$1()}}var eT=void 0,eO=void 0,eD=0,eR=0,ew=0;function e(o){if(void 0!==eT){var f=o.n;if(void 0===f||f.t!==eT)return f={i:0,S:o,p:eT.s,n:void 0,t:eT,e:void 0,x:void 0,r:f},void 0!==eT.s&&(eT.s.n=f),eT.s=f,o.n=f,32&eT.f&&o.S(f),f;if(-1===f.i)return f.i=0,void 0!==f.n&&(f.n.p=f.p,void 0!==f.p&&(f.p.n=f.n),f.p=eT.s,f.n=void 0,eT.s.n=f,eT.s=f),f}}function u(o){this.v=o,this.i=0,this.n=void 0,this.t=void 0}function d$1(o){return new u(o)}function c(o){for(var f=o.s;void 0!==f;f=f.n)if(f.S.i!==f.i||!f.S.h()||f.S.i!==f.i)return!0;return!1}function a(o){for(var f=o.s;void 0!==f;f=f.n){var v=f.S.n;if(void 0!==v&&(f.r=v),f.S.n=f,f.i=-1,void 0===f.n){o.s=f;break}}}function l(o){for(var f=o.s,v=void 0;void 0!==f;){var P=f.p;-1===f.i?(f.S.U(f),void 0!==P&&(P.n=f.n),void 0!==f.n&&(f.n.p=P)):v=f,f.S.n=f.r,void 0!==f.r&&(f.r=void 0),f=P}o.s=v}function y(o){u.call(this,void 0),this.x=o,this.s=void 0,this.g=ew-1,this.f=4}function _(o){var f=o.u;if(o.u=void 0,"function"==typeof f){eD++;var v=eT;eT=void 0;try{f()}catch(f){throw o.f&=-2,o.f|=8,g(o),f}finally{eT=v,t$1()}}}function g(o){for(var f=o.s;void 0!==f;f=f.n)f.S.U(f);o.x=void 0,o.s=void 0,_(o)}function p(o){if(eT!==this)throw Error("Out-of-order effect");l(this),eT=o,this.f&=-2,8&this.f&&g(this),t$1()}function b(o){this.x=o,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}function E(o){var f=new b(o);try{f.c()}catch(o){throw f.d(),o}return f.d.bind(f)}u.prototype.brand=eI,u.prototype.h=function(){return!0},u.prototype.S=function(o){this.t!==o&&void 0===o.e&&(o.x=this.t,void 0!==this.t&&(this.t.e=o),this.t=o)},u.prototype.U=function(o){if(void 0!==this.t){var f=o.e,v=o.x;void 0!==f&&(f.x=v,o.e=void 0),void 0!==v&&(v.e=f,o.x=void 0),o===this.t&&(this.t=v)}},u.prototype.subscribe=function(o){var f=this;return E(function(){var v=f.value,P=eT;eT=void 0;try{o(v)}finally{eT=P}})},u.prototype.valueOf=function(){return this.value},u.prototype.toString=function(){return this.value+""},u.prototype.toJSON=function(){return this.value},u.prototype.peek=function(){var o=eT;eT=void 0;try{return this.value}finally{eT=o}},Object.defineProperty(u.prototype,"value",{get:function(){var o=e(this);return void 0!==o&&(o.i=this.i),this.v},set:function(o){if(o!==this.v){if(eR>100)throw Error("Cycle detected");this.v=o,this.i++,ew++,eD++;try{for(var f=this.t;void 0!==f;f=f.x)f.t.N()}finally{t$1()}}}}),(y.prototype=new u).h=function(){if(this.f&=-3,1&this.f)return!1;if(32==(36&this.f)||(this.f&=-5,this.g===ew))return!0;if(this.g=ew,this.f|=1,this.i>0&&!c(this))return this.f&=-2,!0;var o=eT;try{a(this),eT=this;var f=this.x();(16&this.f||this.v!==f||0===this.i)&&(this.v=f,this.f&=-17,this.i++)}catch(o){this.v=o,this.f|=16,this.i++}return eT=o,l(this),this.f&=-2,!0},y.prototype.S=function(o){if(void 0===this.t){this.f|=36;for(var f=this.s;void 0!==f;f=f.n)f.S.S(f)}u.prototype.S.call(this,o)},y.prototype.U=function(o){if(void 0!==this.t&&(u.prototype.U.call(this,o),void 0===this.t)){this.f&=-33;for(var f=this.s;void 0!==f;f=f.n)f.S.U(f)}},y.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var o=this.t;void 0!==o;o=o.x)o.t.N()}},Object.defineProperty(y.prototype,"value",{get:function(){if(1&this.f)throw Error("Cycle detected");var o=e(this);if(this.h(),void 0!==o&&(o.i=this.i),16&this.f)throw this.v;return this.v}}),b.prototype.c=function(){var o=this.S();try{if(8&this.f||void 0===this.x)return;var f=this.x();"function"==typeof f&&(this.u=f)}finally{o()}},b.prototype.S=function(){if(1&this.f)throw Error("Cycle detected");this.f|=1,this.f&=-9,_(this),a(this),eD++;var o=eT;return eT=this,p.bind(this,o)},b.prototype.N=function(){2&this.f||(this.f|=2,this.o=eO,eO=this)},b.prototype.d=function(){this.f|=8,1&this.f||g(this)};var eN=_createClass(function BufferQueue(){_classCallCheck(this,BufferQueue),this.items=[]},[{key:"enqueue",value:function(o){this.items.push(o)}},{key:"dequeue",value:function(){return 0===this.items.length?null:this.items.shift()}},{key:"isEmpty",value:function(){return 0===this.items.length}},{key:"size",value:function(){return this.items.length}},{key:"clear",value:function(){this.items=[]}}]),eM={LOG:0,INFO:1,DEBUG:2,WARN:3,ERROR:4,NONE:5},eL="ERROR",ex=new(_createClass(function Logger(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LOG",f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console;_classCallCheck(this,Logger),this.minLogLevel=eM[o],this.scope=f,this.logProvider=v},[{key:"log",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];this.outputLog("LOG",f)}},{key:"info",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];this.outputLog("INFO",f)}},{key:"debug",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];this.outputLog("DEBUG",f)}},{key:"warn",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];this.outputLog("WARN",f)}},{key:"error",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];this.outputLog("ERROR",f)}},{key:"outputLog",value:function(o,f){if(this.minLogLevel<=eM[o]){var v,P;null===(v=(P=this.logProvider)[o.toLowerCase()])||void 0===v||v.call.apply(v,[P].concat(_toConsumableArray(this.formatLogData(f))))}}},{key:"setScope",value:function(o){this.scope=o||this.scope}},{key:"setMinLogLevel",value:function(o){this.minLogLevel=eM[o],isUndefined(this.minLogLevel)&&(this.minLogLevel=eM.LOG)}},{key:"formatLogData",value:function(o){if(Array.isArray(o)&&o.length>0){var f="%c ".concat("RS SDK");this.scope&&(f="".concat(f," - ").concat(this.scope));var v=isString(o[0])?o[0].trim():"",P=[f="".concat(f," %c ").concat(v),"font-weight: bold; background: black; color: white;","font-weight: normal;"];return isString(o[0])||P.push(o[0]),P.push.apply(P,_toConsumableArray(o.slice(1))),P}return o}}])),eF=((C={}).HANDLEDEXCEPTION="handledException",C.UNHANDLEDEXCEPTION="unhandledException",C.UNHANDLEDREJECTION="unhandledPromiseRejection",C),eB=["localStorage","memoryStorage","cookieStorage","sessionStorage","none"],eU="cookieStorage",ej="Unable to process/parse source configuration response",eG="Failed to fetch the source config",INVALID_CALLBACK_FN_ERROR=function(o){return"".concat(o).concat(":: ","The provided callback parameter is not a function.")},generateMisconfiguredPluginsWarning=function(o,f,v,P){var k=1===v.length,S=k?" '".concat(v[0],"' plugin was"):" ['".concat(v.join("', '"),"'] plugins were"),A="".concat(o).concat(":: ").concat(f,", but").concat(S," not configured to load.");return P?"".concat(A," So, ").concat(k?"the plugin":"those plugins"," will be loaded automatically."):"".concat(A," Ignore if this was intentional. Otherwise, consider adding ").concat(k?"it":"them"," to the 'plugins' load API option.")},ez={All:!0},eH="js-integrations",eV=RegExp("^(https?:\\/\\/)(((([a-zA-Z\\d]([a-zA-Z\\d-]*[a-zA-Z\\d])*)\\.)+[a-zA-Z]{2,}|localhost|((25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[0-1]?[0-9]?[0-9]?)))(\\:\\d+)?(\\/[-a-zA-Z\\d%_.~+]*)*(\\?[;&a-zA-Z\\d%_.~+=-]*)?(\\#[-a-zA-Z\\d_]*)?$"),eQ="legacy",eK="https://cdn.rudderlabs.com",e$="".concat(eK,"/").concat("v3","/").concat(eQ,"/").concat(eH),eW="".concat(eK,"/").concat("v3","/").concat(eQ,"/").concat("plugins"),eq="https://api.rudderstack.com",eX={iubenda:"IubendaConsentManager",oneTrust:"OneTrustConsentManager",ketch:"KetchConsentManager",custom:"CustomConsentManager"},eJ=_defineProperty(_defineProperty({},"v3","StorageEncryption"),"legacy","StorageEncryptionLegacy"),eY=_defineProperty(_defineProperty({},"xhr","XhrQueue"),"beacon","BeaconQueue"),eZ=d$1(q({configUrl:eq,loadIntegration:!0,sessions:{autoTrack:!0,timeout:18e5,cutOff:{enabled:!1}},sameSiteCookie:"Lax",polyfillIfRequired:!0,integrations:ez,useBeacon:!1,beaconQueueOptions:{},destinationsQueueOptions:{},queueOptions:{},lockIntegrationsVersion:!0,lockPluginsVersion:!0,uaChTrackLevel:"none",plugins:[],useGlobalIntegrationsConfigInEvents:!1,bufferDataPlaneEventsUntilReady:!1,dataPlaneEventsBufferTimeout:1e4,storage:{encryption:{version:"v3"},migrate:!0,cookie:{}},sendAdblockPage:!1,sameDomainCookiesOnly:!1,secureCookie:!1,sendAdblockPageOptions:{},useServerSideCookies:!1})),e0={userId:"",userTraits:{},anonymousId:"",groupId:"",groupTraits:{},initialReferrer:"",initialReferringDomain:"",sessionInfo:{},authToken:null},e1={userId:d$1(e0.userId),userTraits:d$1(e0.userTraits),anonymousId:d$1(e0.anonymousId),groupId:d$1(e0.groupId),groupTraits:d$1(e0.groupTraits),initialReferrer:d$1(e0.initialReferrer),initialReferringDomain:d$1(e0.initialReferringDomain),sessionInfo:d$1(e0.sessionInfo),authToken:d$1(e0.authToken)},e2={isOnline:d$1(!0),storage:{isLocalStorageAvailable:d$1(!1),isCookieStorageAvailable:d$1(!1),isSessionStorageAvailable:d$1(!1)},isBeaconAvailable:d$1(!1),isLegacyDOM:d$1(!1),isUaCHAvailable:d$1(!1),isCryptoAvailable:d$1(!1),isIE11:d$1(!1),isAdBlocked:d$1(!1)},e4={isErrorReportingEnabled:d$1(!1),isMetricsReportingEnabled:d$1(!1),breadcrumbs:d$1([])},e5=d$1(void 0),e3={activeDataplaneUrl:d$1(void 0),integrationsCDNPath:d$1(e$),pluginsCDNPath:d$1(eW),sourceConfigUrl:d$1(void 0),status:d$1(void 0),initialized:d$1(!1),logLevel:d$1(eL),loaded:d$1(!1),readyCallbacks:d$1([]),writeKey:d$1(void 0),dataPlaneUrl:d$1(void 0)},e6={enabled:d$1(!1),initialized:d$1(!1),data:d$1({}),activeConsentManagerPluginName:d$1(void 0),preConsent:d$1({enabled:!1}),postConsent:d$1({}),resolutionStrategy:d$1("and"),provider:d$1(void 0),metadata:d$1(void 0)},e8={retries:d$1(0),dropped:d$1(0),sent:d$1(0),queued:d$1(0),triggered:d$1(0),metricsServiceUrl:d$1(void 0)},e9={app:d$1({name:e_,namespace:"com.rudderlabs.javascript",version:eP,installType:"npm"}),traits:d$1(null),library:d$1({name:e_,version:eP,snippetVersion:globalThis.RudderSnippetVersion}),userAgent:d$1(null),device:d$1(null),network:d$1(null),os:d$1({name:"",version:""}),locale:d$1(null),screen:d$1({density:0,width:0,height:0,innerWidth:0,innerHeight:0}),"ua-ch":d$1(void 0),timezone:d$1(void 0)},e7={configuredDestinations:d$1([]),activeDestinations:d$1([]),loadOnlyIntegrations:d$1({}),failedDestinations:d$1([]),loadIntegration:d$1(!0),initializedDestinations:d$1([]),clientDestinationsReady:d$1(!1),integrationsConfig:d$1({})},te=_objectSpread2({},q({capabilities:e2,consents:e6,context:e9,eventBuffer:{toBeProcessedArray:d$1([]),readyCallbacksArray:d$1([])},lifecycle:e3,loadOptions:eZ,metrics:e8,nativeDestinations:e7,plugins:{ready:d$1(!1),loadedPlugins:d$1([]),failedPlugins:d$1([]),pluginsToLoadFromConfig:d$1([]),activePlugins:d$1([]),totalPluginsToLoad:d$1(0)},reporting:e4,session:e1,source:e5,storage:{encryptionPluginName:d$1(void 0),migrate:d$1(!1),type:d$1(void 0),cookie:d$1(void 0),entries:d$1({}),trulyAnonymousTracking:d$1(!1)},serverCookies:{isEnabledServerSideCookies:d$1(!1),dataServiceUrl:d$1(void 0)},dataPlaneEvents:{eventsQueuePluginName:d$1(void 0),deliveryEnabled:d$1(!0)},autoTrack:{enabled:d$1(!1),pageLifecycle:{enabled:d$1(!1),pageViewId:d$1(void 0),pageLoadedTimestamp:d$1(void 0)}}}));function getDefaultExportFromCjs(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var tt={exports:{}},tn={exports:{}},tr=(tn.exports,tt.exports,getDefaultExportFromCjs(D?tt.exports:(D=1,tt.exports=(O||(O=1,tn.exports=function(){function _capitalize(o){return o.charAt(0).toUpperCase()+o.substring(1)}function _getter(o){return function(){return this[o]}}var o=["isConstructor","isEval","isNative","isToplevel"],f=["columnNumber","lineNumber"],v=["fileName","functionName","source"],P=o.concat(f,v,["args"],["evalOrigin"]);function StackFrame(o){if(o)for(var f=0;f<P.length;f++)void 0!==o[P[f]]&&this["set"+_capitalize(P[f])](o[P[f]])}StackFrame.prototype={getArgs:function(){return this.args},setArgs:function(o){if("[object Array]"!==Object.prototype.toString.call(o))throw TypeError("Args must be an Array");this.args=o},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(o){if(o instanceof StackFrame)this.evalOrigin=o;else if(o instanceof Object)this.evalOrigin=new StackFrame(o);else throw TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var o=this.getFileName()||"",f=this.getLineNumber()||"",v=this.getColumnNumber()||"",P=this.getFunctionName()||"";return this.getIsEval()?o?"[eval] ("+o+":"+f+":"+v+")":"[eval]:"+f+":"+v:P?P+" ("+o+":"+f+":"+v+")":o+":"+f+":"+v}},StackFrame.fromString=function(o){var f=o.indexOf("("),v=o.lastIndexOf(")"),P=o.substring(0,f),k=o.substring(f+1,v).split(","),S=o.substring(v+1);if(0===S.indexOf("@"))var A=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(S,""),C=A[1],I=A[2],T=A[3];return new StackFrame({functionName:P,args:k||void 0,fileName:C,lineNumber:I||void 0,columnNumber:T||void 0})};for(var k=0;k<o.length;k++)StackFrame.prototype["get"+_capitalize(o[k])]=_getter(o[k]),StackFrame.prototype["set"+_capitalize(o[k])]=function(o){return function(f){this[o]=!!f}}(o[k]);for(var S=0;S<f.length;S++)StackFrame.prototype["get"+_capitalize(f[S])]=_getter(f[S]),StackFrame.prototype["set"+_capitalize(f[S])]=function(o){return function(f){if(!(!isNaN(parseFloat(f))&&isFinite(f)))throw TypeError(o+" must be a Number");this[o]=Number(f)}}(f[S]);for(var A=0;A<v.length;A++)StackFrame.prototype["get"+_capitalize(v[A])]=_getter(v[A]),StackFrame.prototype["set"+_capitalize(v[A])]=function(o){return function(f){this[o]=String(f)}}(v[A]);return StackFrame}()),P=tn.exports,k=/(^|@)\S+:\d+/,S=/^\s*at .*(\S+:\d+|\(native\))/m,A=/^(eval@)?(\[native code])?$/,{parse:function(o){if(void 0!==o.stacktrace||void 0!==o["opera#sourceloc"])return this.parseOpera(o);if(o.stack&&o.stack.match(S))return this.parseV8OrIE(o);if(o.stack)return this.parseFFOrSafari(o);throw Error("Cannot parse given Error object")},extractLocation:function(o){if(-1===o.indexOf(":"))return[o];var f=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o.replace(/[()]/g,""));return[f[1],f[2]||void 0,f[3]||void 0]},parseV8OrIE:function(o){return o.stack.split("\n").filter(function(o){return!!o.match(S)},this).map(function(o){o.indexOf("(eval ")>-1&&(o=o.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var f=o.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),v=f.match(/ (\(.+\)$)/);f=v?f.replace(v[0],""):f;var k=this.extractLocation(v?v[1]:f),S=v&&f||void 0,A=["eval","<anonymous>"].indexOf(k[0])>-1?void 0:k[0];return new P({functionName:S,fileName:A,lineNumber:k[1],columnNumber:k[2],source:o})},this)},parseFFOrSafari:function(o){return o.stack.split("\n").filter(function(o){return!o.match(A)},this).map(function(o){if(o.indexOf(" > eval")>-1&&(o=o.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===o.indexOf("@")&&-1===o.indexOf(":"))return new P({functionName:o});var f=/((.*".+"[^@]*)?[^@]*)(?:@)/,v=o.match(f),k=v&&v[1]?v[1]:void 0,S=this.extractLocation(o.replace(f,""));return new P({functionName:k,fileName:S[0],lineNumber:S[1],columnNumber:S[2],source:o})},this)},parseOpera:function(o){return!o.stacktrace||o.message.indexOf("\n")>-1&&o.message.split("\n").length>o.stacktrace.split("\n").length?this.parseOpera9(o):o.stack?this.parseOpera11(o):this.parseOpera10(o)},parseOpera9:function(o){for(var f=/Line (\d+).*script (?:in )?(\S+)/i,v=o.message.split("\n"),k=[],S=2,A=v.length;S<A;S+=2){var C=f.exec(v[S]);C&&k.push(new P({fileName:C[2],lineNumber:C[1],source:v[S]}))}return k},parseOpera10:function(o){for(var f=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,v=o.stacktrace.split("\n"),k=[],S=0,A=v.length;S<A;S+=2){var C=f.exec(v[S]);C&&k.push(new P({functionName:C[3]||void 0,fileName:C[2],lineNumber:C[1],source:v[S]}))}return k},parseOpera11:function(o){return o.stack.split("\n").filter(function(o){return!!o.match(k)&&!o.match(/^Error created at/)},this).map(function(o){var f,v=o.split("@"),k=this.extractLocation(v.pop()),S=v.shift()||"",A=S.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;S.match(/\(([^)]*)\)/)&&(f=S.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var C=void 0===f||"[arguments not available]"===f?void 0:f.split(",");return new P({functionName:A,args:C,fileName:k[0],lineNumber:k[1],columnNumber:k[2],source:o})},this)}}),tt.exports))),ti="global code",formatStackframe=function(o){var f,v={file:o.fileName,method:isDefined(f=o.functionName)&&/^global code$/i.test(f)?ti:f,lineNumber:o.lineNumber,columnNumber:o.columnNumber};return v.lineNumber&&v.lineNumber>-1&&!v.file&&!v.method&&(v.file=ti),v},ensureString=function(o){return isString(o)?o:""};function createException(o,f,v,P){return{errorClass:ensureString(o),message:"".concat(v).concat(ensureString(f)),type:"browserjs",stacktrace:P.reduce(function(o,f){var v=formatStackframe(f);try{if("{}"===JSON.stringify(v))return o;return o.concat(v)}catch(f){return o}},[])}}var normalizeError=function(o,f){var v,P;return isTypeOfError(o)&&isString(getStacktrace(o))?v=o:(f.warn((P=stringifyWithoutCircular(o),"".concat(es).concat(":: ","Ignoring a non-error: ").concat(P,"."))),v=void 0),v},createBugsnagException=function(o,f){try{var v=tr.parse(o);return createException(o.name,o.message,f,v)}catch(v){return createException(o.name,o.message,f,[])}},responseTextToJson=function(o,f){try{return JSON.parse(o||"")}catch(o){f(getMutatedError(o,"Failed to parse response data"))}},to="The request failed",ta=[/Failed to fetch dynamically imported module: .*/],ts=[/Failed to load the script with the id .*/,/A timeout of \d+ ms occurred while trying to load the script with id .*/],tl=[new RegExp("".concat(to,".*")),/A script with the id .* is already loaded\./],tu={headers:{Accept:"application/json","Content-Type":"application/json;charset=UTF-8"},method:"GET"},createXhrRequestOptions=function(o,f,v){var P=mergeDeepRight(tu,f||{});return v&&(P.headers=mergeDeepRight(P.headers,{Authorization:v})),P.url=o,P},xhrRequest=function(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,v=arguments.length>2?arguments[2]:void 0;return new Promise(function(P,k){if(!0===o.sendRawData)A=o.data;else if(isNull(A=stringifyWithoutCircular(o.data,!1,[],v))){k({error:Error("Failed to prepare data for the request."),undefined:void 0,options:o});return}var S,A,C=new XMLHttpRequest,xhrReject=function(f){var v,P,S,A;k({error:Error((v=C.status,P=C.statusText,S=o.url,A=C.responseText,"".concat(to," with status ").concat(v," (").concat(P,") for URL: ").concat(S,". Response: ").concat(A.trim()))),xhr:C,options:o})},xhrError=function(f){var v;k({error:Error((v=o.url,"".concat(to," due to timeout or no connection (").concat(f?f.type:"",") at the client side for URL: ").concat(v))),xhr:C,options:o})};C.ontimeout=xhrError,C.onerror=xhrError,C.onload=function(){C.status>=200&&C.status<400?P({response:C.responseText,xhr:C,options:o}):xhrReject()},C.open(o.method,o.url,!0),!0===o.withCredentials&&(C.withCredentials=!0),C.timeout=f,Object.keys(o.headers).forEach(function(f){o.headers[f]&&C.setRequestHeader(f,o.headers[f])});try{C.send(A)}catch(f){k({error:getMutatedError(f,(S=o.url,"".concat(to," for URL: ").concat(S))),xhr:C,options:o})}})},tc=new(_createClass(function HttpClient(o){_classCallCheck(this,HttpClient),this.logger=o,this.onError=this.onError.bind(this)},[{key:"init",value:function(o){this.errorHandler=o}},{key:"getData",value:(I=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(o){var f,v,P,k,S;return _regeneratorRuntime().wrap(function(A){for(;;)switch(A.prev=A.next){case 0:return f=o.url,v=o.options,P=o.timeout,k=o.isRawResponse,A.prev=1,A.next=4,xhrRequest(createXhrRequestOptions(f,v,this.basicAuthHeader),P,this.logger);case 4:return S=A.sent,A.abrupt("return",{data:k?S.response:responseTextToJson(S.response,this.onError),details:S});case 8:return A.prev=8,A.t0=A.catch(1),A.abrupt("return",{data:void 0,details:A.t0});case 11:case"end":return A.stop()}},_callee,this,[[1,8]])})),function(o){return I.apply(this,arguments)})},{key:"getAsyncData",value:function(o){var f=this,v=o.callback,P=o.url,k=o.options,S=o.timeout,A=o.isRawResponse,C=!isFunction(v);xhrRequest(createXhrRequestOptions(P,k,this.basicAuthHeader),S,this.logger).then(function(o){C||v(A?o.response:responseTextToJson(o.response,f.onError),o)}).catch(function(o){C||v(void 0,o)})}},{key:"onError",value:function(o){var f;null===(f=this.errorHandler)||void 0===f||f.onError(o,"HttpClient")}},{key:"setAuthHeader",value:function(o){var f=arguments.length>1&&void 0!==arguments[1]&&arguments[1],v=f?o:toBase64("".concat(o,":"));this.basicAuthHeader="Basic ".concat(v)}},{key:"resetAuthHeader",value:function(){this.basicAuthHeader=void 0}}]))(ex),td=["www.test-host.com","localhost","127.0.0.1","[::1]"],tf=["userId","userTraits","groupId","groupTraits","anonymousId","config","instance","eventBuffer","traits","authToken"],getErrInstance=function(o,f){switch(f){case eF.UNHANDLEDEXCEPTION:return o.error||o;case eF.UNHANDLEDREJECTION:return o.reason;case eF.HANDLEDEXCEPTION:default:return o}},getReleaseStage=function(){var o=globalThis.location.hostname;return!o||o&&td.includes(o)?"development":"production"},getAppStateForMetadata=function(o){var f=stringifyWithoutCircular(o,!1,tf);return null!==f?JSON.parse(f):{}},getUserDetails=function(o,f,v,P){var k,S,A,C,I,T;return{id:"".concat(null!==(k=null===(S=o.value)||void 0===S?void 0:S.id)&&void 0!==k?k:v.writeKey.value,"..").concat(null!==(A=f.sessionInfo.value.id)&&void 0!==A?A:"NA","..").concat(null!==(C=P.pageLifecycle.pageViewId.value)&&void 0!==C?C:"NA"),name:null!==(I=null===(T=o.value)||void 0===T?void 0:T.name)&&void 0!==I?I:"NA"}},getDeviceDetails=function(o,f){var v,P;return{locale:null!==(v=o.value)&&void 0!==v?v:"NA",userAgent:null!==(P=f.value)&&void 0!==P?P:"NA",time:new Date}},getBugsnagErrorEvent=function(o,f,v,P){var k=v.context,S=v.lifecycle,A=v.session,C=v.source,I=v.reporting,T=v.autoTrack,O=k.app,D=k.locale,R=k.userAgent,N=k.timezone,M=k.screen,L=k.library;return{payloadVersion:"5",notifier:{name:"RudderStack JavaScript SDK",version:O.value.version,url:"__REPOSITORY_URL__"},events:[{exceptions:[q(o)],severity:f.severity,unhandled:f.unhandled,severityReason:f.severityReason,app:{version:O.value.version,releaseStage:getReleaseStage(),type:O.value.installType},device:getDeviceDetails(D,R),request:{url:globalThis.location.href.split("?")[0],clientIp:"[NOT COLLECTED]"},breadcrumbs:q(I.breadcrumbs.value),context:o.message,groupingHash:P,metaData:_objectSpread2({app:{snippetVersion:L.value.snippetVersion},device:_objectSpread2(_objectSpread2({},M.value),{},{timezone:N.value})},getAppStateForMetadata(v)),user:getUserDetails(C,A,S,T)}]}},isAllowedToBeNotified=function(o){var f=o.message;return ta.some(function(o){return o.test(f)})||ts.some(function(o){return o.test(f)})?f.includes(eK):!tl.some(function(o){return o.test(f)})},isSDKError=function(o){var f,v=null===(f=o.stacktrace[0])||void 0===f?void 0:f.file;if(!v||"string"!=typeof v)return!1;var P=v.substring(v.lastIndexOf("/")+1),k=v.split("/");return k[k.length-2]===eH||["rsa"].some(function(o){return P.startsWith(o)&&P.endsWith(".js")})},tg=new(_createClass(function ErrorHandler(o,f){_classCallCheck(this,ErrorHandler),_defineProperty(this,"initialized",!1),this.httpClient=o,this.logger=f},[{key:"init",value:function(){this.initialized||(this.attachErrorListeners(),this.initialized=!0)}},{key:"attachErrorListeners",value:function(){var o=this;globalThis.addEventListener("error",function(f){o.onError(f,es,void 0,eF.UNHANDLEDEXCEPTION)}),globalThis.addEventListener("unhandledrejection",function(f){o.onError(f,es,void 0,eF.UNHANDLEDREJECTION)})}},{key:"onError",value:function(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:eF.HANDLEDEXCEPTION;try{var k=getErrInstance(o,P),S=normalizeError(k,this.logger);if(isUndefined(S))return;var A="".concat(f).concat(":: ").concat(v?"".concat(v," - "):""),C=createBugsnagException(S,A),I=getStacktrace(S).includes(em);if(!I&&!isSDKError(C)&&P!==eF.HANDLEDEXCEPTION)return;if(te.reporting.isErrorReportingEnabled.value&&isAllowedToBeNotified(C)){var T={severity:"error",unhandled:P!==eF.HANDLEDEXCEPTION,severityReason:{type:P}},O=getBugsnagErrorEvent(C,T,te);this.httpClient.getAsyncData({url:te.metrics.metricsServiceUrl.value,options:{method:"POST",data:stringifyWithoutCircular({version:"1",message_id:generateUUID(),source:{name:"js",sdk_version:te.context.app.value.version,write_key:te.lifecycle.writeKey.value,install_type:te.context.app.value.installType},errors:O}),sendRawData:!0},isRawResponse:!0})}(P===eF.HANDLEDEXCEPTION||I)&&this.logger.error(C.message)}catch(o){this.logger.error("".concat(es).concat(":: ","Failed to handle the error."),o)}}},{key:"leaveBreadcrumb",value:function(o){try{te.reporting.breadcrumbs.value=[].concat(_toConsumableArray(te.reporting.breadcrumbs.value),[{type:"manual",name:o,timestamp:new Date,metaData:{}}])}catch(o){this.onError(o,"".concat(es).concat(":: ","Failed to log breadcrumb."))}}}]))(tc,ex),tv=new(_createClass(function PluginEngine(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,PluginEngine),_defineProperty(this,"plugins",[]),_defineProperty(this,"byName",{}),_defineProperty(this,"cache",{}),_defineProperty(this,"config",{throws:!0}),this.config=_objectSpread2({throws:!0},f),this.logger=o},[{key:"register",value:function(o,f){if(!o.name){var v="".concat(el).concat(":: ","Plugin name is missing.");if(this.config.throws)throw Error(v);this.logger.error(v,o);return}if(this.byName[o.name]){var P,k=(P=o.name,"".concat(el).concat(":: ",'Plugin "').concat(P,'" already exists.'));if(this.config.throws)throw Error(k);this.logger.error(k);return}this.cache={},this.plugins=this.plugins.slice();var S=this.plugins.length;this.plugins.forEach(function(f,v){var P;null!==(P=f.deps)&&void 0!==P&&P.includes(o.name)&&(S=Math.min(S,v))}),this.plugins.splice(S,0,o),this.byName[o.name]=o,isFunction(o.initialize)&&o.initialize(f)}},{key:"unregister",value:function(o){var f=this.byName[o];if(!f){var v="".concat(el).concat(":: ",'Plugin "').concat(o,'" not found.');if(this.config.throws)throw Error(v);this.logger.error(v);return}var P=this.plugins.indexOf(f);if(-1===P){var k="".concat(el).concat(":: ",'Plugin "').concat(o,'" not found in plugins but found in byName. This indicates a bug in the plugin engine. Please report this issue to the development team.');if(this.config.throws)throw Error(k);this.logger.error(k);return}this.cache={},delete this.byName[o],this.plugins=this.plugins.slice(),this.plugins.splice(P,1)}},{key:"getPlugin",value:function(o){return this.byName[o]}},{key:"getPlugins",value:function(o){var f=this,v=null!=o?o:".";return this.cache[v]||(this.cache[v]=this.plugins.filter(function(o){var P;if(null!==(P=o.deps)&&void 0!==P&&P.some(function(o){return!f.byName[o]})){var k,S=o.deps.filter(function(o){return!f.byName[o]});return f.logger.error((k=o.name,"".concat(el).concat(":: ",'Plugin "').concat(k,'" could not be loaded because some of its dependencies "').concat(S,'" do not exist.'))),!1}return"."===v||!!getValueByPath(o,v)})),this.cache[v]}},{key:"processRawPlugins",value:function(o){o(this.plugins),this.cache={}}},{key:"invoke",value:function(o){for(var f,v=this,P=!(arguments.length>1)||void 0===arguments[1]||arguments[1],k=arguments.length,S=Array(k>2?k-2:0),A=2;A<k;A++)S[A-2]=arguments[A];var C=o;if(!C)throw Error("Failed to invoke plugin because the extension point name is missing.");var I=C.startsWith("!"),T=null!==(f=this.config.throws)&&void 0!==f?f:C.endsWith("!");if(!(C=C.replace(/(^!|!$)/g,"")))throw Error("Failed to invoke plugin because the extension point name is invalid.");var O=C.split(".");O.pop();var D=O.join(".");return(P?this.getPlugins(C):[this.getPlugins(C)[0]]).map(function(o){var f,P,k=getValueByPath(o,C);if(!isFunction(k)||I)return k;try{return k.apply(getValueByPath(o,D),S)}catch(k){if(T)throw k;v.logger.error((f=C,P=o.name,"".concat(el).concat(":: ",'Failed to invoke the "').concat(f,'" extension point of plugin "').concat(P,'".')),k)}return null})}},{key:"invokeSingle",value:function(o){for(var f=arguments.length,v=Array(f>1?f-1:0),P=1;P<f;P++)v[P-1]=arguments[P];return this.invoke.apply(this,[o,!1].concat(v))[0]}},{key:"invokeMultiple",value:function(o){for(var f=arguments.length,v=Array(f>1?f-1:0),P=1;P<f;P++)v[P-1]=arguments[P];return this.invoke.apply(this,[o,!0].concat(v))}}]))(ex,{throws:!0}),isNonCloudDestination=function(o){return!("cloud"===o.config.connectionMode&&!0!==o.config.useNativeSDKToSend&&!0!==o.config.useNativeSDK)},isHybridModeDestination=function(o){return!("hybrid"!==o.config.connectionMode&&!0!==o.config.useNativeSDKToSend)},getNonCloudDestinations=function(o){return o.filter(isNonCloudDestination)},tp=["BeaconQueue","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ExternalAnonymousId","GoogleLinker","IubendaConsentManager","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],th=["Bugsnag","ErrorReporting"],ty="cookieStorage",tm="localStorage",t_="sessionStorage",tP="memoryStorage",tb="none",removeDuplicateSlashes=function(o){return o.replace(/\/{2,}/g,"/")},isValidURL=function(o){if(!isString(o))return!1;try{return isFunction(globalThis.URL)&&new URL(o),eV.test(o)}catch(o){return!1}},isErrRetryable=function(o){return 429===o||!(o>=400&&o<500)},encode=function(o,f){try{return encodeURIComponent(o)}catch(o){null==f||f.error("Failed to encode the cookie data.",o);return}},decode$1=function(o){try{return decodeURIComponent(o)}catch(o){return}},parse=function(o){var f,v={},P=o.split(/\s*;\s*/);return P[0]&&P.forEach(function(o){var P=(f=o.split("="))[0]?decode$1(f[0]):void 0;P&&(v[P]=f[1]?decode$1(f[1]):void 0)}),v},set=function(o,f,v,P){var k=_objectSpread2({},v||{}),S="".concat(encode(o,P),"=").concat(encode(f,P));isNull(f)&&(k.maxage=-1),k.maxage&&(k.expires=new Date(+new Date+k.maxage)),k.path&&(S+="; path=".concat(k.path)),k.domain&&(S+="; domain=".concat(k.domain)),k.expires&&(S+="; expires=".concat(k.expires.toUTCString())),k.samesite&&(S+="; samesite=".concat(k.samesite)),k.secure&&(S+="; secure"),globalThis.document.cookie=S},all=function(){return parse(globalThis.document.cookie)},cookie=function(o,f,v,P){switch(arguments.length){case 4:case 3:case 2:return set(o,f,v,P);case 1:if(o)return all()[o];return all();default:return all()}},tk={userId:"rl_user_id",userTraits:"rl_trait",anonymousId:"rl_anonymous_id",groupId:"rl_group_id",groupTraits:"rl_group_trait",initialReferrer:"rl_page_init_referrer",initialReferringDomain:"rl_page_init_referring_domain",sessionInfo:"rl_session",authToken:"rl_auth_token"},tS="RS_ENC_v3_",decryptBrowser=function(o){return null!=o&&o.startsWith(tS)?fromBase64(o.substring(tS.length)):o},tE="QueueUtilities",getDeliveryPayload=function(o,f){return stringifyWithoutCircular(o,!0,void 0,f)},validateEventPayloadSize=function(o,f){var v=getDeliveryPayload(o,f);if(v){var P=v.length;P>32768&&(null==f||f.warn("".concat(tE).concat(":: ","The size of the event payload (").concat(P," bytes) exceeds the maximum limit of ").concat(32768," bytes. Events with large payloads may be dropped in the future. Please review your instrumentation to ensure that event payloads are within the size limit.")))}else null==f||f.warn("".concat(tE).concat(":: ","Failed to validate event payload size. Please make sure that the event payload is within the size limit and is a valid JSON object."))},getFinalEventForDeliveryMutator=function(o,f){var v=q(o);return v.sentAt=f,v},tA={IN_PROGRESS:"inProgress",QUEUE:"queue",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd",ACK:"ack",BATCH_QUEUE:"batchQueue"},tC={maxItems:10,flushQueueInterval:6e5},tI="BeaconQueuePlugin",getBatchDeliveryPayload$1=function(o,f,v){try{var P=stringifyWithoutCircular({batch:o,sentAt:f},!0);if(P)return new Blob([P],{type:"text/plain"});null==v||v.error("".concat(tI).concat(":: ","Failed to convert events batch object to string."))}catch(o){null==v||v.error("".concat(tI).concat(":: ","Failed to convert events batch object to Blob."),o)}},getDeliveryUrl$1=function(o,f){var v=new URL(o);return new URL(removeDuplicateSlashes([v.pathname,"/","beacon","/","v1","/","batch?writeKey=".concat(f)].join("")),v).href},tT=((T={})[T.ASAP=1]="ASAP",T[T.RESCHEDULE=2]="RESCHEDULE",T[T.ABANDON=3]="ABANDON",T),tO={setTimeout:function(o,f){return globalThis.setTimeout(o,f)},clearTimeout:function(o){return globalThis.clearTimeout(o)},Date:globalThis.Date,clockLateFactor:2},tD=_createClass(function Schedule(){_classCallCheck(this,Schedule),this.tasks={},this.nextId=1,this.clock=tO},[{key:"now",value:function(){return+new this.clock.Date}},{key:"run",value:function(o,f,v){this.nextId===Number.MAX_SAFE_INTEGER&&(this.nextId=1);var P=(this.nextId++).toString();return this.tasks[P]=this.clock.setTimeout(this.handle(P,o,f,v||tT.ASAP),f),P}},{key:"handle",value:function(o,f,v,P){var k=this,S=this.now();return function(){delete k.tasks[o];var A=S+v*(k.clock.clockLateFactor||2),C=k.now();if(P>=tT.RESCHEDULE&&A<C){P===tT.RESCHEDULE&&k.run(f,v,P);return}return f()}}},{key:"cancel",value:function(o){this.tasks[o]&&(this.clock.clearTimeout(this.tasks[o]),delete this.tasks[o])}},{key:"cancelAll",value:function(){Object.values(this.tasks).forEach(this.clock.clearTimeout),this.tasks={}}}]),tR=1/0,tw=1/0,tN="Batch",tM="Single",sortByTime=function(o,f){return o.time-f.time},tL="RetryQueue",tx=_createClass(function RetryQueue(o,f,v,P){var k,S=arguments.length>4&&void 0!==arguments[4]?arguments[4]:tm,A=arguments.length>5?arguments[5]:void 0,C=arguments.length>6?arguments[6]:void 0;_classCallCheck(this,RetryQueue),this.storeManager=P,this.logger=A,this.name=o,this.id=generateUUID(),this.processQueueCb=v,this.batchSizeCalcCb=C,this.maxItems=f.maxItems||tw,this.maxAttempts=f.maxAttempts||tR,this.batch={enabled:!1},this.configureBatchMode(f),this.backoff={minRetryDelay:f.minRetryDelay||1e3,maxRetryDelay:f.maxRetryDelay||3e4,factor:f.backoffFactor||2,jitter:f.backoffJitter||0};var I=Math.max(null!==(k=f.timerScaleFactor)&&void 0!==k?k:1,1);I=Math.min(I,10),this.timeouts={ackTimer:Math.round(1e3*I),reclaimTimer:Math.round(3e3*I),reclaimTimeout:Math.round(1e4*I),reclaimWait:Math.round(500*I)},this.schedule=new tD,this.processId="0",this.store=this.storeManager.setStore({id:this.id,name:this.name,validKeys:tA,type:S,errorHandler:this.storeManager.errorHandler,logger:this.storeManager.logger}),this.setDefaultQueueEntries(),this.ack=this.ack.bind(this),this.checkReclaim=this.checkReclaim.bind(this),this.processHead=this.processHead.bind(this),this.flushBatch=this.flushBatch.bind(this),this.isPageAccessible=!0,this.flushBatchOnPageLeave(),this.scheduleTimeoutActive=!1},[{key:"setDefaultQueueEntries",value:function(){this.setStorageEntry(tA.IN_PROGRESS,{}),this.setStorageEntry(tA.QUEUE,[]),this.setStorageEntry(tA.BATCH_QUEUE,[])}},{key:"configureBatchMode",value:function(o){if(this.batchingInProgress=!1,isObjectLiteralAndNotNull(o.batch)){var f,v,P,k=o.batch;this.batch.enabled=!0===k.enabled,this.batch.enabled&&(this.batch.maxSize=Math.min(null!==(f=k.maxSize)&&void 0!==f?f:524288,524288),this.batch.maxItems=null!==(v=k.maxItems)&&void 0!==v?v:100,this.batch.flushInterval=null!==(P=k.flushInterval)&&void 0!==P?P:6e4)}}},{key:"flushBatchOnPageLeave",value:function(){this.batch.enabled&&onPageLeave(this.flushBatch)}},{key:"getStorageEntry",value:function(o){return this.store.get(o)}},{key:"setStorageEntry",value:function(o,f){isNullOrUndefined(f)?this.store.remove(o):this.store.set(o,f)}},{key:"stop",value:function(){this.schedule.cancelAll(),this.scheduleTimeoutActive=!1}},{key:"start",value:function(){this.scheduleTimeoutActive&&this.stop(),this.scheduleTimeoutActive=!0,this.scheduleFlushBatch(),this.ack(),this.checkReclaim(),this.processHead()}},{key:"scheduleFlushBatch",value:function(){var o;this.batch.enabled&&null!==(o=this.batch)&&void 0!==o&&o.flushInterval&&(this.flushBatchTaskId&&this.schedule.cancel(this.flushBatchTaskId),this.flushBatchTaskId=this.schedule.run(this.flushBatch,this.batch.flushInterval,tT.ASAP))}},{key:"flushBatch",value:function(){var o=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.batchingInProgress){this.isPageAccessible=o,this.batchingInProgress=!0;var f,v=null!==(f=this.getStorageEntry(tA.BATCH_QUEUE))&&void 0!==f?f:[];if(v.length>0){v=v.slice(-v.length);var P=this.genQueueItem(v.map(function(o){return o.item}),tN);this.setStorageEntry(tA.BATCH_QUEUE,[]),this.pushToMainQueue(P)}this.batchingInProgress=!1,this.scheduleFlushBatch()}}},{key:"shouldRetry",value:function(o,f){return f<=this.maxAttempts}},{key:"getDelay",value:function(o){var f=this.backoff.minRetryDelay*Math.pow(this.backoff.factor,o);if(this.backoff.jitter){var v=Math.random(),P=Math.floor(v*this.backoff.jitter*f);5>Math.floor(10*v)?f-=P:f+=P}return Number(Math.min(f,this.backoff.maxRetryDelay).toPrecision(1))}},{key:"enqueue",value:function(o){var f;(f=this.batch.enabled&&o.type===tM?this.handleNewItemForBatch(o):o)&&this.pushToMainQueue(f)}},{key:"handleNewItemForBatch",value:function(o){var f=null!==(v=this.getStorageEntry(tA.BATCH_QUEUE))&&void 0!==v?v:[];if(this.batchingInProgress)f.push(o);else{this.batchingInProgress=!0,(f=f.slice(-f.length)).push(o);var v,P,k,S=this.getBatchDispatchInfo(f);if(S.criteriaMet||S.criteriaExceeded){if(S.criteriaExceeded?(k=f.slice(0,f.length-1),f=[o]):(k=f,f=[]),k.length>0){var A=k.every(function(o){return o.reclaimed}),C=k.map(function(o){return o.item});P=A?this.genQueueItem(C,tN,!0):this.genQueueItem(C,tN)}this.scheduleFlushBatch()}this.batchingInProgress=!1}return this.setStorageEntry(tA.BATCH_QUEUE,f),P}},{key:"pushToMainQueue",value:function(o){var f,v=null!==(f=this.getStorageEntry(tA.QUEUE))&&void 0!==f?f:[];(v=this.maxItems>1?v.slice(-(this.maxItems-1)):[]).push(o),v=v.sort(sortByTime),this.setStorageEntry(tA.QUEUE,v),this.scheduleTimeoutActive&&this.processHead()}},{key:"addItem",value:function(o){this.enqueue(this.genQueueItem(o))}},{key:"genQueueItem",value:function(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tM,v=arguments.length>2?arguments[2]:void 0;return _objectSpread2({item:o,attemptNumber:0,time:this.schedule.now(),id:generateUUID(),type:f},isDefined(v)?{reclaimed:v}:{})}},{key:"requeue",value:function(o){var f=o.attemptNumber,v=o.item,P=o.type,k=o.id,S=o.firstAttemptedAt,A=o.lastAttemptedAt,C=o.reclaimed,I=f+1;this.shouldRetry(v,I)&&this.enqueue({item:v,attemptNumber:I,time:this.schedule.now()+this.getDelay(I),id:null!=k?k:generateUUID(),type:P,firstAttemptedAt:S,lastAttemptedAt:A,reclaimed:C})}},{key:"getBatchDispatchInfo",value:function(o){var f,v,P=!1,k=!1,S=null===(f=this.batch)||void 0===f?void 0:f.maxItems;if(isDefined(S)&&(P=o.length===S,k=o.length>S),P||k)return{criteriaMet:P,criteriaExceeded:k};var A=!1,C=!1,I=null===(v=this.batch)||void 0===v?void 0:v.maxSize;if(isDefined(I)&&isDefined(this.batchSizeCalcCb)){var T=this.batchSizeCalcCb(o.map(function(o){return o.item}));A=T===I,C=T>I}return{criteriaMet:A,criteriaExceeded:C}}},{key:"processHead",value:function(){var o,f,v,P=this;this.schedule.cancel(this.processId);for(var k=null!==(o=this.getStorageEntry(tA.QUEUE))&&void 0!==o?o:[],S=this.schedule.now(),A=[],C=null!==(f=this.getStorageEntry(tA.IN_PROGRESS))&&void 0!==f?f:{},I=Object.keys(C).length;k.length>0&&k[0].time<=S&&I++<this.maxItems;){var T=k.shift();if(T){var O=generateUUID();C[O]={item:T.item,attemptNumber:T.attemptNumber,time:this.schedule.now(),type:T.type,firstAttemptedAt:T.firstAttemptedAt,lastAttemptedAt:T.lastAttemptedAt,reclaimed:T.reclaimed},function(o,f){A.push({id:f,item:o.item,done:function(v,k){var S,A=null!==(S=P.getStorageEntry(tA.IN_PROGRESS))&&void 0!==S?S:{},C=A[f],I=null==C?void 0:C.firstAttemptedAt,T=null==C?void 0:C.lastAttemptedAt;delete A[f],P.setStorageEntry(tA.IN_PROGRESS,A),v&&P.requeue(_objectSpread2(_objectSpread2({},o),{},{firstAttemptedAt:I,lastAttemptedAt:T}))},attemptNumber:o.attemptNumber})}(T,O)}}if(this.setStorageEntry(tA.QUEUE,k),this.setStorageEntry(tA.IN_PROGRESS,C),A.forEach(function(o){try{var f,v,k,S,A=P.schedule.now(),C=null!==(f=P.getStorageEntry(tA.IN_PROGRESS))&&void 0!==f?f:{},I=C[o.id],T=A,O=A,D=!1;I&&(T=null!==(v=I.firstAttemptedAt)&&void 0!==v?v:T,O=null!==(k=I.lastAttemptedAt)&&void 0!==k?k:O,D=null!==(S=I.reclaimed)&&void 0!==S?S:D,I.firstAttemptedAt=T,I.lastAttemptedAt=A,C[o.id]=I,P.setStorageEntry(tA.IN_PROGRESS,C));var R=Math.round((A-T)/1e3),N=Math.round((A-O)/1e3),M=P.shouldRetry(o.item,o.attemptNumber+1);P.processQueueCb(o.item,o.done,{retryAttemptNumber:o.attemptNumber,maxRetryAttempts:P.maxAttempts,willBeRetried:M,timeSinceFirstAttempt:R,timeSinceLastAttempt:N,reclaimed:D})}catch(f){var L,B,U="";o.attemptNumber<P.maxAttempts?(U="The item will be requeued.",o.attemptNumber>0&&(U="".concat(U," Retry attempt ").concat(o.attemptNumber," of ").concat(P.maxAttempts,".")),o.done(f)):(U="Retries exhausted (".concat(P.maxAttempts,"). The item will be dropped."),o.done()),null===(B=P.logger)||void 0===B||B.error((L=U,"".concat(tL).concat(":: ","An unknown error occurred while processing the queue item. ").concat(L)),f)}}),k=null!==(v=this.getStorageEntry(tA.QUEUE))&&void 0!==v?v:[],this.schedule.cancel(this.processId),k.length>0){var D=k[0].time-S;this.processId=this.schedule.run(this.processHead,D,tT.ASAP)}}},{key:"ack",value:function(){this.setStorageEntry(tA.ACK,this.schedule.now()),null!=this.reclaimStartVal&&(this.reclaimStartVal=null,this.setStorageEntry(tA.RECLAIM_START,null)),null!=this.reclaimEndVal&&(this.reclaimEndVal=null,this.setStorageEntry(tA.RECLAIM_END,null)),this.schedule.run(this.ack,this.timeouts.ackTimer,tT.ASAP)}},{key:"reclaim",value:function(o){var f,v,P,k,S=this,A=this.storeManager.setStore({id:o,name:this.name,validKeys:tA,type:tm,errorHandler:this.storeManager.errorHandler,logger:this.storeManager.logger}),C={queue:null!==(f=this.getStorageEntry(tA.QUEUE))&&void 0!==f?f:[]},I={inProgress:null!==(v=A.get(tA.IN_PROGRESS))&&void 0!==v?v:{},batchQueue:null!==(P=A.get(tA.BATCH_QUEUE))&&void 0!==P?P:[],queue:null!==(k=A.get(tA.QUEUE))&&void 0!==k?k:[]},T=[],addConcatQueue=function(o,f){var concatIterator=function(o){var v=null!==(P=o.id)&&void 0!==P?P:generateUUID();if(T.includes(v));else{var P,k,A=Array.isArray(o.item)?tN:tM;C.queue.push({item:o.item,attemptNumber:o.attemptNumber+f,time:S.schedule.now(),id:v,type:null!==(k=o.type)&&void 0!==k?k:A,firstAttemptedAt:o.firstAttemptedAt,lastAttemptedAt:o.lastAttemptedAt,reclaimed:!0}),T.push(v)}};Array.isArray(o)?o.forEach(concatIterator):o&&Object.values(o).forEach(concatIterator)};addConcatQueue(I.queue,0),this.batch.enabled?I.batchQueue.forEach(function(o){var f,v,P=null!==(f=o.id)&&void 0!==f?f:generateUUID();T.includes(P)||(S.enqueue(_objectSpread2(_objectSpread2({},o),{},{id:P,reclaimed:!0,type:null!==(v=o.type)&&void 0!==v?v:tM,time:S.schedule.now()})),T.push(P))}):addConcatQueue(I.batchQueue,0),addConcatQueue(I.inProgress,1),C.queue.sort(sortByTime),this.setStorageEntry(tA.QUEUE,C.queue),this.clearQueueEntries(A,1),this.processHead()}},{key:"clearQueueEntries",value:function(o,f){this.removeStorageEntry(o,0,f)}},{key:"removeStorageEntry",value:function(o,f,v){var P=this,k=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,S=Object.keys(tA),A=tA[S[f]];globalThis.setTimeout(function(){try{o.remove(A),f+1<S.length&&P.removeStorageEntry(o,f+1,v)}catch(T){var C,I="NS_ERROR_STORAGE_BUSY";(T.name===I||T.code===I||2153971713===T.code)&&k<2?P.removeStorageEntry(o,f,v+40,k+1):null===(C=P.logger)||void 0===C||C.error("".concat(tL).concat(":: ",'Failed to remove local storage entry "').concat(A,'" (attempt: ').concat(k,"."),T),2===k&&f+1<S.length&&P.removeStorageEntry(o,f+1,v)}},v)}},{key:"checkReclaim",value:function(){var o=this,tryReclaim=function(f){f.set(tA.RECLAIM_START,o.id),f.set(tA.ACK,o.schedule.now()),o.schedule.run(function(){f.get(tA.RECLAIM_START)===o.id&&(f.set(tA.RECLAIM_END,o.id),o.schedule.run(function(){f.get(tA.RECLAIM_END)===o.id&&f.get(tA.RECLAIM_START)===o.id&&o.reclaim(f.id)},o.timeouts.reclaimWait,tT.ABANDON))},o.timeouts.reclaimWait,tT.ABANDON)};(function(f){var v=[],P=o.store.getOriginalEngine(),k=[];if(isFunction(P.keys))k=P.keys();else for(var S=0;S<P.length;S++){var A=P.key(S);A&&k.push(A)}return k.forEach(function(P){var k=P?P.split("."):[];k.length>=3&&k[0]===f&&k[1]!==o.id&&k[2]===tA.ACK&&v.push(o.storeManager.setStore({id:k[1],name:f,validKeys:tA,type:tm,errorHandler:o.storeManager.errorHandler,logger:o.storeManager.logger}))}),v})(this.name).forEach(function(f){o.schedule.now()-f.get(tA.ACK)<o.timeouts.reclaimTimeout||tryReclaim(f)}),this.schedule.run(this.checkReclaim,this.timeouts.reclaimTimer,tT.RESCHEDULE)}},{key:"clear",value:function(){this.schedule.cancelAll(),this.setDefaultQueueEntries()}}]),tF="BeaconQueue",tB="CustomConsentManager",tU="DeviceModeDestinationsPlugin",DESTINATION_SDK_LOAD_ERROR=function(o,f){return"".concat(o).concat(":: ","Failed to load script for destination ").concat(f,".")},filterDestinations=function(o,f){var v,P=null===(v=o.All)||void 0===v||v;return f.filter(function(f){var v,k,S,A=f.displayName;return P?(S=!0,isUndefined(v=o[A])||!1!=!!v||(S=!1)):(S=!1,isUndefined(k=o[A])||!0!=!!k||(S=!0)),S})},tj="ACTIVE_CAMPAIGN",tG="ActiveCampaign",tz="ADOBE_ANALYTICS",tH="Adobe Analytics",tV="ADROLL",tQ="Adroll",tK="Amplitude",t$="APPCUES",tW="Appcues",tq="AXEPTIO",tX="Axeptio",tJ="BINGADS",tY="Bing Ads",tZ="BRAZE",t0="Braze",t1="BUGSNAG",t2="Bugsnag",t4="CHARTBEAT",t5="Chartbeat",t3="CLEVERTAP",t6="CleverTap",t8="COMMANDBAR",t9="CommandBar",t7="CONVERTFLOW",ne="Convertflow",nt="CRITEO",nn="Criteo",nr="CUSTOMERIO",ni="Customer IO",no="DCM_FLOODLIGHT",na="DCM Floodlight",ns="DRIP",nl="Drip",nu="ENGAGE",nc="Engage",nd="FACEBOOK_PIXEL",nf="Facebook Pixel",ng="FULLSTORY",nv="Fullstory",np="Google Analytics",nh="GA360",ny="Google Analytics 360",nm="Google Analytics 4 (GA4)",n_="GA4_V2",nP="Google Analytics 4 (GA4) V2",nb="GAINSIGHT_PX",nk="Gainsight PX",nS="GOOGLE_OPTIMIZE",nE="Google Optimize",nA="GOOGLEADS",nC="Google Ads",nI="Google Tag Manager",nT="HEAP",nO="Heap.io",nD="HOTJAR",nR="Hotjar",nw="HubSpot",nN="INTERCOM",nM="Intercom",nL="ITERABLE",nx="Iterable",nF="JUNE",nB="JUNE",nU="KEEN",nj="Keen",nG="KISSMETRICS",nz="Kiss Metrics",nH="KLAVIYO",nV="Klaviyo",nQ="LAUNCHDARKLY",nK="LaunchDarkly",n$="LEMNISK",nW="Lemnisk Marketing Automation",nq="LINKEDIN_INSIGHT_TAG",nX="Linkedin Insight Tag",nJ="LIVECHAT",nY="livechat",nZ="LOTAME",n0="Lotame",n1="LYTICS",n2="Lytics",n4="MATOMO",n5="Matomo",n3="MICROSOFT_CLARITY",n6="Microsoft Clarity",n8="MOENGAGE",n9="MoEngage",n7="MOUSEFLOW",re="Mouseflow",rt="Mixpanel",rn="NINETAILED",rr="Ninetailed",ri="OLARK",ro="Olark",ra="OPTIMIZELY",rs="Optimizely Web",rl="PENDO",ru="Pendo",rc="PINTEREST_TAG",rd="Pinterest Tag",rf="PODSIGHTS",rg="Podsights",rv="POST_AFFILIATE_PRO",rp="Post Affiliate Pro",rh="POSTHOG",ry="PostHog",rm="PROFITWELL",r_="ProfitWell",rP="QUALAROO",rb="Qualaroo",rk="QUALTRICS",rS="Qualtrics",rE="QUANTUMMETRIC",rA="Quantum Metric",rC="QUORA_PIXEL",rI="Quora Pixel",rT="REDDIT_PIXEL",rO="Reddit Pixel",rD="REFINER",rR="Refiner",rw="ROCKERBOX",rN="Rockerbox",rM="ROLLBAR",rL="rollbar",rx="SATISMETER",rF="SatisMeter",rB="SENDINBLUE",rU="Sendinblue",rj="SENTRY",rG="Sentry",rz="SHYNET",rH="Shynet",rV="SNAP_PIXEL",rQ="Snap Pixel",rK="SNAPENGAGE",r$="SnapEngage",rW="SPOTIFYPIXEL",rq="Spotify Pixel",rX="SPRIG",rJ="Sprig",rY="TIKTOK_ADS",rZ="TikTok Ads",r0="TVSQUARED",r1="TVSquared",r2="VERO",r4="Vero",r5="WOOPRA",r3="WOOPRA",r6="XPIXEL",r8="XPixel",r9="YANDEX_METRICA",r7="Yandex.Metrica",ie="USERPILOT",it="Userpilot",ir="AdobeAnalytics";_defineProperty({},tH,ir),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({"Adobe Analytics":tz,ADOBEANALYTICS:tz,"ADOBE ANALYTICS":tz},tz,tz),"AdobeAnalytics",tz),"adobeanalytics",tz),"adobe analytics",tz),"Adobe analytics",tz),"adobe Analytics",tz);var ii="Amplitude";_defineProperty({},tK,ii),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"AM","AM"),"AMPLITUDE","AM"),"Amplitude","AM"),"am","AM");var io="Appcues";_defineProperty({},tW,io),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},t$,t$),"Appcues",t$),"App Cues",t$),"appcues",t$);var ia="BingAds";_defineProperty({},tY,ia),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},tJ,tJ),"BingAds",tJ),"bingads",tJ),"Bing Ads",tJ),"Bing ads",tJ),"bing Ads",tJ),"bing ads",tJ);var is="Braze";_defineProperty({},t0,is),_defineProperty(_defineProperty(_defineProperty({},tZ,tZ),"Braze",tZ),"braze",tZ);var il="Bugsnag";_defineProperty({},t2,il),_defineProperty(_defineProperty(_defineProperty({},t1,t1),"bugsnag",t1),"Bugsnag",t1);var iu="Chartbeat";_defineProperty({},t5,iu),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},t4,t4),"Chartbeat",t4),"chartbeat",t4),"Chart Beat",t4),"chart beat",t4);var ic="Clevertap";_defineProperty({},t6,ic),_defineProperty(_defineProperty(_defineProperty({},t3,t3),"Clevertap",t3),"clevertap",t3);var id="Criteo";_defineProperty({},nn,id),_defineProperty(_defineProperty(_defineProperty({},nt,nt),"Criteo",nt),"criteo",nt);var ig="CustomerIO";_defineProperty({},ni,ig),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nr,nr),"Customerio",nr),"Customer.io",nr),"CUSTOMER.IO",nr),"customer.io",nr);var iv="Drip";_defineProperty({},nl,iv),_defineProperty(_defineProperty(_defineProperty({},ns,ns),"Drip",ns),"drip",ns);var ip="FacebookPixel";_defineProperty({},nf,ip),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nd,nd),"FB Pixel",nd),"Facebook Pixel",nd),"facebook pixel",nd),"fbpixel",nd),"FBPIXEL",nd),"FB_PIXEL",nd);var ih="Fullstory";_defineProperty({},nv,ih),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},ng,ng),"Fullstory",ng),"FullStory",ng),"full Story",ng),"Full Story",ng),"Full story",ng),"full story",ng),"fullstory",ng),_defineProperty({},np,"GA"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"GA","GA"),"Google Analytics","GA"),"GoogleAnalytics","GA"),"GOOGLE ANALYTICS","GA"),"google analytics","GA"),_defineProperty({},nm,"GA4"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"GA4","GA4"),"Google Analytics 4","GA4"),"Google analytics 4","GA4"),"google analytics 4","GA4"),"Google Analytics4","GA4"),"Google analytics4","GA4"),"google analytics4","GA4"),"Google Analytics 4 (GA4)","GA4"),"google analytics 4 (ga4)","GA4"),"GoogleAnalytics4","GA4");var iy="GA4_V2";_defineProperty({},nP,iy),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},n_,n_),"Google Analytics 4 V2",n_),"Google analytics 4 V2",n_),"google analytics 4 V2",n_),"Google Analytics4 V2",n_),"Google analytics4 V2",n_),"google analytics4 V2",n_),"Google Analytics 4 (GA4) V2",n_),"google analytics 4 (ga4) V2",n_),"GoogleAnalytics4V2",n_);var im="GoogleAds";_defineProperty({},nC,im),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nA,nA),"Google Ads",nA),"GoogleAds",nA),"GOOGLE ADS",nA),"google ads",nA),"googleads",nA);var i_="GoogleOptimize";_defineProperty({},nE,i_),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nS,nS),"Google Optimize",nS),"GoogleOptimize",nS),"Googleoptimize",nS),"GOOGLEOPTIMIZE",nS),"google optimize",nS),"Google optimize",nS),"GOOGLE OPTIMIZE",nS);var iP="GoogleTagManager";_defineProperty({},nI,iP),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"GTM","GTM"),"Google Tag Manager","GTM"),"google tag manager","GTM"),"googletag manager","GTM"),"googletagmanager","GTM");var ib="Heap";_defineProperty({},nO,ib),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nT,nT),"Heap",nT),"heap",nT),"Heap.io",nT);var ik="Hotjar";_defineProperty({},nR,ik),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nD,nD),"Hotjar",nD),"hotjar",nD),"Hot Jar",nD),"hot jar",nD);var iS="HubSpot";_defineProperty({},nw,iS),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"HS","HS"),"Hubspot","HS"),"HUBSPOT","HS"),"hub spot","HS"),"Hub Spot","HS"),"Hub spot","HS");var iE="INTERCOM";_defineProperty({},nM,iE),_defineProperty(_defineProperty(_defineProperty({},nN,nN),"Intercom",nN),"intercom",nN);var iA="Keen";_defineProperty({},nj,iA),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nU,nU),"Keen",nU),"Keen.io",nU),"keen",nU),"keen.io",nU);var iC="Kissmetrics";_defineProperty({},nz,iC),_defineProperty(_defineProperty(_defineProperty({},nG,nG),"Kissmetrics",nG),"kissmetrics",nG);var iI="Klaviyo";_defineProperty({},nV,iI),_defineProperty(_defineProperty(_defineProperty({},nH,nH),"Klaviyo",nH),"klaviyo",nH);var iT="LaunchDarkly";_defineProperty({},nK,iT),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nQ,nQ),"LaunchDarkly",nQ),"Launch_Darkly",nQ),"Launch Darkly",nQ),"launchDarkly",nQ),"launch darkly",nQ);var iO="LinkedInInsightTag";_defineProperty({},nX,iO),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(R={},nq,nq),"LinkedIn Insight Tag",nq),"LinkedIn insight tag",nq),"linkedIn insight tag",nq),"Linkedin_insight_tag",nq),"LinkedinInsighttag",nq),"LinkedinInsightTag",nq),"LinkedInInsightTag",nq),"Linkedininsighttag",nq),"LINKEDININSIGHTTAG",nq),_defineProperty(R,"linkedininsighttag",nq);var iD="Lotame";_defineProperty({},n0,iD),_defineProperty(_defineProperty(_defineProperty({},nZ,nZ),"Lotame",nZ),"lotame",nZ);var iR="Lytics";_defineProperty({},n2,iR),_defineProperty(_defineProperty(_defineProperty({},n1,n1),"Lytics",n1),"lytics",n1);var iw="Mixpanel";_defineProperty({},rt,iw),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"MP","MP"),"MIXPANEL","MP"),"Mixpanel","MP"),"MIX PANEL","MP"),"Mix panel","MP"),"Mix Panel","MP");var iN="MoEngage";_defineProperty({},n9,iN),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},n8,n8),"MoEngage",n8),"moengage",n8),"Moengage",n8),"Mo Engage",n8),"mo engage",n8),"Mo engage",n8);var iM="Optimizely";_defineProperty({},rs,iM),_defineProperty(_defineProperty(_defineProperty({},ra,ra),"Optimizely",ra),"optimizely",ra);var iL="Pendo";_defineProperty({},ru,iL),_defineProperty(_defineProperty(_defineProperty({},rl,rl),"Pendo",rl),"pendo",rl);var ix="PinterestTag";_defineProperty({},rd,ix),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(N={},rc,rc),"PinterestTag",rc),"Pinterest_Tag",rc),"PINTERESTTAG",rc),"pinterest",rc),"PinterestAds",rc),"Pinterest_Ads",rc),"Pinterest",rc),"Pinterest Tag",rc),"Pinterest tag",rc),_defineProperty(_defineProperty(_defineProperty(_defineProperty(N,"PINTEREST TAG",rc),"pinterest tag",rc),"Pinterest Ads",rc),"Pinterest ads",rc);var iF="PostAffiliatePro";_defineProperty({},rp,iF),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rv,rv),"PostAffiliatePro",rv),"Post_affiliate_pro",rv),"Post Affiliate Pro",rv),"Post affiliate pro",rv),"post affiliate pro",rv),"postaffiliatepro",rv),"POSTAFFILIATEPRO",rv);var iB="Posthog";_defineProperty({},ry,iB),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rh,rh),"PostHog",rh),"Posthog",rh),"posthog",rh),"Post Hog",rh),"Post hog",rh),"post hog",rh);var iU="ProfitWell";_defineProperty({},r_,iU),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rm,rm),"ProfitWell",rm),"profitwell",rm),"Profitwell",rm),"Profit Well",rm),"profit well",rm),"Profit well",rm);var ij="Qualtrics";_defineProperty({},rS,ij),_defineProperty(_defineProperty(_defineProperty({},rk,rk),"Qualtrics",rk),"qualtrics",rk);var iG="QuantumMetric";_defineProperty({},rA,iG),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rE,rE),"Quantum Metric",rE),"quantum Metric",rE),"quantum metric",rE),"QuantumMetric",rE),"quantumMetric",rE),"quantummetric",rE),"Quantum_Metric",rE);var iz="RedditPixel";_defineProperty({},rO,iz),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rT,rT),"Reddit_Pixel",rT),"RedditPixel",rT),"REDDITPIXEL",rT),"redditpixel",rT),"Reddit Pixel",rT),"REDDIT PIXEL",rT),"reddit pixel",rT);var iH="Sentry";_defineProperty({},rG,iH),_defineProperty(_defineProperty(_defineProperty({},rj,rj),"sentry",rj),"Sentry",rj);var iV="SnapPixel";_defineProperty({},rQ,iV),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rV,rV),"Snap_Pixel",rV),"SnapPixel",rV),"SNAPPIXEL",rV),"snappixel",rV),"Snap Pixel",rV),"SNAP PIXEL",rV),"snap pixel",rV);var iQ="TVSquared";_defineProperty({},r1,iQ),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},r0,r0),"TVSquared",r0),"tvsquared",r0),"tvSquared",r0),"TvSquared",r0),"Tvsquared",r0),"TV Squared",r0),"tv squared",r0),"tv Squared",r0),_defineProperty({},"VWO","VWO"),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},"VWO","VWO"),"VisualWebsiteOptimizer","VWO"),"Visualwebsiteoptimizer","VWO"),"visualwebsiteoptimizer","VWO"),"vwo","VWO"),"Visual Website Optimizer","VWO"),"Visual website optimizer","VWO"),"visual website optimizer","VWO");var iK="GA360";_defineProperty({},ny,iK),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nh,nh),"Google Analytics 360",nh),"Google analytics 360",nh),"google analytics 360",nh),"Google Analytics360",nh),"Google analytics360",nh),"google analytics360",nh),"GoogleAnalytics360",nh),"GA 360",nh);var i$="Adroll";_defineProperty({},tQ,i$),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},tV,tV),"Adroll",tV),"Ad roll",tV),"ad roll",tV),"adroll",tV);var iW="DCMFloodlight";_defineProperty({},na,iW),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},no,no),"DCM Floodlight",no),"dcm floodlight",no),"Dcm Floodlight",no),"DCMFloodlight",no),"dcmfloodlight",no),"DcmFloodlight",no),"dcm_floodlight",no),"DCM_Floodlight",no);var iq="Matomo";_defineProperty({},n5,iq),_defineProperty(_defineProperty(_defineProperty({},n4,n4),"Matomo",n4),"matomo",n4);var iX="Vero";_defineProperty({},r4,iX),_defineProperty(_defineProperty(_defineProperty({},r2,r2),"Vero",r2),"vero",r2);var iJ="Mouseflow";_defineProperty({},re,iJ),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},n7,n7),"Mouseflow",n7),"mouseflow",n7),"mouseFlow",n7),"MouseFlow",n7),"Mouse flow",n7),"mouse flow",n7),"mouse Flow",n7),"Mouse Flow",n7);var iY="Rockerbox";_defineProperty({},rN,iY),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rw,rw),"Rockerbox",rw),"rockerbox",rw),"RockerBox",rw),"Rocker box",rw),"rocker box",rw),"Rocker Box",rw);var iZ="ConvertFlow";_defineProperty({},ne,iZ),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},t7,t7),"Convertflow",t7),"convertflow",t7),"convertFlow",t7),"ConvertFlow",t7),"Convert flow",t7),"convert flow",t7),"convert Flow",t7),"Convert Flow",t7),"CONVERT FLOW",t7);var i0="SnapEngage";_defineProperty({},r$,i0),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rK,rK),"SnapEngage",rK),"Snap_Engage",rK),"snapengage",rK),"SNAP ENGAGE",rK),"Snap Engage",rK),"snap engage",rK);var i1="LiveChat";_defineProperty({},nY,i1),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},nJ,nJ),"LiveChat",nJ),"Live_Chat",nJ),"livechat",nJ),"LIVE CHAT",nJ),"Live Chat",nJ),"live chat",nJ);var i2="Shynet";_defineProperty({},rH,i2),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rz,rz),"shynet",rz),"ShyNet",rz),"shyNet",rz),"Shynet",rz),"shy net",rz),"Shy Net",rz),"shy Net",rz),"Shy net",rz);var i4="Woopra";_defineProperty({},r3,i4),_defineProperty(_defineProperty(_defineProperty({},r5,r5),"Woopra",r5),"woopra",r5);var i5="RollBar";_defineProperty({},rL,i5),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rM,rM),"RollBar",rM),"Roll_Bar",rM),"rollbar",rM),"Rollbar",rM),"ROLL BAR",rM),"Roll Bar",rM),"roll bar",rM);var i3="QuoraPixel";_defineProperty({},rI,i3),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rC,rC),"Quora Pixel",rC),"Quora pixel",rC),"QUORA PIXEL",rC),"QuoraPixel",rC),"Quorapixel",rC),"QUORAPIXEL",rC),"Quora_Pixel",rC),"quora_pixel",rC),"Quora",rC);var i6="June";_defineProperty({},nB,i6),_defineProperty(_defineProperty(_defineProperty({},nF,nF),"June",nF),"june",nF);var i8="Engage";_defineProperty({},nc,i8),_defineProperty(_defineProperty(_defineProperty({},nu,nu),"Engage",nu),"engage",nu);var i9="Iterable";_defineProperty({},nx,i9),_defineProperty(_defineProperty(_defineProperty({},nL,nL),"Iterable",nL),"iterable",nL);var i7="YandexMetrica";_defineProperty({},r7,i7),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},r9,r9),"Yandexmetrica",r9),"yandexmetrica",r9),"yandexMetrica",r9),"YandexMetrica",r9);var oe="Refiner";_defineProperty({},rR,oe),_defineProperty(_defineProperty(_defineProperty({},rD,rD),"Refiner",rD),"refiner",rD);var ot="Qualaroo";_defineProperty({},rb,ot),_defineProperty(_defineProperty(_defineProperty({},rP,rP),"Qualaroo",rP),"qualaroo",rP);var on="Podsights";_defineProperty({},rg,on),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rf,rf),"Podsights",rf),"PodSights",rf),"pod Sights",rf),"Pod Sights",rf),"pod sights",rf),"POD SIGHTS",rf),"Pod sights",rf);var or="Axeptio";_defineProperty({},tX,or),_defineProperty(_defineProperty(_defineProperty({},tq,tq),"Axeptio",tq),"axeptio",tq);var oi="Satismeter";_defineProperty({},rF,oi),_defineProperty(_defineProperty(_defineProperty({},rx,rx),"Satismeter",rx),"SatisMeter",rx);var oo="MicrosoftClarity";_defineProperty({},n6,oo),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},n3,n3),"Microsoft Clarity",n3),"Microsoft clarity",n3),"microsoft clarity",n3),"Microsoft_clarity",n3),"MicrosoftClarity",n3),"MICROSOFTCLARITY",n3),"microsoftclarity",n3),"microsoftClarity",n3);var oa="Sendinblue";_defineProperty({},rU,oa),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rB,rB),"Sendinblue",rB),"sendinblue",rB),"SendinBlue",rB);var os="Olark";_defineProperty({},ro,os),_defineProperty(_defineProperty(_defineProperty({},ri,ri),"Olark",ri),"olark",ri);var ol="Lemnisk";_defineProperty({},nW,ol),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},n$,n$),"LEMNISK_MARKETING_AUTOMATION",n$),"Lemnisk Marketing Automation",n$),"LemniskMarketingAutomation",n$),"lemniskmarketingautomation",n$),"lemniskMarketingAutomation",n$),"lemnisk",n$),"Lemnisk",n$);var ou="TiktokAds";_defineProperty({},rZ,ou),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rY,rY),"TiktokAds",rY),"Tiktok ads",rY),"Tiktok Ads",rY),"Tik Tok Ads",rY),"tik tok ads",rY),"tiktokads",rY);var oc="ActiveCampaign";_defineProperty({},tG,oc),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({ActiveCampaign:tj,"Active Campaign":tj,"ACTIVE CAMPAIGN":tj},tj,tj),"activecampaign",tj),"active campaign",tj),"Active campaign",tj),"active Campaign",tj),"active_campaign",tj);var od="Sprig";_defineProperty({},rJ,od),_defineProperty(_defineProperty(_defineProperty({},rX,rX),"Sprig",rX),"sprig",rX);var of="SpotifyPixel";_defineProperty({},rq,of),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rW,rW),"Spotify Pixel",rW),"spotify pixel",rW),"SPOTIFY_PIXEL",rW);var og="CommandBar";_defineProperty({},t9,og),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},t8,t8),"Command Bar",t8),"Commandbar",t8),"COMMAND_BAR",t8),"commandbar",t8);var ov="Ninetailed";_defineProperty({},rr,ov),_defineProperty(_defineProperty(_defineProperty(_defineProperty({},rn,rn),"Ninetailed",rn),"ninetailed",rn),"NineTailed",rn);var op="Gainsight_PX";_defineProperty({},nk,op),_defineProperty(_defineProperty({},nb,nb),"Gainsight_PX",nb);var oh="XPixel";_defineProperty({},r8,oh),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty({},r6,r6),"XPixel",r6),"Xpixel",r6),"xpixel",r6),"xPixel",r6);var oy="Userpilot";_defineProperty({},it,oy),_defineProperty(_defineProperty(_defineProperty({},ie,ie),"userpilot",ie),"Userpilot",ie);var om=(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M={},nw,iS),np,"GA"),nR,ik),nC,im),"VWO","VWO"),nI,iP),t0,is),nM,iE),nj,iA),nz,iC),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,ni,ig),t5,iu),nf,ip),n0,iD),rs,iM),t2,il),nv,ih),r1,iQ),nm,"GA4"),nP,iy),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,n9,iN),tK,ii),ru,iL),n2,iR),tW,io),ry,iB),nV,iI),t6,ic),tY,ia),rd,ix),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,tH,ir),nX,iO),rO,iz),nl,iv),nO,ib),nn,id),rt,iw),rS,ij),r_,iU),rG,iH),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,rA,iG),rQ,iV),rp,iF),nE,i_),nK,iT),ny,iK),tQ,i$),na,iW),n5,iq),r4,iX),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,re,iJ),rN,iY),ne,iZ),r$,i0),nY,i1),rH,i2),r3,i4),rL,i5),rI,i3),nB,i6),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,nc,i8),nx,i9),r7,i7),rR,oe),rb,ot),rg,on),tX,or),rF,oi),n6,oo),rU,oa),_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(_defineProperty(M,ro,os),nW,ol),rZ,ou),tG,oc),rJ,od),rq,of),t9,og),rr,ov),nk,op),r8,oh),_defineProperty(M,it,oy)),isDestinationSDKMounted=function(o,f,v){var P;return!!((null===(P=globalThis[o])||void 0===P||null===(P=P[f])||void 0===P?void 0:P.prototype)&&void 0!==globalThis[o][f].prototype.constructor)},createDestinationInstance=function(o,f,v,P){var k,S,A=globalThis.rudderanalytics.getAnalyticsInstance(P.lifecycle.writeKey.value),C={loadIntegration:P.nativeDestinations.loadIntegration.value,logLevel:P.lifecycle.logLevel.value,loadOnlyIntegrations:null!==(k=null===(S=P.consents.postConsent.value)||void 0===S?void 0:S.integrations)&&void 0!==k?k:P.nativeDestinations.loadOnlyIntegrations.value,page:function(o,f,v,P,k){return A.page(pageArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P),getSanitizedValue(k)))},track:function(o,f,v,P){return A.track(trackArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))},identify:function(o,f,v,P){return A.identify(identifyArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))},alias:function(o,f,v,P){return A.alias(aliasArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))},group:function(o,f,v,P){return A.group(groupArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))},getAnonymousId:function(o){return A.getAnonymousId(getSanitizedValue(o))},getUserId:function(){return A.getUserId()},getUserTraits:function(){return A.getUserTraits()},getGroupId:function(){return A.getGroupId()},getGroupTraits:function(){return A.getGroupTraits()},getSessionId:function(){return A.getSessionId()}};return new globalThis[o][f](q(v.config),C,{shouldApplyDeviceModeTransformation:v.shouldApplyDeviceModeTransformation,propagateEventsUntransformedOnError:v.propagateEventsUntransformedOnError,destinationId:v.id})},_isDestinationReady=function(o){var f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise(function(v,P){var k,S=o.instance;if(S.isLoaded()&&(!S.isReady||S.isReady()))v(!0);else if(f>=11e3)P(Error((k=o.userFriendlyId,"A timeout of ".concat(11e3,' ms occurred while trying to check the ready status for "').concat(k,'" destination.'))));else{var A=Date.now();new Promise(function(o){globalThis.setTimeout(o,100)}).then(function(){_isDestinationReady(o,f+(Date.now()-A)).then(v).catch(function(o){return P(o)})})}})},getCumulativeIntegrationsConfig=function(o,f,v){var P,k,S,A=f;if(isFunction(null===(k=o.instance)||void 0===k?void 0:k.getDataForIntegrationsObject))try{A=mergeDeepRight(f,getSanitizedValue(null===(S=o.instance)||void 0===S?void 0:S.getDataForIntegrationsObject()))}catch(f){null==v||v.onError(f,tU,(P=o.userFriendlyId,"Failed to get integrations data for destination ".concat(P,".")))}return A},initializeDestination=function(o,f,v,P,k,S){try{var A,C=q(o),I=createDestinationInstance(v,P,o,f);C.instance=I,I.init(),_isDestinationReady(C).then(function(){isHybridModeDestination(C)&&(f.nativeDestinations.integrationsConfig.value=getCumulativeIntegrationsConfig(C,f.nativeDestinations.integrationsConfig.value,k)),f.nativeDestinations.initializedDestinations.value=[].concat(_toConsumableArray(f.nativeDestinations.initializedDestinations.value),[C])}).catch(function(v){f.nativeDestinations.failedDestinations.value=[].concat(_toConsumableArray(f.nativeDestinations.failedDestinations.value),[o]),null==S||S.error(v)})}catch(v){f.nativeDestinations.failedDestinations.value=[].concat(_toConsumableArray(f.nativeDestinations.failedDestinations.value),[o]),null==k||k.onError(v,tU,(A=o.userFriendlyId,"Failed to initialize destination ".concat(A,".")))}},o_="DeviceModeDestinations",oP={minRetryDelay:500,backoffFactor:2,maxAttempts:3},ob="DeviceModeTransformationPlugin",DMT_TRANSFORMATION_UNSUCCESSFUL_ERROR=function(o,f,v,P){return"".concat(o).concat(":: ",'Event transformation unsuccessful for destination "').concat(f,'". Reason: ').concat(v,". ").concat(P,".")},DMT_REQUEST_FAILED_ERROR=function(o,f,v,P){return"".concat(o).concat(":: ","[Destination: ").concat(f,"].Transformation request failed with status: ").concat(v,". Retries exhausted. ").concat(P,".")},sendTransformedEventToDestinations=function(o,f,v,P,k,S,A,C){var I="Sending untransformed event",T="Dropping the event";o.nativeDestinations.initializedDestinations.value.filter(function(o){return o&&v.includes(o.id)}).forEach(function(v){try{var O,D=[];switch(k){case 200:var R=JSON.parse(P).transformedBatch.find(function(o){return o.id===v.id});null==R||R.payload.forEach(function(o){if("200"===o.status)D.push(o.event);else{var f="Unknown";"410"===o.status&&(f="Transformation is not available");var P=T;!0===v.propagateEventsUntransformedOnError?(P=I,D.push(S),null==C||C.warn(DMT_TRANSFORMATION_UNSUCCESSFUL_ERROR(ob,v.displayName,f,P))):null==C||C.error(DMT_TRANSFORMATION_UNSUCCESSFUL_ERROR(ob,v.displayName,f,P))}});break;case 404:null==C||C.warn("".concat(ob).concat(":: ","Transformation server access is denied. The configuration data seems to be out of sync. Sending untransformed event to the destination.")),D.push(S);break;default:!0===v.propagateEventsUntransformedOnError?(null==C||C.warn(DMT_REQUEST_FAILED_ERROR(ob,v.displayName,k,I)),D.push(S)):null==C||C.error(DMT_REQUEST_FAILED_ERROR(ob,v.displayName,k,T))}null==D||D.forEach(function(P){isNonEmptyObject(P)&&f.invokeSingle("destinationsEventsQueue.enqueueEventToDestination",o,P,v,A,C)})}catch(o){null==A||A.onError(o,ob,(O=v.displayName,"[Destination:".concat(O,"].")))}})},ok="DeviceModeTransformation",oS={segment:"ajs_anonymous_id"},getSegmentAnonymousId=function(o){var f,v=o(tm);null!=v&&v.isEnabled&&(f=v.getItem(oS.segment));var P=o(ty);return!f&&null!=P&&P.isEnabled&&(f=P.getItem(oS.segment)),f},oE="ExternalAnonymousId",makeCRCTable=function(){for(var o,f=[],v=0;v<256;v++){o=v;for(var P=0;P<8;P++)o=1&o?3988292384^o>>>1:o>>>1;f[v]=o}return f},crc32=function(o){for(var f=makeCRCTable(),v=-1,P=0;P<o.length;P++)v=v>>>8^f[(v^o.charCodeAt(P))&255];return(-1^v)>>>0},oA={getUserLanguage:function(){var o;return null===(o=navigator)||void 0===o?void 0:o.language},getUserAgent:function(){var o;return null===(o=navigator)||void 0===o?void 0:o.userAgent}},decode=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return decodeURIComponent(globalThis.atob(o.endsWith("..")?o.substring(0,o.length-2):o).split("").map(function(o){var f="00".concat(o.charCodeAt(0).toString(16));return"%".concat(f.slice(-2))}).join(""))},oC=/^[\w.-]+$/,parseLinkerParamValue=function(o){var f=o.split("*"),v=f.length%2==0;if(f.length<4||!v||1!==Number(f.shift()))return null;var P=f.shift();return{checksum:null!=P?P:"",serializedIds:f.join("*")}},deserialize=function(o){if(!o)return{};for(var f={},v=o.split("*"),P=0;P<v.length;P+=2){var k=v[P];oC.test(k)&&(f[k]=decode(v[P+1]))}return f},isCheckSumValid=function(o,f){for(var v,P,k,S,A=oA.getUserAgent(),C=oA.getUserLanguage(),I=0;I<=1;I+=1){if(v=o,P=I,k=A,S=C,crc32([[k,new Date().getTimezoneOffset(),S].join("*"),Math.floor(Date.now()/6e4)-(P||0),v].join("*")).toString(36)===f)return!0}return!1},parseLinker=function(o){var f=parseLinkerParamValue(o);if(!f)return null;var v=f.checksum,P=f.serializedIds;return P&&v&&isCheckSumValid(P,v)?deserialize(P):null},oI="GoogleLinker",IUBENDA_CONSENT_COOKIE_READ_ERROR=function(o){return"".concat(o).concat(":: ","Failed to read the consent cookie.")},oT="IubendaConsentManagerPlugin",oO=/^_iub_cs-\d+$/,getIubendaCookieName=function(o){try{var f=document.cookie.split("; ").find(function(o){var f=o.split("="),v=_slicedToArray(f,1)[0];return oO.test((v||"").trim())});if(!f)throw Error("Iubenda Cookie not found with the specified pattern.");var v=f.split("=");return _slicedToArray(v,1)[0]||""}catch(f){return null==o||o.error(IUBENDA_CONSENT_COOKIE_READ_ERROR(oT),f),""}},getIubendaConsentData=function(o,f){var v,P=null;try{var k=null==o?void 0:o.setStore({id:oT,name:oT,type:ty,errorHandler:null==o?void 0:o.errorHandler,logger:null==o?void 0:o.logger});P=null==k?void 0:k.engine.getItem(getIubendaCookieName(f))}catch(o){null==f||f.error(IUBENDA_CONSENT_COOKIE_READ_ERROR(oT),o);return}if(!isNullOrUndefined(P)){try{v=JSON.parse(decodeURIComponent(P))}catch(o){null==f||f.error("".concat(oT).concat(":: ","Failed to parse the consent cookie."),o);return}if(v)return v.purposes}},getConsentData$1=function(o){var f=[],v=[];return o&&Object.entries(o).forEach(function(o){var P=o[0];o[1]?f.push(P):v.push(P)}),{allowedConsentIds:f,deniedConsentIds:v}},updateConsentStateFromData$1=function(o,f){var v=getConsentData$1(f);o.consents.initialized.value=isDefined(f),o.consents.data.value=v},oD="IubendaConsentManager",oR="KetchConsentManagerPlugin",getKetchConsentData=function(o,f){var v,P=null;try{var k=null==o?void 0:o.setStore({id:oR,name:oR,type:ty,errorHandler:null==o?void 0:o.errorHandler,logger:null==o?void 0:o.logger});P=null==k?void 0:k.engine.getItem("_ketch_consent_v1_")}catch(o){null==f||f.error("".concat(oR).concat(":: ","Failed to read the consent cookie."),o);return}if(!isNullOrUndefined(P)){try{v=JSON.parse(fromBase64(P))}catch(o){null==f||f.error("".concat(oR).concat(":: ","Failed to parse the consent cookie."),o);return}if(v){var S={};return Object.entries(v).forEach(function(o){var f=o[0],v=o[1];S[f]=(null==v?void 0:v.status)==="granted"}),S}}},getConsentData=function(o){var f=[],v=[];return o&&Object.entries(o).forEach(function(o){var P=o[0];o[1]?f.push(P):v.push(P)}),{allowedConsentIds:f,deniedConsentIds:v}},updateConsentStateFromData=function(o,f){var v=getConsentData(f);o.consents.initialized.value=isDefined(f),o.consents.data.value=v},ow="KetchConsentManager",oN={maxItems:100},oM="NativeDestinationQueuePlugin",isValidEventName=function(o){return o&&"string"==typeof o},isEventDenyListed=function(o,f,v){if("track"!==o)return!1;var P=v.config,k=P.blacklistedEvents,S=P.whitelistedEvents;switch(P.eventFilteringOption){case"blacklistedEvents":if(!isValidEventName(f))return!1;var A=f.trim();if(Array.isArray(k))return k.some(function(o){return o.eventName.trim()===A});return!1;case"whitelistedEvents":if(!isValidEventName(f))return!0;var C=f.trim();if(Array.isArray(S))return!S.some(function(o){return o.eventName.trim()===C});return!0;default:return!1}},sendEventToDestination=function(o,f,v,P){var k,S,A,C=o.type.toString();try{null===(S=f.instance)||void 0===S||null===(A=S[C])||void 0===A||A.call(S,{message:o})}catch(o){null==v||v.onError(o,oM,(k=f.userFriendlyId,'Failed to forward event to destination "'.concat(k,'".')))}},oL="NativeDestinationQueue",ox="OneTrustConsentManagerPlugin",oF="OneTrustConsentManager",oB="StorageEncryption",oU=(null===(L="undefined"!=typeof globalThis?globalThis:void 0)||void 0===L?void 0:L.crypto)||(null===(B="undefined"!=typeof global?global:void 0)||void 0===B?void 0:B.crypto)||(null===(U="undefined"!=typeof window?window:void 0)||void 0===U?void 0:U.crypto)||(null===(j="undefined"!=typeof self?self:void 0)||void 0===j?void 0:j.crypto)||(null===(G="undefined"!=typeof frames?frames:void 0)||void 0===G||null===(G=G[0])||void 0===G?void 0:G.crypto);z=oU?function(o){for(var f=[],v=0;v<o;v+=4)f.push(oU.getRandomValues(new Uint32Array(1))[0]);return new oG(f,o)}:function(o){for(var f,v=[],P=0;P<o;P+=4){var k=function(o){var f=o,v=987654321;return function(){var o=((v=36969*(65535&v)+(v>>16)&4294967295)<<16)+(f=18e3*(65535&f)+(f>>16)&4294967295)&4294967295;return o/=4294967296,(o+=.5)*(Math.random()>.5?1:-1)}}(4294967296*(f||Math.random()));f=987654071*k(),v.push(4294967296*k()|0)}return new oG(v,o)};var oj=_createClass(function Base(){_classCallCheck(this,Base)},[{key:"mixIn",value:function(o){return Object.assign(this,o)}},{key:"clone",value:function(){var o=new this.constructor;return Object.assign(o,this),o}}],[{key:"create",value:function(){for(var o=arguments.length,f=Array(o),v=0;v<o;v++)f[v]=arguments[v];return function(o,f,v){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var P=[null];return P.push.apply(P,f),new(o.bind.apply(o,P))}(this,f)}}]),oG=function(o){function WordArray(){var o,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4*f.length;_classCallCheck(this,WordArray),o=_callSuper(this,WordArray);var P=f;if(P instanceof ArrayBuffer&&(P=new Uint8Array(P)),(P instanceof Int8Array||P instanceof Uint8ClampedArray||P instanceof Int16Array||P instanceof Uint16Array||P instanceof Int32Array||P instanceof Uint32Array||P instanceof Float32Array||P instanceof Float64Array)&&(P=new Uint8Array(P.buffer,P.byteOffset,P.byteLength)),P instanceof Uint8Array){for(var k=P.byteLength,S=[],A=0;A<k;A+=1)S[A>>>2]|=P[A]<<24-A%4*8;o.words=S,o.sigBytes=k}else o.words=f,o.sigBytes=v;return o}return _inherits(WordArray,o),_createClass(WordArray,[{key:"toString",value:function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oz;return o.stringify(this)}},{key:"concat",value:function(o){var f=this.words,v=o.words,P=this.sigBytes,k=o.sigBytes;if(this.clamp(),P%4)for(var S=0;S<k;S+=1){var A=v[S>>>2]>>>24-S%4*8&255;f[P+S>>>2]|=A<<24-(P+S)%4*8}else for(var C=0;C<k;C+=4)f[P+C>>>2]=v[C>>>2];return this.sigBytes+=k,this}},{key:"clamp",value:function(){var o=this.words,f=this.sigBytes;o[f>>>2]&=4294967295<<32-f%4*8,o.length=Math.ceil(f/4)}},{key:"clone",value:function(){var o=_superPropGet(WordArray,"clone",this,1).call(this);return o.words=this.words.slice(0),o}}])}(oj);_defineProperty(oG,"random",z);for(var oz={stringify:function(o){for(var f=o.words,v=o.sigBytes,P=[],k=0;k<v;k+=1){var S=f[k>>>2]>>>24-k%4*8&255;P.push((S>>>4).toString(16)),P.push((15&S).toString(16))}return P.join("")},parse:function(o){for(var f=o.length,v=[],P=0;P<f;P+=2)v[P>>>3]|=parseInt(o.substr(P,2),16)<<24-P%8*4;return new oG(v,f/2)}},oH={stringify:function(o){for(var f=o.words,v=o.sigBytes,P=[],k=0;k<v;k+=1){var S=f[k>>>2]>>>24-k%4*8&255;P.push(String.fromCharCode(S))}return P.join("")},parse:function(o){for(var f=o.length,v=[],P=0;P<f;P+=1)v[P>>>2]|=(255&o.charCodeAt(P))<<24-P%4*8;return new oG(v,f)}},oV={stringify:function(o){try{return decodeURIComponent(escape(oH.stringify(o)))}catch(o){throw Error("Malformed UTF-8 data")}},parse:function(o){return oH.parse(unescape(encodeURIComponent(o)))}},oQ=function(o){function BufferedBlockAlgorithm(){var o;return _classCallCheck(this,BufferedBlockAlgorithm),(o=_callSuper(this,BufferedBlockAlgorithm))._minBufferSize=0,o}return _inherits(BufferedBlockAlgorithm,o),_createClass(BufferedBlockAlgorithm,[{key:"reset",value:function(){this._data=new oG,this._nDataBytes=0}},{key:"_append",value:function(o){var f=o;"string"==typeof f&&(f=oV.parse(f)),this._data.concat(f),this._nDataBytes+=f.sigBytes}},{key:"_process",value:function(o){var f,v=this._data,P=this.blockSize,k=v.words,S=v.sigBytes,A=S/(4*P),C=(A=o?Math.ceil(A):Math.max((0|A)-this._minBufferSize,0))*P,I=Math.min(4*C,S);if(C){for(var T=0;T<C;T+=P)this._doProcessBlock(k,T);f=k.splice(0,C),v.sigBytes-=I}return new oG(f,I)}},{key:"clone",value:function(){var o=_superPropGet(BufferedBlockAlgorithm,"clone",this,1).call(this);return o._data=this._data.clone(),o}}])}(oj),oK=function(o){function Hasher(o){var f;return _classCallCheck(this,Hasher),(f=_callSuper(this,Hasher)).blockSize=16,f.cfg=Object.assign(new oj,o),f.reset(),f}return _inherits(Hasher,o),_createClass(Hasher,[{key:"reset",value:function(){_superPropGet(Hasher,"reset",this,1).call(this),this._doReset()}},{key:"update",value:function(o){return this._append(o),this._process(),this}},{key:"finalize",value:function(o){return o&&this._append(o),this._doFinalize()}}],[{key:"_createHelper",value:function(o){return function(f,v){return new o(v).finalize(f)}}},{key:"_createHmacHelper",value:function(o){return function(f,v){return new o$(o,v).finalize(f)}}}])}(oQ),o$=function(o){function HMAC(o,f){_classCallCheck(this,HMAC),v=_callSuper(this,HMAC);var v,P=new o;v._hasher=P;var k=f;"string"==typeof k&&(k=oV.parse(k));var S=P.blockSize,A=4*S;k.sigBytes>A&&(k=P.finalize(f)),k.clamp();var C=k.clone();v._oKey=C;var I=k.clone();v._iKey=I;for(var T=C.words,O=I.words,D=0;D<S;D+=1)T[D]^=1549556828,O[D]^=909522486;return C.sigBytes=A,I.sigBytes=A,v.reset(),v}return _inherits(HMAC,o),_createClass(HMAC,[{key:"reset",value:function(){var o=this._hasher;o.reset(),o.update(this._iKey)}},{key:"update",value:function(o){return this._hasher.update(o),this}},{key:"finalize",value:function(o){var f=this._hasher,v=f.finalize(o);return f.reset(),f.finalize(this._oKey.clone().concat(v))}}])}(oj),parseLoop=function(o,f,v){for(var P=[],k=0,S=0;S<f;S+=1)if(S%4){var A=v[o.charCodeAt(S-1)]<<S%4*2|v[o.charCodeAt(S)]>>>6-S%4*2;P[k>>>2]|=A<<24-k%4*8,k+=1}return oG.create(P,k)},oW={stringify:function(o){var f=o.words,v=o.sigBytes,P=this._map;o.clamp();for(var k=[],S=0;S<v;S+=3)for(var A=(f[S>>>2]>>>24-S%4*8&255)<<16|(f[S+1>>>2]>>>24-(S+1)%4*8&255)<<8|f[S+2>>>2]>>>24-(S+2)%4*8&255,C=0;C<4&&S+.75*C<v;C+=1)k.push(P.charAt(A>>>6*(3-C)&63));var I=P.charAt(64);if(I)for(;k.length%4;)k.push(I);return k.join("")},parse:function(o){var f=o.length,v=this._map,P=this._reverseMap;if(!P){this._reverseMap=[],P=this._reverseMap;for(var k=0;k<v.length;k+=1)P[v.charCodeAt(k)]=k}var S=v.charAt(64);if(S){var A=o.indexOf(S);-1!==A&&(f=A)}return parseLoop(o,f,P)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},oq=[],oX=0;oX<64;oX+=1)oq[oX]=4294967296*Math.abs(Math.sin(oX+1))|0;var FF=function(o,f,v,P,k,S,A){var C=o+(f&v|~f&P)+k+A;return(C<<S|C>>>32-S)+f},GG=function(o,f,v,P,k,S,A){var C=o+(f&P|v&~P)+k+A;return(C<<S|C>>>32-S)+f},HH=function(o,f,v,P,k,S,A){var C=o+(f^v^P)+k+A;return(C<<S|C>>>32-S)+f},II=function(o,f,v,P,k,S,A){var C=o+(v^(f|~P))+k+A;return(C<<S|C>>>32-S)+f},oJ=function(o){function MD5Algo(){return _classCallCheck(this,MD5Algo),_callSuper(this,MD5Algo,arguments)}return _inherits(MD5Algo,o),_createClass(MD5Algo,[{key:"_doReset",value:function(){this._hash=new oG([1732584193,4023233417,2562383102,271733878])}},{key:"_doProcessBlock",value:function(o,f){for(var v=0;v<16;v+=1){var P=f+v,k=o[P];o[P]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}var S=this._hash.words,A=o[f+0],C=o[f+1],I=o[f+2],T=o[f+3],O=o[f+4],D=o[f+5],R=o[f+6],N=o[f+7],M=o[f+8],L=o[f+9],B=o[f+10],U=o[f+11],j=o[f+12],G=o[f+13],z=o[f+14],H=o[f+15],V=S[0],Q=S[1],K=S[2],$=S[3];V=FF(V,Q,K,$,A,7,oq[0]),$=FF($,V,Q,K,C,12,oq[1]),K=FF(K,$,V,Q,I,17,oq[2]),Q=FF(Q,K,$,V,T,22,oq[3]),V=FF(V,Q,K,$,O,7,oq[4]),$=FF($,V,Q,K,D,12,oq[5]),K=FF(K,$,V,Q,R,17,oq[6]),Q=FF(Q,K,$,V,N,22,oq[7]),V=FF(V,Q,K,$,M,7,oq[8]),$=FF($,V,Q,K,L,12,oq[9]),K=FF(K,$,V,Q,B,17,oq[10]),Q=FF(Q,K,$,V,U,22,oq[11]),V=FF(V,Q,K,$,j,7,oq[12]),$=FF($,V,Q,K,G,12,oq[13]),K=FF(K,$,V,Q,z,17,oq[14]),Q=FF(Q,K,$,V,H,22,oq[15]),V=GG(V,Q,K,$,C,5,oq[16]),$=GG($,V,Q,K,R,9,oq[17]),K=GG(K,$,V,Q,U,14,oq[18]),Q=GG(Q,K,$,V,A,20,oq[19]),V=GG(V,Q,K,$,D,5,oq[20]),$=GG($,V,Q,K,B,9,oq[21]),K=GG(K,$,V,Q,H,14,oq[22]),Q=GG(Q,K,$,V,O,20,oq[23]),V=GG(V,Q,K,$,L,5,oq[24]),$=GG($,V,Q,K,z,9,oq[25]),K=GG(K,$,V,Q,T,14,oq[26]),Q=GG(Q,K,$,V,M,20,oq[27]),V=GG(V,Q,K,$,G,5,oq[28]),$=GG($,V,Q,K,I,9,oq[29]),K=GG(K,$,V,Q,N,14,oq[30]),Q=GG(Q,K,$,V,j,20,oq[31]),V=HH(V,Q,K,$,D,4,oq[32]),$=HH($,V,Q,K,M,11,oq[33]),K=HH(K,$,V,Q,U,16,oq[34]),Q=HH(Q,K,$,V,z,23,oq[35]),V=HH(V,Q,K,$,C,4,oq[36]),$=HH($,V,Q,K,O,11,oq[37]),K=HH(K,$,V,Q,N,16,oq[38]),Q=HH(Q,K,$,V,B,23,oq[39]),V=HH(V,Q,K,$,G,4,oq[40]),$=HH($,V,Q,K,A,11,oq[41]),K=HH(K,$,V,Q,T,16,oq[42]),Q=HH(Q,K,$,V,R,23,oq[43]),V=HH(V,Q,K,$,L,4,oq[44]),$=HH($,V,Q,K,j,11,oq[45]),K=HH(K,$,V,Q,H,16,oq[46]),Q=HH(Q,K,$,V,I,23,oq[47]),V=II(V,Q,K,$,A,6,oq[48]),$=II($,V,Q,K,N,10,oq[49]),K=II(K,$,V,Q,z,15,oq[50]),Q=II(Q,K,$,V,D,21,oq[51]),V=II(V,Q,K,$,j,6,oq[52]),$=II($,V,Q,K,T,10,oq[53]),K=II(K,$,V,Q,B,15,oq[54]),Q=II(Q,K,$,V,C,21,oq[55]),V=II(V,Q,K,$,M,6,oq[56]),$=II($,V,Q,K,H,10,oq[57]),K=II(K,$,V,Q,R,15,oq[58]),Q=II(Q,K,$,V,G,21,oq[59]),V=II(V,Q,K,$,O,6,oq[60]),$=II($,V,Q,K,U,10,oq[61]),K=II(K,$,V,Q,I,15,oq[62]),Q=II(Q,K,$,V,L,21,oq[63]),S[0]=S[0]+V|0,S[1]=S[1]+Q|0,S[2]=S[2]+K|0,S[3]=S[3]+$|0}},{key:"_doFinalize",value:function(){var o=this._data,f=o.words,v=8*this._nDataBytes,P=8*o.sigBytes;f[P>>>5]|=128<<24-P%32;var k=Math.floor(v/4294967296);f[(P+64>>>9<<4)+15]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360,f[(P+64>>>9<<4)+14]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,o.sigBytes=(f.length+1)*4,this._process();for(var S=this._hash,A=S.words,C=0;C<4;C+=1){var I=A[C];A[C]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360}return S}},{key:"clone",value:function(){var o=_superPropGet(MD5Algo,"clone",this,1).call(this);return o._hash=this._hash.clone(),o}}])}(oK);oK._createHelper(oJ),oK._createHmacHelper(oJ);var oY=function(o){function EvpKDFAlgo(o){var f;return _classCallCheck(this,EvpKDFAlgo),(f=_callSuper(this,EvpKDFAlgo)).cfg=Object.assign(new oj,{keySize:4,hasher:oJ,iterations:1},o),f}return _inherits(EvpKDFAlgo,o),_createClass(EvpKDFAlgo,[{key:"compute",value:function(o,f){for(var v,P=this.cfg,k=P.hasher.create(),S=oG.create(),A=S.words,C=P.keySize,I=P.iterations;A.length<C;){v&&k.update(v),v=k.update(o).finalize(f),k.reset();for(var T=1;T<I;T+=1)v=k.finalize(v),k.reset();S.concat(v)}return S.sigBytes=4*C,S}}])}(oj),oZ="function"!=typeof Object.assign?function(o){if(null==o)throw TypeError("Cannot convert undefined or null to object");o=Object(o);for(var f=1;f<arguments.length;f++){var v=arguments[f];if(null!=v)for(var P in v)Object.prototype.hasOwnProperty.call(v,P)&&(o[P]=v[P])}return o}:Object.assign,o0=function(o){function Cipher(o,f,v){var P;return _classCallCheck(this,Cipher),(P=_callSuper(this,Cipher)).cfg=oZ(new oj,v),P._xformMode=o,P._key=f,P.reset(),P}return _inherits(Cipher,o),_createClass(Cipher,[{key:"reset",value:function(){_superPropGet(Cipher,"reset",this,1).call(this),this._doReset()}},{key:"process",value:function(o){return this._append(o),this._process()}},{key:"finalize",value:function(o){return o&&this._append(o),this._doFinalize()}}],[{key:"createEncryptor",value:function(o,f){return this.create(this._ENC_XFORM_MODE,o,f)}},{key:"createDecryptor",value:function(o,f){return this.create(this._DEC_XFORM_MODE,o,f)}},{key:"_createHelper",value:function(o){var selectCipherStrategy=function(o){return"string"==typeof o?o6:o3};return{encrypt:function(f,v,P){return selectCipherStrategy(v).encrypt(o,f,v,P)},decrypt:function(f,v,P){return selectCipherStrategy(v).decrypt(o,f,v,P)}}}}])}(oQ);function xorBlock(o,f,v){var P,k=this._iv;k?(P=k,this._iv=void 0):P=this._prevBlock;for(var S=0;S<v;S+=1)o[f+S]^=P[S]}o0._ENC_XFORM_MODE=1,o0._DEC_XFORM_MODE=2,o0.keySize=4,o0.ivSize=4;var o1=function(o){function CBC(){return _classCallCheck(this,CBC),_callSuper(this,CBC,arguments)}return _inherits(CBC,o),_createClass(CBC)}(function(o){function BlockCipherMode(o,f){var v;return _classCallCheck(this,BlockCipherMode),(v=_callSuper(this,BlockCipherMode))._cipher=o,v._iv=f,v}return _inherits(BlockCipherMode,o),_createClass(BlockCipherMode,null,[{key:"createEncryptor",value:function(o,f){return this.Encryptor.create(o,f)}},{key:"createDecryptor",value:function(o,f){return this.Decryptor.create(o,f)}}])}(oj));o1.Encryptor=function(o){function _class(){return _classCallCheck(this,_class),_callSuper(this,_class,arguments)}return _inherits(_class,o),_createClass(_class,[{key:"processBlock",value:function(o,f){var v=this._cipher,P=v.blockSize;xorBlock.call(this,o,f,P),v.encryptBlock(o,f),this._prevBlock=o.slice(f,f+P)}}])}(o1),o1.Decryptor=function(o){function _class2(){return _classCallCheck(this,_class2),_callSuper(this,_class2,arguments)}return _inherits(_class2,o),_createClass(_class2,[{key:"processBlock",value:function(o,f){var v=this._cipher,P=v.blockSize,k=o.slice(f,f+P);v.decryptBlock(o,f),xorBlock.call(this,o,f,P),this._prevBlock=k}}])}(o1);var o2={pad:function(o,f){for(var v=4*f,P=v-o.sigBytes%v,k=P<<24|P<<16|P<<8|P,S=[],A=0;A<P;A+=4)S.push(k);var C=oG.create(S,P);o.concat(C)},unpad:function(o){var f=255&o.words[o.sigBytes-1>>>2];o.sigBytes-=f}},o4=function(o){function BlockCipher(o,f,v){var P;return _classCallCheck(this,BlockCipher),(P=_callSuper(this,BlockCipher,[o,f,oZ({mode:o1,padding:o2},v)])).blockSize=4,P}return _inherits(BlockCipher,o),_createClass(BlockCipher,[{key:"reset",value:function(){_superPropGet(BlockCipher,"reset",this,1).call(this);var o,f=this.cfg,v=f.iv,P=f.mode;this._xformMode===this.constructor._ENC_XFORM_MODE?o=P.createEncryptor:(o=P.createDecryptor,this._minBufferSize=1),this._mode=o.call(P,this,v&&v.words),this._mode.__creator=o}},{key:"_doProcessBlock",value:function(o,f){this._mode.processBlock(o,f)}},{key:"_doFinalize",value:function(){var o,f=this.cfg.padding;return this._xformMode===this.constructor._ENC_XFORM_MODE?(f.pad(this._data,this.blockSize),o=this._process(!0)):(o=this._process(!0),f.unpad(o)),o}}])}(o0),o5=function(o){function CipherParams(o){var f;return _classCallCheck(this,CipherParams),(f=_callSuper(this,CipherParams)).mixIn(o),f}return _inherits(CipherParams,o),_createClass(CipherParams,[{key:"toString",value:function(o){return(o||this.formatter).stringify(this)}}])}(oj),o3=function(o){function SerializableCipher(){return _classCallCheck(this,SerializableCipher),_callSuper(this,SerializableCipher,arguments)}return _inherits(SerializableCipher,o),_createClass(SerializableCipher,null,[{key:"encrypt",value:function(o,f,v,P){var k=oZ(new oj,this.cfg,P),S=o.createEncryptor(v,k),A=S.finalize(f),C=S.cfg;return o5.create({ciphertext:A,key:v,iv:C.iv,algorithm:o,mode:C.mode,padding:C.padding,blockSize:S.blockSize,formatter:k.format})}},{key:"decrypt",value:function(o,f,v,P){var k=f,S=oZ(new oj,this.cfg,P);return k=this._parse(k,S.format),o.createDecryptor(v,S).finalize(k.ciphertext)}},{key:"_parse",value:function(o,f){return"string"==typeof o?f.parse(o,this):o}}])}(oj);o3.cfg=oZ(new oj,{format:{stringify:function(o){var f=o.ciphertext,v=o.salt;return(v?oG.create([1398893684,1701076831]).concat(v).concat(f):f).toString(oW)},parse:function(o){var f,v=oW.parse(o),P=v.words;return 1398893684===P[0]&&1701076831===P[1]&&(f=oG.create(P.slice(2,4)),P.splice(0,4),v.sigBytes-=16),o5.create({ciphertext:v,salt:f})}}});var o6=function(o){function PasswordBasedCipher(){return _classCallCheck(this,PasswordBasedCipher),_callSuper(this,PasswordBasedCipher,arguments)}return _inherits(PasswordBasedCipher,o),_createClass(PasswordBasedCipher,null,[{key:"encrypt",value:function(o,f,v,P){var k=oZ(new oj,this.cfg,P),S=k.kdf.execute(v,o.keySize,o.ivSize,k.salt,k.hasher);k.iv=S.iv;var A=o3.encrypt.call(this,o,f,S.key,k);return A.mixIn(S),A}},{key:"decrypt",value:function(o,f,v,P){var k=f,S=oZ(new oj,this.cfg,P);k=this._parse(k,S.format);var A=S.kdf.execute(v,o.keySize,o.ivSize,k.salt,S.hasher);return S.iv=A.iv,o3.decrypt.call(this,o,k,A.key,S)}}])}(o3);o6.cfg=oZ(o3.cfg,{kdf:{execute:function(o,f,v,P,k){var S,A=P;A||(A=oG.random(8)),S=k?oY.create({keySize:f+v,hasher:k}).compute(o,A):oY.create({keySize:f+v}).compute(o,A);var C=oG.create(S.words.slice(f),4*v);return S.sigBytes=4*f,o5.create({key:S,iv:C,salt:A})}}});for(var o8=[],o9=[],o7=[],ae=[],at=[],an=[],ar=[],ai=[],ao=[],aa=[],as=[],al=0;al<256;al+=1)al<128?as[al]=al<<1:as[al]=al<<1^283;for(var au=0,ac=0,ad=0;ad<256;ad+=1){var af=ac^ac<<1^ac<<2^ac<<3^ac<<4;af=af>>>8^255&af^99,o8[au]=af,o9[af]=au;var ag=as[au],av=as[ag],ap=as[av],ah=257*as[af]^16843008*af;o7[au]=ah<<24|ah>>>8,ae[au]=ah<<16|ah>>>16,at[au]=ah<<8|ah>>>24,an[au]=ah,ah=16843009*ap^65537*av^257*ag^16843008*au,ar[af]=ah<<24|ah>>>8,ai[af]=ah<<16|ah>>>16,ao[af]=ah<<8|ah>>>24,aa[af]=ah,au?(au=ag^as[as[as[ap^ag]]],ac^=as[as[ac]]):au=ac=1}var ay=[0,1,2,4,8,16,32,64,128,27,54],am=function(o){function AESAlgo(){return _classCallCheck(this,AESAlgo),_callSuper(this,AESAlgo,arguments)}return _inherits(AESAlgo,o),_createClass(AESAlgo,[{key:"_doReset",value:function(){if(!this._nRounds||this._keyPriorReset!==this._key){this._keyPriorReset=this._key;var o,f=this._keyPriorReset,v=f.words,P=f.sigBytes/4;this._nRounds=P+6;var k=(this._nRounds+1)*4;this._keySchedule=[];for(var S=this._keySchedule,A=0;A<k;A+=1)A<P?S[A]=v[A]:(o=S[A-1],A%P?P>6&&A%P==4&&(o=o8[o>>>24]<<24|o8[o>>>16&255]<<16|o8[o>>>8&255]<<8|o8[255&o]):o=(o8[(o=o<<8|o>>>24)>>>24]<<24|o8[o>>>16&255]<<16|o8[o>>>8&255]<<8|o8[255&o])^ay[A/P|0]<<24,S[A]=S[A-P]^o);this._invKeySchedule=[];for(var C=this._invKeySchedule,I=0;I<k;I+=1){var T=k-I;o=I%4?S[T]:S[T-4],I<4||T<=4?C[I]=o:C[I]=ar[o8[o>>>24]]^ai[o8[o>>>16&255]]^ao[o8[o>>>8&255]]^aa[o8[255&o]]}}}},{key:"encryptBlock",value:function(o,f){this._doCryptBlock(o,f,this._keySchedule,o7,ae,at,an,o8)}},{key:"decryptBlock",value:function(o,f){var v=o[f+1];o[f+1]=o[f+3],o[f+3]=v,this._doCryptBlock(o,f,this._invKeySchedule,ar,ai,ao,aa,o9),v=o[f+1],o[f+1]=o[f+3],o[f+3]=v}},{key:"_doCryptBlock",value:function(o,f,v,P,k,S,A,C){for(var I=this._nRounds,T=o[f]^v[0],O=o[f+1]^v[1],D=o[f+2]^v[2],R=o[f+3]^v[3],N=4,M=1;M<I;M+=1){var L=P[T>>>24]^k[O>>>16&255]^S[D>>>8&255]^A[255&R]^v[N];N+=1;var B=P[O>>>24]^k[D>>>16&255]^S[R>>>8&255]^A[255&T]^v[N];N+=1;var U=P[D>>>24]^k[R>>>16&255]^S[T>>>8&255]^A[255&O]^v[N];N+=1;var j=P[R>>>24]^k[T>>>16&255]^S[O>>>8&255]^A[255&D]^v[N];N+=1,T=L,O=B,D=U,R=j}var G=(C[T>>>24]<<24|C[O>>>16&255]<<16|C[D>>>8&255]<<8|C[255&R])^v[N];N+=1;var z=(C[O>>>24]<<24|C[D>>>16&255]<<16|C[R>>>8&255]<<8|C[255&T])^v[N];N+=1;var H=(C[D>>>24]<<24|C[R>>>16&255]<<16|C[T>>>8&255]<<8|C[255&O])^v[N];N+=1;var V=(C[R>>>24]<<24|C[T>>>16&255]<<16|C[O>>>8&255]<<8|C[255&D])^v[N];N+=1,o[f]=G,o[f+1]=z,o[f+2]=H,o[f+3]=V}}])}(o4);am.keySize=8;var a_=o4._createHelper(am),aP="RudderEncrypt:",ab="Rudder",decrypt=function(o){return o.startsWith(aP)?a_.decrypt(o.substring(aP.length),ab).toString(oV):o},ak="StorageEncryptionLegacy",aS="StorageMigrator",aE={maxRetryDelay:36e4,minRetryDelay:1e3,backoffFactor:2,maxAttempts:10,maxItems:100},getBatchDeliveryPayload=function(o,f,v){return stringifyWithoutCircular({batch:o,sentAt:f},!0,void 0,v)},getDeliveryUrl=function(o,f){var v=new URL(o);return new URL(removeDuplicateSlashes([v.pathname,"/","v1","/",f].join("")),v).href},logErrorOnFailure=function(o,f,v,P){var k,S,A,C=(k=null!==(S=null==o||null===(A=o.error)||void 0===A?void 0:A.message)&&void 0!==S?S:"Unknown","".concat("XhrQueuePlugin").concat(":: ","Failed to deliver event(s). Cause: ").concat(k,".")),I="The event(s) will be dropped.";f?v.willBeRetried?(C="".concat(C," The event(s) will be retried."),v.retryAttemptNumber>0&&(C="".concat(C," Retry attempt ").concat(v.retryAttemptNumber," of ").concat(v.maxRetryAttempts,"."))):C="".concat(C," Retries exhausted (").concat(v.maxRetryAttempts,"). ").concat(I):C="".concat(C," ").concat(I),null==P||P.error(C)},getRequestInfo=function(o,f,v,P){var k,S,A,C=getCurrentTimeFormatted();if(Array.isArray(o))k=getBatchDeliveryPayload(o.map(function(o){return getFinalEventForDeliveryMutator(o.event,C)}),C,P),S=o[0]?q(o[0].headers):{},A=getDeliveryUrl(f.lifecycle.activeDataplaneUrl.value,"batch");else{var I=o.url,T=o.event,O=o.headers;k=getDeliveryPayload(getFinalEventForDeliveryMutator(T,C),P),S=q(O),A=I}return S.SentAt=C,v.reclaimed&&(S.Reclaimed="true"),v.retryAttemptNumber>0&&(S["Retry-Attempt"]=v.retryAttemptNumber.toString(),S["Retried-After"]=v.timeSinceLastAttempt.toString(),S["Retried-After-First"]=v.timeSinceFirstAttempt.toString()),{data:k,headers:S,url:A}},aA="XhrQueue",getMandatoryPluginsMap=function(){return{}},aC=_objectSpread2(_objectSpread2({},getMandatoryPluginsMap()),{BeaconQueue:function(){return{name:tF,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[tF])},dataplaneEventsQueue:{init:function(o,f,v,P,k){var S,A=o.lifecycle.writeKey.value,C=getDeliveryUrl$1(o.lifecycle.activeDataplaneUrl.value,A),I=mergeDeepRight(tC,null!==(S=o.loadOptions.value.beaconQueueOptions)&&void 0!==S?S:{});return new tx("".concat("rudder_beacon","_").concat(A),{batch:{enabled:!0,flushInterval:I.flushQueueInterval,maxSize:65536,maxItems:I.maxItems}},function(o,f){null==k||k.debug("".concat(tI).concat(":: ","Sending events to data plane."));var v=getCurrentTimeFormatted(),S=getBatchDeliveryPayload$1(o.map(function(o){return getFinalEventForDeliveryMutator(o.event,v)}),v,k);if(S)try{var A=navigator.sendBeacon(C,S);A||null==k||k.error("".concat(tI).concat(":: ","Failed to send events batch data to the browser's beacon queue. The events will be dropped.")),f(null,A)}catch(o){null==P||P.onError(o,tI,"Failed to send events batch data to the browser's beacon queue for URL ".concat(C,".")),f(null)}else f(null)},v,tm,k,function(o){var f=getCurrentTimeFormatted();return getBatchDeliveryPayload$1(o.map(function(o){return o.event}),f,k).size})},enqueue:function(o,f,v,P,k){v.sentAt=getCurrentTimeFormatted(),validateEventPayloadSize(v,k),f.addItem({event:v})}}}},CustomConsentManager:function(){return{name:tB,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[tB])},consentManager:{init:function(o,f){},updateConsentsInfo:function(o,f,v){},isDestinationConsented:function(o,f,v,P){if(!o.consents.initialized.value)return!0;var k=o.consents.data.value.allowedConsentIds;try{var S,A=f.consentManagement;if(!A)return!0;var C=A.find(function(f){return f.provider===o.consents.provider.value});if(!(null!=C&&C.consents))return!0;var I=C.consents.map(function(o){return o.consent.trim()}).filter(function(o){return o}),T=null!==(S=C.resolutionStrategy)&&void 0!==S?S:o.consents.resolutionStrategy.value,matchPredicate=function(o){return k.includes(o)};if("or"===T)return I.some(matchPredicate)||0===I.length;return I.every(matchPredicate)}catch(o){return null==v||v.onError(o,"CustomConsentManagerPlugin","Failed to determine the consent status for the destination. Please check the destination configuration and try again."),!0}}}}},DeviceModeDestinations:function(){return{name:o_,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[o_])},nativeDestinations:{setActiveDestinations:function(o,f,v,P){o.nativeDestinations.loadIntegration.value=o.loadOptions.value.loadIntegration;var k,S,A=o.nativeDestinations.configuredDestinations.value.filter(function(o){var f;return!!om[o.displayName]||(null==v||v.onError(Error((f=o.userFriendlyId,"Destination ".concat(f," is not supported."))),tU),!1)}),C=filterDestinations(null!==(k=null===(S=o.consents.postConsent.value)||void 0===S?void 0:S.integrations)&&void 0!==k?k:o.nativeDestinations.loadOnlyIntegrations.value,A).filter(function(k){var S;return null===(S=f.invokeSingle("consentManager.isDestinationConsented",o,k.config,v,P))||void 0===S||S});o.nativeDestinations.activeDestinations.value=C},load:function(o,f,v,P,k){var S=o.lifecycle.integrationsCDNPath.value;o.nativeDestinations.activeDestinations.value.forEach(function(A){var C=om[A.displayName],I="".concat(C,"_RS");if(C&&!isDestinationSDKMounted(I,C)){var T="".concat(S,"/").concat(C,".min.js");f.loadJSFile({url:T,id:A.userFriendlyId,callback:null!=k?k:function(f){f?initializeDestination(A,o,I,C,v,P):(null==P||P.error(DESTINATION_SDK_LOAD_ERROR(tU,A.userFriendlyId)),o.nativeDestinations.failedDestinations.value=[].concat(_toConsumableArray(o.nativeDestinations.failedDestinations.value),[A]))},timeout:1e4})}else C?initializeDestination(A,o,I,C,v,P):null==P||P.error(DESTINATION_SDK_LOAD_ERROR(tU,A.displayName))})}}}},DeviceModeTransformation:function(){return{name:ok,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[ok])},transformEvent:{init:function(o,f,v,P,k,S){var A=o.lifecycle.writeKey.value;return v.setAuthHeader(A),new tx("".concat("rudder","_").concat(A),oP,function(P,A,C){var I,T,O=(I=P.event,T=P.destinationIds,{metadata:{"Custom-Authorization":P.token},batch:[{orderNo:Date.now(),destinationIds:T,event:I}]});v.getAsyncData({url:"".concat(o.lifecycle.activeDataplaneUrl.value,"/transform"),options:{method:"POST",data:stringifyWithoutCircular(O,!0,void 0,void 0),sendRawData:!0},isRawResponse:!0,timeout:1e4,callback:function(v,I){var T,O,D,R=isErrRetryable(null!==(T=null==I||null===(O=I.xhr)||void 0===O?void 0:O.status)&&void 0!==T?T:0);isUndefined(null==I?void 0:I.error)||!R||C.retryAttemptNumber===C.maxRetryAttempts?(sendTransformedEventToDestinations(o,f,P.destinationIds,v,null==I||null===(D=I.xhr)||void 0===D?void 0:D.status,P.event,k,S),A(null)):A(I)}})},P,tP)},enqueue:function(o,f,v,P){var k=P.map(function(o){return o.id});f.addItem({event:v,destinationIds:k,token:o.session.authToken.value})}}}},ExternalAnonymousId:function(){return{name:oE,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oE])},storage:{getAnonymousId:function(o,f){if(null!=f&&null!==(v=f.autoCapture)&&void 0!==v&&v.enabled&&f.autoCapture.source){var v,P,k=f.autoCapture.source.toLowerCase();if(!Object.keys(oS).includes(k))return P;"segment"===k&&(P=getSegmentAnonymousId(o))}return P}}}},GoogleLinker:function(){return{name:oI,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oI])},userSession:{anonymousIdGoogleLinker:function(o){if(!o)return null;var f=o?parseLinker(o):null;return f?f.rs_amp_id:null}}}},IubendaConsentManager:function(){return{name:oD,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oD])},consentManager:{init:function(o,f){globalThis.getIubendaUserConsentedPurposes=function(){var f;return null===(f=o.consents.data.value.allowedConsentIds)||void 0===f?void 0:f.slice()},globalThis.getIubendaUserDeniedPurposes=function(){var f;return null===(f=o.consents.data.value.deniedConsentIds)||void 0===f?void 0:f.slice()},globalThis.updateIubendaConsent=function(f){updateConsentStateFromData$1(o,f)}},updateConsentsInfo:function(o,f,v){updateConsentStateFromData$1(o,isUndefined(globalThis._iub.cs.consent.purposes)?getIubendaConsentData(f,v):globalThis._iub.cs.consent.purposes)},isDestinationConsented:function(o,f,v,P){if(!o.consents.initialized.value)return!0;var k=o.consents.data.value.allowedConsentIds,matchPredicate=function(o){return k.includes(o)};try{var S=f.consentManagement;if(S){var A,C=S.find(function(f){return f.provider===o.consents.provider.value});if(!(null!=C&&C.consents))return!0;var I=C.consents.map(function(o){return o.consent.trim()}).filter(function(o){return o});if((null!==(A=C.resolutionStrategy)&&void 0!==A?A:o.consents.resolutionStrategy.value)==="or")return I.some(matchPredicate)||0===I.length;return I.every(matchPredicate)}return!0}catch(o){return null==v||v.onError(o,oT,"Failed to determine the consent status for the destination. Please check the destination configuration and try again."),!0}}}}},KetchConsentManager:function(){return{name:ow,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[ow])},consentManager:{init:function(o,f){globalThis.getKetchUserConsentedPurposes=function(){var f;return null===(f=o.consents.data.value.allowedConsentIds)||void 0===f?void 0:f.slice()},globalThis.getKetchUserDeniedPurposes=function(){var f;return null===(f=o.consents.data.value.deniedConsentIds)||void 0===f?void 0:f.slice()},globalThis.updateKetchConsent=function(f){updateConsentStateFromData(o,f)}},updateConsentsInfo:function(o,f,v){updateConsentStateFromData(o,isUndefined(globalThis.ketchConsent)?getKetchConsentData(f,v):globalThis.ketchConsent)},isDestinationConsented:function(o,f,v,P){if(!o.consents.initialized.value)return!0;var k=o.consents.data.value.allowedConsentIds;try{var S=f.ketchConsentPurposes,A=f.consentManagement,matchPredicate=function(o){return k.includes(o)};if(A){var C,I=null===(C=A.find(function(f){return f.provider===o.consents.provider.value}))||void 0===C?void 0:C.consents;if(!I)return!0;var T=I.map(function(o){return o.consent.trim()}).filter(function(o){return o});if("or"===o.consents.resolutionStrategy.value)return T.some(matchPredicate)||0===T.length;return T.every(matchPredicate)}if(S){var O=S.map(function(o){return o.purpose.trim()}).filter(function(o){return o});return O.some(matchPredicate)||0===O.length}return!0}catch(o){return null==v||v.onError(o,oR,"Failed to determine the consent status for the destination. Please check the destination configuration and try again."),!0}}}}},NativeDestinationQueue:function(){return{name:oL,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oL])},destinationsEventsQueue:{init:function(o,f,v,P,k,S){var A=mergeDeepRight(oN,o.loadOptions.value.destinationsQueueOptions),C=o.lifecycle.writeKey.value;return new tx("".concat("rudder_destinations_events","_").concat(C),A,function(v,A){var C=filterDestinations(v.integrations,o.nativeDestinations.initializedDestinations.value),I=[],T=q(v);C.forEach(function(o){try{if(isEventDenyListed(T.type,T.event,o)){var f,v;null==S||S.warn((f=T.event,v=o.userFriendlyId,"".concat(oM).concat(":: ",'The "').concat(f,'" track event has been filtered for the "').concat(v,'" destination.')));return}o.shouldApplyDeviceModeTransformation?I.push(o):sendEventToDestination(T,o,k,S)}catch(o){null==k||k.onError(o,oM)}}),I.length>0&&f.invokeSingle("transformEvent.enqueue",o,P,T,I,k,S),A(null)},v,tP)},enqueue:function(o,f,v,P,k){f.addItem(v)},enqueueEventToDestination:function(o,f,v,P,k){sendEventToDestination(f,v,P)}}}},OneTrustConsentManager:function(){return{name:oF,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oF])},consentManager:{init:function(o,f){},updateConsentsInfo:function(o,f,v){if(!globalThis.OneTrust||!globalThis.OnetrustActiveGroups){null==v||v.error("".concat(ox).concat(":: ","Failed to access OneTrust SDK resources. Please ensure that the OneTrust SDK is loaded successfully before RudderStack SDK.")),o.consents.initialized.value=!1;return}var P=globalThis.OneTrust.GetDomainData().Groups,k=globalThis.OnetrustActiveGroups.split(",").filter(function(o){return o}),S=[];P.forEach(function(o){var f=o.CustomGroupId;k.includes(f)||S.push(f)}),o.consents.initialized.value=!0,o.consents.data.value={allowedConsentIds:k,deniedConsentIds:S}},isDestinationConsented:function(o,f,v,P){if(!o.consents.initialized.value)return!0;var k=o.consents.data.value.allowedConsentIds;try{var S=f.oneTrustCookieCategories,A=f.consentManagement,matchPredicate=function(o){return k.includes(o)};if(A){var C,I=null===(C=A.find(function(f){return f.provider===o.consents.provider.value}))||void 0===C?void 0:C.consents;if(!I)return!0;var T=I.map(function(o){return o.consent.trim()}).filter(function(o){return o});if("or"===o.consents.resolutionStrategy.value)return T.some(matchPredicate)||0===T.length;return T.every(matchPredicate)}if(S)return S.map(function(o){return o.oneTrustCookieCategory.trim()}).filter(function(o){return o}).every(matchPredicate);return!0}catch(o){return null==v||v.onError(o,ox,"Failed to determine the consent status for the destination. Please check the destination configuration and try again."),!0}}}}},StorageEncryption:function(){return{name:oB,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[oB])},storage:{encrypt:function(o){return"".concat(tS).concat(toBase64(o))},decrypt:function(o){return decryptBrowser(o)}}}},StorageEncryptionLegacy:function(){return{name:ak,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[ak])},storage:{encrypt:function(o){return"".concat(aP).concat(a_.encrypt(o,ab).toString())},decrypt:function(o){return decrypt(o)}}}},StorageMigrator:function(){return{name:aS,initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[aS])},storage:{migrate:function(o,f,v,P){try{var k=f.getItem(o);if(isNullOrUndefined(k))return null;var S=k,A=decrypt(S);for(A=decryptBrowser(A),S=JSON.parse(A);isString(S)&&(A=decrypt(S),(A=decryptBrowser(A))!==S);)S=JSON.parse(A);return S}catch(f){return null==v||v.onError(f,"StorageMigratorPlugin","Failed to retrieve or parse data for ".concat(o," from storage.")),null}}}}},XhrQueue:function(){return{name:aA,deps:[],initialize:function(o){o.plugins.loadedPlugins.value=[].concat(_toConsumableArray(o.plugins.loadedPlugins.value),[aA])},dataplaneEventsQueue:{init:function(o,f,v,P,k){var S=o.lifecycle.writeKey.value;f.setAuthHeader(S);var A=mergeDeepRight(aE,o.loadOptions.value.queueOptions);return new tx("".concat("rudder","_").concat(S),A,function(v,P,S){var A=getRequestInfo(v,o,S,k),C=A.data,I=A.url,T=A.headers;f.getAsyncData({url:I,options:{method:"POST",headers:T,data:C,sendRawData:!0},isRawResponse:!0,timeout:3e4,callback:function(o,f){if(isUndefined(null==f?void 0:f.error)){P(null);return}var v,A,C=isErrRetryable(null!==(v=null==f||null===(A=f.xhr)||void 0===A?void 0:A.status)&&void 0!==v?v:0);logErrorOnFailure(f,C,S,k),P(C?f:null)}})},v,tm,k,function(o){var f,v=getCurrentTimeFormatted();return null===(f=getBatchDeliveryPayload(o.map(function(o){return o.event}),v,k))||void 0===f?void 0:f.length})},enqueue:function(o,f,v,P,k){v.sentAt=getCurrentTimeFormatted(),validateEventPayloadSize(v,k);var S=getDeliveryUrl(o.lifecycle.activeDataplaneUrl.value,v.type),A={AnonymousId:toBase64(v.anonymousId)};f.addItem({url:S,headers:A,event:v})}}}}}),aI=_createClass(function PluginsManager(o,f,v){_classCallCheck(this,PluginsManager),this.engine=o,this.errorHandler=f,this.logger=v,this.onError=this.onError.bind(this)},[{key:"init",value:function(){te.lifecycle.status.value="pluginsLoading",this.setActivePlugins(),this.registerLocalPlugins(),this.registerRemotePlugins(),this.attachEffects()}},{key:"attachEffects",value:function(){E(function(){(0===te.plugins.activePlugins.value.length||te.plugins.loadedPlugins.value.length+te.plugins.failedPlugins.value.length===te.plugins.totalPluginsToLoad.value)&&r(function(){te.plugins.ready.value=!0,te.lifecycle.status.value="pluginsReady"})})}},{key:"getPluginsToLoadBasedOnConfig",value:function(){var o=this,f=te.plugins.pluginsToLoadFromConfig.value;return f?(f=f.filter(function(f){return!th.includes(f)||(o.logger.warn("".concat(eo).concat(":: ").concat(f," plugin is deprecated. Please exclude it from the load API options.")),!1)}),[{configurationStatus:function(){return isDefined(te.dataPlaneEvents.eventsQueuePluginName.value)},configurationStatusStr:"Data plane events delivery is enabled",activePluginName:te.dataPlaneEvents.eventsQueuePluginName.value,supportedPlugins:Object.values(eY),shouldAddMissingPlugins:!0},{configurationStatus:function(){return getNonCloudDestinations(te.nativeDestinations.configuredDestinations.value).length>0},configurationStatusStr:"Device mode destinations are connected to the source",supportedPlugins:["DeviceModeDestinations","NativeDestinationQueue"]},{configurationStatus:function(){return getNonCloudDestinations(te.nativeDestinations.configuredDestinations.value).some(function(o){return o.shouldApplyDeviceModeTransformation})},configurationStatusStr:"Device mode transformations are enabled for at least one destination",supportedPlugins:["DeviceModeTransformation"]},{configurationStatus:function(){return isDefined(te.consents.activeConsentManagerPluginName.value)},configurationStatusStr:"Consent management is enabled",activePluginName:te.consents.activeConsentManagerPluginName.value,supportedPlugins:Object.values(eX)},{configurationStatus:function(){return isDefined(te.storage.encryptionPluginName.value)},configurationStatusStr:"Storage encryption is enabled",activePluginName:te.storage.encryptionPluginName.value,supportedPlugins:Object.values(eJ)},{configurationStatus:function(){return te.storage.migrate.value},configurationStatusStr:"Storage migration is enabled",supportedPlugins:["StorageMigrator"]}].forEach(function(v){v.configurationStatus()?(f=f.filter(v.activePluginName?function(o){return!(o!==v.activePluginName&&v.supportedPlugins.includes(o))}:function(o){return isDefined(o)}),o.addMissingPlugins(v,!1,f)):f=f.filter(void 0!==v.basePlugins?function(o){return!(v.basePlugins.includes(o)||v.supportedPlugins.includes(o))}:function(o){return!v.supportedPlugins.includes(o)})}),[].concat(_toConsumableArray(Object.keys(getMandatoryPluginsMap())),_toConsumableArray(f))):[]}},{key:"addMissingPlugins",value:function(o,f,v){var P=o.shouldAddMissingPlugins||f,k=(o.activePluginName?[].concat(_toConsumableArray(o.basePlugins||[]),[o.activePluginName]):_toConsumableArray(o.supportedPlugins)).filter(function(o){return!v.includes(o)});k.length>0&&(P&&v.push.apply(v,_toConsumableArray(k)),this.logger.warn(generateMisconfiguredPluginsWarning(eo,o.configurationStatusStr,k,P)))}},{key:"setActivePlugins",value:function(){var o=this.getPluginsToLoadBasedOnConfig(),f=[].concat(_toConsumableArray(Object.keys(aC)),_toConsumableArray(tp)),v=[],P=[];o.forEach(function(o){f.includes(o)?v.push(o):P.push(o)}),P.length>0&&this.logger.warn("".concat(eo).concat(":: ","Ignoring unknown plugins: ").concat(P.join(", "),".")),r(function(){te.plugins.totalPluginsToLoad.value=o.length,te.plugins.activePlugins.value=v,te.plugins.failedPlugins.value=P})}},{key:"registerLocalPlugins",value:function(){var o=this;Object.values(aC).forEach(function(f){isFunction(f)&&te.plugins.activePlugins.value.includes(f().name)&&o.register([f()])})}},{key:"registerRemotePlugins",value:function(){var o,f,v=this,P=(te.plugins.activePlugins.value,_objectSpread2({},{}));Promise.all(Object.keys(P).map((f=_asyncToGenerator(_regeneratorRuntime().mark(function _callee(o){return _regeneratorRuntime().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,P[o]().then(function(o){return v.register([o.default()])}).catch(function(f){te.plugins.failedPlugins.value=[].concat(_toConsumableArray(te.plugins.failedPlugins.value),[o]),v.onError(f,o)});case 2:case"end":return f.stop()}},_callee)})),function(o){return f.apply(this,arguments)}))).catch(function(o){v.onError(o)})}},{key:"invokeMultiple",value:function(o){try{for(var f,v=arguments.length,P=Array(v>1?v-1:0),k=1;k<v;k++)P[k-1]=arguments[k];return(f=this.engine).invokeMultiple.apply(f,[o].concat(P))}catch(f){return this.onError(f,o),[]}}},{key:"invokeSingle",value:function(o){try{for(var f,v=arguments.length,P=Array(v>1?v-1:0),k=1;k<v;k++)P[k-1]=arguments[k];return(f=this.engine).invokeSingle.apply(f,[o].concat(P))}catch(f){return this.onError(f,o),null}}},{key:"register",value:function(o){var f=this;o.forEach(function(o){try{f.engine.register(o,te)}catch(v){te.plugins.failedPlugins.value=[].concat(_toConsumableArray(te.plugins.failedPlugins.value),[o.name]),f.onError(v)}})}},{key:"unregisterLocalPlugins",value:function(){var o=this;Object.values(aC).forEach(function(f){try{o.engine.unregister(f().name)}catch(f){o.onError(f)}})}},{key:"onError",value:function(o,f){this.errorHandler.onError(o,eo,f)}}]),aT="clientDataInCookie",aO="clientDataInLocalStorage",aD="clientDataInSessionStorage",aR=["userId","userTraits","anonymousId","groupId","groupTraits","initialReferrer","initialReferringDomain","sessionInfo","authToken"],aw=_defineProperty(_defineProperty(_defineProperty(_defineProperty({},ty,aT),tm,aO),tP,"clientDataInMemory"),t_,aD),legacyGetHostname=function(o){var f=document.createElement("a");return f.href=o,f.hostname},levelsFunc=function(o){var f,v="function"!=typeof globalThis.URL?legacyGetHostname(o):new URL(o).hostname,P=null!==(f=null==v?void 0:v.split("."))&&void 0!==f?f:[],k=P[P.length-1],S=[];if(4===P.length&&k&&k===parseInt(k,10).toString())return S;if(P.length<=1)return P[0]&&-1!==P[0].indexOf("localhost")?["localhost"]:S;for(var A=P.length-2;A>=0;A-=1)S.push(P.slice(A).join("."));return S},domain=function(o){for(var f=levelsFunc(o),v=0;v<f.length;v+=1){var P=f[v],k="__tld__",S={domain:"".concat(-1!==P.indexOf("localhost")?"":".").concat(P)};if(cookie(k,1,S),cookie(k))return cookie(k,null,S),P}return""},getDefaultCookieOptions=function(){var o=".".concat(domain(globalThis.location.href));return{maxage:31536e6,path:"/",domain:o&&"."!==o?o:void 0,samesite:"Lax",enabled:!0}},aN=new(_createClass(function InMemoryStorage(o){_classCallCheck(this,InMemoryStorage),_defineProperty(this,"isEnabled",!0),_defineProperty(this,"length",0),_defineProperty(this,"data",{}),this.options={enabled:!0},this.logger=o},[{key:"configure",value:function(o){return this.options=mergeDeepRight(this.options,null!=o?o:{}),this.isEnabled=!!this.options.enabled,this.options}},{key:"setItem",value:function(o,f){return this.data[o]=f,this.length=Object.keys(this.data).length,f}},{key:"getItem",value:function(o){return o in this.data?this.data[o]:null}},{key:"removeItem",value:function(o){return o in this.data&&delete this.data[o],this.length=Object.keys(this.data).length,null}},{key:"clear",value:function(){this.data={},this.length=0}},{key:"key",value:function(o){var f;return null!==(f=this.keys()[o])&&void 0!==f?f:null}},{key:"keys",value:function(){return Object.keys(this.data)}}]))(ex),aM={exports:{}},aL=(aM.exports,getDefaultExportFromCjs((H||(H=1,aM.exports=function(){function isJSON(o){return o=JSON.stringify(o),!!/^\{[\s\S]*\}$/.test(o)}function deserialize(o){if("string"==typeof o)try{return JSON.parse(o)}catch(f){return o}}function isFunction(o){return"[object Function]"===({}).toString.call(o)}var o=function(o){var f="_Is_Incognit";try{o||(o=window.localStorage),o.setItem(f,"yes"),o.removeItem(f)}catch(f){var v={};v._data={},v.setItem=function(o,f){return v._data[o]=String(f)},v.getItem=function(o){return v._data.hasOwnProperty(o)?v._data[o]:void 0},v.removeItem=function(o){return delete v._data[o]},v.clear=function(){return v._data={}},o=v}finally{"yes"===o.getItem(f)&&o.removeItem(f)}return o}();function Store(){if(!(this instanceof Store))return new Store}Store.prototype={set:function(f,v){if(f&&!isJSON(f))o.setItem(f,void 0===v||"function"==typeof v?v+"":JSON.stringify(v));else if(isJSON(f))for(var P in f)this.set(P,f[P]);return this},get:function(f){if(void 0===f){var v={};return this.forEach(function(o,f){return v[o]=f}),v}if("?"===f.charAt(0))return this.has(f.substr(1));var P=arguments;if(P.length>1){for(var k={},S=0,A=P.length;S<A;S++){var C=deserialize(o.getItem(P[S]));this.has(P[S])&&(k[P[S]]=C)}return k}return deserialize(o.getItem(f))},clear:function(){return o.clear(),this},remove:function(f){var v=this.get(f);return o.removeItem(f),v},has:function(o){return({}).hasOwnProperty.call(this.get(),o)},keys:function(){var o=[];return this.forEach(function(f){o.push(f)}),o},forEach:function(f){for(var v=0,P=o.length;v<P;v++){var k=o.key(v);f(k,this.get(k))}return this},search:function(o){for(var f=this.keys(),v={},P=0,k=f.length;P<k;P++)f[P].indexOf(o)>-1&&(v[f[P]]=this.get(f[P]));return v},len:function(){return o.length}};var f=null;function store(o,v){var P=arguments,k=null;if(f||(f=Store()),0===P.length)return f.get();if(1===P.length){if("string"==typeof o)return f.get(o);if(isJSON(o))return f.set(o)}if(2===P.length&&"string"==typeof o){if(!v)return f.remove(o);if(v&&"string"==typeof v)return f.set(o,v);v&&isFunction(v)&&(k=null,k=v(o,f.get(o)),store.set(o,k))}if(2===P.length&&"[object Array]"===Object.prototype.toString.call(o)&&isFunction(v))for(var S=0,A=o.length;S<A;S++)k=v(o[S],f.get(o[S])),store.set(o[S],k);return store}for(var v in Store.prototype)store[v]=Store.prototype[v];return store}()),aM.exports))),detectAdBlockers=function(o){var f=new URL(te.lifecycle.sourceConfigUrl.value),v="".concat(f.origin).concat(f.pathname,"?view=ad");o.getAsyncData({url:v,options:{method:"HEAD",headers:{"Content-Type":void 0}},isRawResponse:!0,callback:function(o,f){var P;te.capabilities.isAdBlocked.value=(null==f?void 0:f.error)!==void 0||(null==f||null===(P=f.xhr)||void 0===P?void 0:P.responseURL)!==v}})},hasUAClientHints=function(){return!isNullOrUndefined(globalThis.navigator.userAgentData)},getUserAgentClientHint=function(o){var f,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";"none"===v&&o(void 0),"default"===v&&o(navigator.userAgentData),"full"===v&&(null===(f=navigator.userAgentData)||void 0===f||f.getHighEntropyValues(["architecture","bitness","brands","mobile","model","platform","platformVersion","uaFullVersion","fullVersionList","wow64"]).then(function(f){o(f)}).catch(function(){o()}))},isDatasetAvailable=function(){var o=globalThis.document.createElement("div");return o.setAttribute("data-a-b","c"),!!o.dataset&&"c"===o.dataset.aB},ax={URL:function(){return!isFunction(globalThis.URL)||!isFunction(globalThis.URLSearchParams)},Promise:function(){return!isFunction(globalThis.Promise)},"Number.isNaN":function(){return!isFunction(globalThis.Number.isNaN)},"Number.isInteger":function(){return!isFunction(globalThis.Number.isInteger)},"Array.from":function(){return!isFunction(globalThis.Array.from)},"Array.prototype.find":function(){return!isFunction(globalThis.Array.prototype.find)},"Array.prototype.includes":function(){return!isFunction(globalThis.Array.prototype.includes)},"String.prototype.endsWith":function(){return!isFunction(globalThis.String.prototype.endsWith)},"String.prototype.startsWith":function(){return!isFunction(globalThis.String.prototype.startsWith)},"String.prototype.includes":function(){return!isFunction(globalThis.String.prototype.includes)},"String.prototype.replaceAll":function(){return!isFunction(globalThis.String.prototype.replaceAll)},"String.fromCodePoint":function(){return!isFunction(globalThis.String.fromCodePoint)},"Object.entries":function(){return!isFunction(globalThis.Object.entries)},"Object.values":function(){return!isFunction(globalThis.Object.values)},"Object.assign":function(){return!isFunction(globalThis.Object.assign)},"Object.fromEntries":function(){return!isFunction(globalThis.Object.fromEntries)},"Element.prototype.dataset":function(){return!isDatasetAvailable()},TextEncoder:function(){return!isFunction(globalThis.TextEncoder)||!isFunction(globalThis.TextDecoder)},requestAnimationFrame:function(){return!isFunction(globalThis.requestAnimationFrame)||!isFunction(globalThis.cancelAnimationFrame)},CustomEvent:function(){return!isFunction(globalThis.CustomEvent)},"navigator.sendBeacon":function(){return!isFunction(globalThis.navigator.sendBeacon)},ArrayBuffer:function(){return!isFunction(globalThis.Uint8Array)},Set:function(){return!isFunction(globalThis.Set)},atob:function(){return!isFunction(globalThis.atob)}},isLegacyJSEngine=function(){for(var o=Object.keys(ax),f=!1,v=0;v<o.length;v++){var P=ax[o[v]];if(isFunction(P)&&P()){f=!0;break}}return f},getScreenDetails=function(){return{width:globalThis.screen.width,height:globalThis.screen.height,density:globalThis.devicePixelRatio,innerWidth:globalThis.innerWidth,innerHeight:globalThis.innerHeight}},isStorageQuotaExceeded=function(o){var f=["QuotaExceededError","NS_ERROR_DOM_QUOTA_REACHED"].includes(o.name)||[22,1014].includes(o.code);return o instanceof DOMException&&f},isStorageAvailable=function(){var o,f,v,P=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tm,k=arguments.length>1?arguments[1]:void 0,S=arguments.length>2?arguments[2]:void 0,A="".concat(en).concat(":: ",'The "').concat(P,'" storage type is '),C="unavailable",I=!0;try{switch(P){case tP:return!0;case ty:o=k,f="test_rudder_cookie";break;case tm:o=null!=k?k:globalThis.localStorage,f="test_rudder_ls";break;case t_:o=null!=k?k:globalThis.sessionStorage,f="test_rudder_ss";break;default:return!1}if(o&&(o.setItem(f,"true"),o.getItem(f)))return o.removeItem(f),!0;I=!1}catch(o){I=!1,v=o,isStorageQuotaExceeded(o)&&(C="full")}return I||null==S||S.warn("".concat(A).concat(C,"."),v),!1},aF=new(_createClass(function LocalStorage(o){_classCallCheck(this,LocalStorage),_defineProperty(this,"isSupportAvailable",!0),_defineProperty(this,"isEnabled",!0),_defineProperty(this,"length",0),this.options={enabled:!0},this.logger=o},[{key:"configure",value:function(o){return this.options=mergeDeepRight(this.options,null!=o?o:{}),this.isSupportAvailable=isStorageAvailable(tm),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(o,f){aL.set(o,f),this.length=aL.len()}},{key:"getItem",value:function(o){var f=aL.get(o);return isUndefined(f)?null:f}},{key:"removeItem",value:function(o){aL.remove(o),this.length=aL.len()}},{key:"clear",value:function(){aL.clear(),this.length=0}},{key:"key",value:function(o){var f;return null!==(f=this.keys()[o])&&void 0!==f?f:null}},{key:"keys",value:function(){return aL.keys()}}]))(ex),aB=new(_createClass(function SessionStorage(o){_classCallCheck(this,SessionStorage),_defineProperty(this,"isSupportAvailable",!0),_defineProperty(this,"isEnabled",!0),_defineProperty(this,"length",0),this.options={enabled:!0},this.logger=o},[{key:"configure",value:function(o){return this.options=mergeDeepRight(this.options,null!=o?o:{}),this.isSupportAvailable=isStorageAvailable(t_),this.isSupportAvailable&&(this.store=globalThis.sessionStorage),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(o,f){this.store&&(this.store.setItem(o,f),this.length=this.store.length)}},{key:"getItem",value:function(o){if(!this.store)return null;var f=this.store.getItem(o);return isUndefined(f)?null:f}},{key:"removeItem",value:function(o){this.store&&(this.store.removeItem(o),this.length=this.store.length)}},{key:"clear",value:function(){var o;null===(o=this.store)||void 0===o||o.clear(),this.length=0}},{key:"key",value:function(o){var f,v;return null!==(f=null===(v=this.store)||void 0===v?void 0:v.key(o))&&void 0!==f?f:null}},{key:"keys",value:function(){var o=[];if(!this.store)return o;for(var f=0;f<this.store.length;f+=1){var v=this.store.key(f);null!==v&&o.push(v)}return o}}]))(ex),aU=new(_createClass(function CookieStorage(o){_classCallCheck(this,CookieStorage),_defineProperty(this,"isSupportAvailable",!0),_defineProperty(this,"isEnabled",!0),_defineProperty(this,"length",0),this.logger=o},[{key:"configure",value:function(o){return this.options||(this.options=getDefaultCookieOptions()),this.options=mergeDeepRight(this.options,null!=o?o:{}),this.options.sameDomainCookiesOnly&&delete this.options.domain,this.isSupportAvailable=isStorageAvailable(ty,this),this.isEnabled=!!(this.options.enabled&&this.isSupportAvailable),this.options}},{key:"setItem",value:function(o,f){return cookie(o,f,this.options,this.logger),this.length=Object.keys(cookie()).length,!0}},{key:"getItem",value:function(o){var f=cookie(o);return isUndefined(f)?null:f}},{key:"removeItem",value:function(o){var f=this.setItem(o,null);return this.length=Object.keys(cookie()).length,f}},{key:"clear",value:function(){}},{key:"key",value:function(o){var f;return null!==(f=this.keys()[o])&&void 0!==f?f:null}},{key:"keys",value:function(){return Object.keys(cookie())}}]))(ex),getStorageEngine=function(o){switch(o){case tm:return aF;case t_:return aB;case tP:return aN;case ty:return aU;default:return aN}},configureCookieStorageEngine=function(o){var f=aU.configure(o);te.storage.cookie.value={maxage:f.maxage,path:f.path,domain:f.domain,samesite:f.samesite,expires:f.expires,secure:f.secure}},configureLocalStorageEngine=function(o){aF.configure(o)},configureInMemoryStorageEngine=function(o){aN.configure(o)},configureSessionStorageEngine=function(o){aB.configure(o)},configureStorageEngines=function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};configureCookieStorageEngine(o),configureLocalStorageEngine(f),configureInMemoryStorageEngine(v),configureSessionStorageEngine(P)},aj=_createClass(function Store(o,f,v){var P,k;_classCallCheck(this,Store),this.id=o.id,this.name=o.name,this.isEncrypted=null!==(P=o.isEncrypted)&&void 0!==P&&P,this.validKeys=null!==(k=o.validKeys)&&void 0!==k?k:{},this.engine=f,this.noKeyValidation=0===Object.keys(this.validKeys).length,this.noCompoundKey=o.noCompoundKey,this.originalEngine=this.engine,this.errorHandler=o.errorHandler,this.logger=o.logger,this.pluginsManager=v},[{key:"createValidKey",value:function(o){var f,v=this.name,P=this.id,k=this.validKeys,S=this.noKeyValidation,A=this.noCompoundKey;return S?A?o:[v,P,o].join("."):(Object.values(k).forEach(function(k){k===o&&(f=A?o:[v,P,o].join("."))}),f)}},{key:"swapQueueStoreToInMemoryEngine",value:function(){var o=this,f=this.name,v=this.id,P=this.validKeys,k=this.noCompoundKey,S=getStorageEngine(tP);Object.keys(P).forEach(function(A){var C=o.get(P[A]),I=k?A:[f,v,A].join(".");S.setItem(I,C),o.remove(A)}),this.engine=S}},{key:"set",value:function(o,f){var v,P=this.createValidKey(o);if(P)try{this.engine.setItem(P,this.encrypt(stringifyWithoutCircular(f,!1,[],this.logger)))}catch(P){isStorageQuotaExceeded(P)?(this.logger.warn((v="Store ".concat(this.id),"".concat(v).concat(":: ","The storage is either full or unavailable, so the data will not be persisted. Switching to in-memory storage."))),this.swapQueueStoreToInMemoryEngine(),this.set(o,f)):this.onError(getMutatedError(P,'Failed to save the value for "'.concat(o,'" to storage')))}}},{key:"get",value:function(o){var f,v=this.createValidKey(o);try{if(!v||(f=this.decrypt(this.engine.getItem(v)),isNullOrUndefined(f)))return null;return JSON.parse(f)}catch(f){return this.onError(Error("".concat('Failed to retrieve or parse data for "'.concat(o,'" from storage'),": ").concat(f.message))),null}}},{key:"remove",value:function(o){var f=this.createValidKey(o);f&&this.engine.removeItem(f)}},{key:"getOriginalEngine",value:function(){return this.originalEngine}},{key:"decrypt",value:function(o){return isNullOrUndefined(o)?null:this.crypto(o,"decrypt")}},{key:"encrypt",value:function(o){return this.crypto(o,"encrypt")}},{key:"crypto",value:function(o,f){if(!this.isEncrypted||!o||"string"!=typeof o||""===o.replace(/^\s+|\s+$/gm,""))return o;var v=this.pluginsManager?this.pluginsManager.invokeSingle("storage.".concat(f),o):o;return void 0===v?o:null!=v?v:""}},{key:"onError",value:function(o){this.errorHandler.onError(o,"Store ".concat(this.id))}}]),getStorageTypeFromPreConsentIfApplicable=function(o,f){var v,P;if(o.consents.preConsent.value.enabled)switch(null===(P=o.consents.preConsent.value.storage)||void 0===P?void 0:P.strategy){case"none":v=tb;break;case"session":"sessionInfo"!==f&&(v=tb);break;case"anonymousId":"anonymousId"!==f&&(v=tb)}return v},aG=_createClass(function StoreManager(o,f,v){_classCallCheck(this,StoreManager),_defineProperty(this,"stores",{}),_defineProperty(this,"isInitialized",!1),this.errorHandler=f,this.logger=v,this.pluginsManager=o},[{key:"init",value:function(){if(!this.isInitialized){var o,f,v,P=te.loadOptions.value,k={cookieStorageOptions:{samesite:P.sameSiteCookie,secure:P.secureCookie,domain:P.setCookieDomain,sameDomainCookiesOnly:P.sameDomainCookiesOnly},localStorageOptions:{},inMemoryStorageOptions:{},sessionStorageOptions:{}};configureStorageEngines(_removeUndefinedValues(mergeDeepRight(null!==(o=k.cookieStorageOptions)&&void 0!==o?o:{},null!==(f=null===(v=te.storage.cookie)||void 0===v?void 0:v.value)&&void 0!==f?f:{})),_removeUndefinedValues(k.localStorageOptions),_removeUndefinedValues(k.inMemoryStorageOptions),_removeUndefinedValues(k.sessionStorageOptions)),this.initClientDataStores(),this.isInitialized=!0}}},{key:"initClientDataStores",value:function(){var o=this;this.initializeStorageState(),[tP,tm,ty,t_].forEach(function(f){var v;null!==(v=getStorageEngine(f))&&void 0!==v&&v.isEnabled&&o.setStore({id:aw[f],name:aw[f],isEncrypted:!0,noCompoundKey:!0,type:f,errorHandler:o.errorHandler,logger:o.logger})})}},{key:"initializeStorageState",value:function(){var o,f=this,v=te.storage.type.value,P=null===(o=te.loadOptions.value.storage)||void 0===o?void 0:o.entries,k=te.consents.postConsent.value.storage;(isDefined(null==k?void 0:k.type)||isDefined(null==k?void 0:k.entries))&&(v=null==k?void 0:k.type,P=null==k?void 0:k.entries);var S=!0,A={};aR.forEach(function(o){var k,C,I,T=null===(k=P)||void 0===k||null===(k=k[o])||void 0===k?void 0:k.type,O=getStorageTypeFromPreConsentIfApplicable(te,o),D=null!==(C=null!==(I=null!=O?O:T)&&void 0!==I?I:v)&&void 0!==C?C:eU,R=f.getResolvedStorageTypeForEntry(D,o);R!==tb&&(S=!1),A=_objectSpread2(_objectSpread2({},A),{},_defineProperty({},o,{type:R,key:tk[o]}))}),r(function(){te.storage.type.value=v,te.storage.entries.value=A,te.storage.trulyAnonymousTracking.value=S})}},{key:"getResolvedStorageTypeForEntry",value:function(o,f){var v,P,k,S,A,C,I=o;switch(o){case tm:null!==(P=getStorageEngine(tm))&&void 0!==P&&P.isEnabled||(I=tP);break;case t_:null!==(k=getStorageEngine(t_))&&void 0!==k&&k.isEnabled||(I=tP);break;case tP:case tb:break;default:I=null!==(S=getStorageEngine(ty))&&void 0!==S&&S.isEnabled?ty:null!==(A=getStorageEngine(tm))&&void 0!==A&&A.isEnabled?tm:null!==(C=getStorageEngine(t_))&&void 0!==C&&C.isEnabled?t_:tP}return I!==o&&this.logger.warn((v=I,"".concat("StoreManager").concat(":: ",'The storage type "').concat(o,'" is not available for entry "').concat(f,'". The SDK will initialize the entry with "').concat(v,'" storage type instead.'))),I}},{key:"setStore",value:function(o){var f=getStorageEngine(o.type);return this.stores[o.id]=new aj(o,f,this.pluginsManager),this.stores[o.id]}},{key:"getStore",value:function(o){return this.stores[o]}}]),getTopDomain=function(o){var f=new URL(o),v=f.host,P=f.protocol,k=v.split(".");return{topDomain:k.length>2?"".concat(k[k.length-2],".").concat(k[k.length-1]):v,protocol:P}},getTopDomainUrl=function(o){var f=getTopDomain(o),v=f.topDomain,P=f.protocol;return"".concat(P,"//").concat(v)},getDataServiceUrl=function(o,f){var v=f?window.location.origin:getTopDomainUrl(window.location.href),P=o.startsWith("/")?o.substring(1):o;return"".concat(v,"/").concat(P)},filterEnabledDestination=function(o){var f=[];return o.forEach(function(o){o.enabled&&!o.deleted&&f.push({id:o.id,displayName:o.destinationDefinition.displayName,config:o.config,shouldApplyDeviceModeTransformation:o.shouldApplyDeviceModeTransformation||!1,propagateEventsUntransformedOnError:o.propagateEventsUntransformedOnError||!1,userFriendlyId:"".concat(o.destinationDefinition.displayName.replaceAll(" ","-"),"___").concat(o.id)})}),f},_removeTrailingSlashes=function(o){return null!=o&&o.endsWith("/")?_removeTrailingSlashes(o.substring(0,o.length-1)):o},getDomain=function(o){try{return new URL(o).host}catch(o){return null}},getReferringDomain=function(o){var f;return null!==(f=getDomain(o))&&void 0!==f?f:""},extractUTMParameters=function(o){var f={};try{var v=new URL(o),P="utm_";v.searchParams.forEach(function(o,v){if(v.startsWith(P)){var k=v.substring(P.length);"campaign"===k&&(k="name"),f[k]=o}})}catch(o){}return f},getUrlWithoutHash=function(o){var f=o;try{var v=new URL(o);f=v.origin+v.pathname+v.search}catch(o){}return f},isSDKRunningInChromeExtension=function(){var o;return!!(null!==(o=window.chrome)&&void 0!==o&&null!==(o=o.runtime)&&void 0!==o&&o.id)},az="none",aH="immediate",isErrorReportingEnabled=function(o){var f;return(null==o||null===(f=o.statsCollection)||void 0===f||null===(f=f.errors)||void 0===f?void 0:f.enabled)===!0},isMetricsReportingEnabled=function(o){var f;return(null==o||null===(f=o.statsCollection)||void 0===f||null===(f=f.metrics)||void 0===f?void 0:f.enabled)===!0},getValidPostConsentOptions=function(o){var f={sendPageEvent:!1,trackConsent:!1,discardPreConsentEvents:!1};if(isObjectLiteralAndNotNull(o)){var v=q(o);f.storage=v.storage,isNonEmptyObject(v.integrations)&&(f.integrations=v.integrations),f.discardPreConsentEvents=!0===v.discardPreConsentEvents,f.sendPageEvent=!0===v.sendPageEvent,f.trackConsent=!0===v.trackConsent,isNonEmptyObject(v.consentManagement)&&(f.consentManagement=mergeDeepRight(v.consentManagement,{enabled:te.consents.enabled.value}))}return f},isValidConsentsData=function(o){return isNonEmptyObject(o)||Array.isArray(o)},getConsentManagerInfo=function(o,f){var v,P=o.provider,k=P?eX[P]:void 0;return P&&!k&&(f.error((v=P,"".concat(er).concat(":: ",'The consent manager "').concat(v,'" is not supported. Please choose one of the following supported consent managers: "').concat(Object.keys(eX),'".'))),P=void 0),{provider:P,consentManagerPluginName:k}},getConsentManagementData=function(o,f){var v,P,k=[],S=[],A=!1,C=(null==o?void 0:o.enabled)===!0;if(isNonEmptyObject(o)&&C){var I=getConsentManagerInfo(o,f);P=I.provider,v=I.consentManagerPluginName,isValidConsentsData(o.allowedConsentIds)&&(k=o.allowedConsentIds,A=!0),isValidConsentsData(o.deniedConsentIds)&&(S=o.deniedConsentIds,A=!0)}var T={allowedConsentIds:k,deniedConsentIds:S};return C=C&&!!v,{provider:P,consentManagerPluginName:v,initialized:A,enabled:C,consentsData:T}},getSDKUrl=function(){var o=document.querySelector("script[data-rsa-write-key]");if(o&&o.dataset.rsaWriteKey===te.lifecycle.writeKey.value)return o.src;var f,v=document.getElementsByTagName("script"),P=/(?:^|\/)rsa(\.min)?\.js$/,k=function(o,f){var v="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!v){if(Array.isArray(o)||(v=_unsupportedIterableToArray(o))){v&&(o=v);var P=0,F=function(){};return{s:F,n:function(){return P>=o.length?{done:!0}:{done:!1,value:o[P++]}},e:function(o){throw o},f:F}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var k,S=!0,A=!1;return{s:function(){v=v.call(o)},n:function(){var o=v.next();return S=o.done,o},e:function(o){A=!0,k=o},f:function(){try{S||null==v.return||v.return()}finally{if(A)throw k}}}}(v);try{for(k.s();!(f=k.n()).done;){var S=f.value.getAttribute("src");if(S&&P.test(S))return S}}catch(o){k.e(o)}finally{k.f()}},updateReportingState=function(o){te.reporting.isErrorReportingEnabled.value=isErrorReportingEnabled(o.source.config)&&!isSDKRunningInChromeExtension(),te.reporting.isMetricsReportingEnabled.value=isMetricsReportingEnabled(o.source.config)},getServerSideCookiesStateData=function(o){var f=te.loadOptions.value,v=f.useServerSideCookies,P=f.dataServiceEndpoint,k=f.storage,S=f.setCookieDomain,A=f.sameDomainCookiesOnly,C=null==k?void 0:k.cookie,I=!1;if(v){I=v;var T,O,D=null!==(O=C.domain)&&void 0!==O?O:S,R=isDefined(D)&&(M=removeLeadingPeriod(D),getTopDomain(window.location.href).topDomain!==M)||A,N=getDataServiceUrl(null!=P?P:"rsaRequest",R);if(isValidURL(N)){T=_removeTrailingSlashes(N);var M,L=getDomain(window.location.href),B=getDomain(N);L!==B&&(C=_objectSpread2(_objectSpread2({},C),{},{samesite:"None",secure:!0})),!A&&R&&B!==removeLeadingPeriod(D)&&(I=!1,o.warn("".concat(er).concat(":: ","The provided cookie domain (").concat(D,") does not match the current webpage's domain (").concat(B,"). Hence, the cookies will be set client-side.")))}else I=!1}return{sscEnabled:I,cookieOptions:C,finalDataServiceUrl:T}},updateStorageStateFromLoadOptions=function(o){var f,v,P,k,S,A=te.loadOptions.value.storage,C=null==A?void 0:A.type;isDefined(C)&&!("string"==typeof(f=C)&&eB.includes(f))&&(o.warn((v=C,"".concat(er).concat(":: ",'The storage type "').concat(v,'" is not supported. Please choose one of the following supported types: "').concat(eB,'". The default type "').concat(eU,'" will be used instead.'))),C=eU);var I=null==A||null===(S=A.encryption)||void 0===S?void 0:S.version,T=I&&eJ[I];!isUndefined(I)&&isUndefined(T)?(o.warn((P=I,"".concat(er).concat(":: ",'The storage encryption version "').concat(P,'" is not supported. Please choose one of the following supported versions: "').concat(Object.keys(eJ),'". The default version "').concat("v3",'" will be used instead.'))),I="v3"):isUndefined(I)&&(I="v3");var O=null==A?void 0:A.migrate,D=O&&"v3"===I;!0===O&&D!==O&&o.warn((k=I,"".concat(er).concat(":: ","The storage data migration has been disabled because the configured storage encryption version (").concat(k,") is not the latest (").concat("v3","). To enable storage data migration, please update the storage encryption version to the latest version.")));var R=getServerSideCookiesStateData(o),N=R.sscEnabled,M=R.finalDataServiceUrl,L=R.cookieOptions;r(function(){te.storage.type.value=C,te.storage.cookie.value=L,te.serverCookies.isEnabledServerSideCookies.value=N,te.serverCookies.dataServiceUrl.value=M,te.storage.encryptionPluginName.value=eJ[I],te.storage.migrate.value=D})},updateConsentsStateFromLoadOptions=function(o){var f,v,P,k,S,A,C,I,T=getConsentManagementData(te.loadOptions.value.consentManagement,o),O=T.provider,D=T.consentManagerPluginName,R=T.initialized,N=T.enabled,M=T.consentsData,L=te.loadOptions.value.preConsent,B=null!==(P=null==L||null===(k=L.storage)||void 0===k?void 0:k.strategy)&&void 0!==P?P:az;isDefined(B)&&!["none","session","anonymousId"].includes(B)&&(B=az,o.warn((f=null==L||null===(C=L.storage)||void 0===C?void 0:C.strategy,"".concat(er).concat(":: ",'The pre-consent storage strategy "').concat(f,'" is not supported. Please choose one of the following supported strategies: "none, session, anonymousId". The default strategy "').concat(az,'" will be used instead.'))));var U=null!==(S=null==L||null===(A=L.events)||void 0===A?void 0:A.delivery)&&void 0!==S?S:aH;isDefined(U)&&!["immediate","buffer"].includes(U)&&(U=aH,o.warn((v=null==L||null===(I=L.events)||void 0===I?void 0:I.delivery,"".concat(er).concat(":: ",'The pre-consent events delivery type "').concat(v,'" is not supported. Please choose one of the following supported types: "immediate, buffer". The default type "').concat(aH,'" will be used instead.')))),r(function(){var o;te.consents.activeConsentManagerPluginName.value=D,te.consents.initialized.value=R,te.consents.enabled.value=N,te.consents.data.value=M,te.consents.provider.value=O,te.consents.preConsent.value={enabled:(null===(o=te.loadOptions.value.preConsent)||void 0===o?void 0:o.enabled)===!0&&!1===R&&!0===N,storage:{strategy:B},events:{delivery:U}}})},updateConsentsState=function(o){var f,v,P,k=te.consents.resolutionStrategy.value;isObjectLiteralAndNotNull(o.consentManagementMetadata)&&(te.consents.provider.value&&(k=null!==(v=null===(P=o.consentManagementMetadata.providers.find(function(o){return o.provider===te.consents.provider.value}))||void 0===P?void 0:P.resolutionStrategy)&&void 0!==v?v:te.consents.resolutionStrategy.value),f=o.consentManagementMetadata),"custom"===te.consents.provider.value&&(k=void 0),r(function(){te.consents.metadata.value=q(f),te.consents.resolutionStrategy.value=k})},updateDataPlaneEventsStateFromLoadOptions=function(o){if(te.dataPlaneEvents.deliveryEnabled.value){var f="XhrQueue",v=f;te.loadOptions.value.useBeacon&&(te.capabilities.isBeaconAvailable.value?v="BeaconQueue":(v=f,o.warn("".concat(er).concat(":: ","The Beacon API is not supported by your browser. The events will be sent using XHR instead.")))),r(function(){te.dataPlaneEvents.eventsQueuePluginName.value=v})}},getSourceConfigURL=function(o,f,v,P,k){var S=new URLSearchParams({p:"npm",v:eP,build:eQ,writeKey:f,lockIntegrationsVersion:v.toString(),lockPluginsVersion:P.toString()}),A=eq,C=S,I="/sourceConfig/",T="";if(isValidURL(o)){var O=new URL(o);_removeTrailingSlashes(O.pathname).endsWith("/sourceConfig")||(O.pathname="".concat(_removeTrailingSlashes(O.pathname),"/sourceConfig/")),O.pathname=removeDuplicateSlashes(O.pathname),S.forEach(function(o,f){null===O.searchParams.get(f)&&O.searchParams.set(f,o)}),A=O.origin,I=O.pathname,C=O.searchParams,T=O.hash}else k.warn("".concat(er).concat(":: ",'The provided source config URL "').concat(o,'" is invalid. Using the default source config URL instead.'));return"".concat(A).concat(I,"?").concat(C).concat(T)},getSDKComponentBaseURL=function(o,f,v,P,k,S,A){if(S){if(!isValidURL(S))return A.error("".concat(er).concat(":: ",'The base URL "').concat(S,'" for ').concat(o," is not valid.")),null;C=_removeTrailingSlashes(S)}else if(C=v,"cdn"===te.context.app.value.installType){var C,I=getSDKUrl();I&&(C=I.split("/").slice(0,-1).concat(f).join("/"))}return k&&(C=C.replace(new RegExp("/".concat("v3","/").concat(eQ,"/").concat(f,"$")),"/".concat(P,"/").concat(eQ,"/").concat(f))),C},aV=_createClass(function ConfigManager(o,f,v){_classCallCheck(this,ConfigManager),this.errorHandler=f,this.logger=v,this.httpClient=o,this.onError=this.onError.bind(this),this.processConfig=this.processConfig.bind(this)},[{key:"attachEffects",value:function(){var o=this;E(function(){o.logger.setMinLogLevel(te.lifecycle.logLevel.value)})}},{key:"init",value:function(){var o,f=this,v=te.loadOptions.value,P=v.logLevel,k=v.configUrl,S=v.lockIntegrationsVersion,A=v.lockPluginsVersion,C=v.destSDKBaseURL;v.pluginsSDKBaseURL;var I=v.integrations,T=getSDKComponentBaseURL("integrations",eH,e$,eP,S,C,this.logger);isNull(T)||(this.attachEffects(),te.lifecycle.activeDataplaneUrl.value=_removeTrailingSlashes(te.lifecycle.dataPlaneUrl.value),updateStorageStateFromLoadOptions(this.logger),updateConsentsStateFromLoadOptions(this.logger),updateDataPlaneEventsStateFromLoadOptions(this.logger),r(function(){te.lifecycle.integrationsCDNPath.value=T,te.lifecycle.pluginsCDNPath.value=o,P&&(te.lifecycle.logLevel.value=P),te.lifecycle.sourceConfigUrl.value=getSourceConfigURL(k,te.lifecycle.writeKey.value,S,A,f.logger),te.metrics.metricsServiceUrl.value="".concat(te.lifecycle.activeDataplaneUrl.value,"/").concat("rsaMetrics"),te.nativeDestinations.loadOnlyIntegrations.value=I}),this.getConfig())}},{key:"onError",value:function(o,f){this.errorHandler.onError(o,er,f)}},{key:"processConfig",value:function(o,f){if(!isDefined(o)){isDefined(f)?this.onError(f.error,eG):this.onError(Error(eG));return}try{P=isString(o)?JSON.parse(o):o}catch(o){this.onError(o,ej);return}if(!(isObjectLiteralAndNotNull(v=P)&&isObjectLiteralAndNotNull(v.source)&&!isNullOrUndefined(v.source.id)&&isObjectLiteralAndNotNull(v.source.config)&&Array.isArray(v.source.destinations))){this.onError(Error(ej));return}if(!1===P.source.enabled){this.logger.error("The source is disabled. Please enable the source in the dashboard to send events.");return}updateReportingState(P);var v,P,k=P.source.destinations.length>0?filterEnabledDestination(P.source.destinations):[];r(function(){var o;te.source.value={config:P.source.config,name:P.source.name,id:P.source.id,workspaceId:P.source.workspaceId},te.nativeDestinations.configuredDestinations.value=k,te.plugins.pluginsToLoadFromConfig.value=null!==(o=te.loadOptions.value.plugins)&&void 0!==o?o:[],updateConsentsState(P),te.lifecycle.status.value="configured"})}},{key:"getConfig",value:function(){var o=this,f=te.loadOptions.value.getSourceConfig;if(f){if(!isFunction(f)){this.logger.error("".concat(er).concat(":: ",'The "getSourceConfig" load API option must be a function that returns valid source configuration data.'));return}var v=f();v instanceof Promise?v.then(function(f){return o.processConfig(f)}).catch(function(f){o.onError(f,"SourceConfig")}):this.processConfig(v)}else this.httpClient.getAsyncData({url:te.lifecycle.sourceConfigUrl.value,options:{headers:{"Content-Type":void 0}},callback:this.processConfig})}}]),getTimezone=function(){var o=/([A-Z]+[+-]\d+)/.exec(new Date().toString());return null!=o&&o[1]?o[1]:"NA"},getReferrer=function(){var o;return(null===(o=document)||void 0===o?void 0:o.referrer)||"$direct"},getCanonicalUrl=function(){for(var o=document.getElementsByTagName("link"),f="",v=0;o[v];v+=1){var P,k=o[v];if("canonical"===k.getAttribute("rel")&&!f){f=null!==(P=k.getAttribute("href"))&&void 0!==P?P:"";break}}return f},getUserAgent=function(){if(isUndefined(globalThis.navigator))return null;var o=globalThis.navigator.userAgent,f=globalThis.navigator.brave;if(f&&Object.getPrototypeOf(f).isBrave){var v=o.match(/(chrome)\/([\w.]+)/i);v&&(o="".concat(o," Brave/").concat(v[2]))}return o},getLanguage=function(){var o;return isUndefined(globalThis.navigator)?null:null!==(o=globalThis.navigator.language)&&void 0!==o?o:globalThis.navigator.browserLanguage},getDefaultPageProperties=function(){var o=getCanonicalUrl(),f=globalThis.location.pathname,v=globalThis.location.href,P=v,k=globalThis.location.search;if(o)try{var S=new URL(o);P=""===S.search?o+k:o,f=S.pathname}catch(o){}var A=getUrlWithoutHash(P),C=document.title,I=getReferrer();return{path:f,referrer:I,referring_domain:getReferringDomain(I),search:k,title:C,url:A,tab_url:v}},aQ="https://polyfill-fastly.io/v3/polyfill.min.js?version=3.111.0&features=".concat(Object.keys(ax).join("%2C")),aK="rudderstackPolyfill",a$=_createClass(function CapabilitiesManager(o,f,v){_classCallCheck(this,CapabilitiesManager),this.httpClient=o,this.errorHandler=f,this.logger=v,this.externalSrcLoader=new eC(this.errorHandler,this.logger),this.onError=this.onError.bind(this),this.onReady=this.onReady.bind(this)},[{key:"init",value:function(){this.prepareBrowserCapabilities(),this.attachWindowListeners()}},{key:"detectBrowserCapabilities",value:function(){var o=this;r(function(){te.capabilities.storage.isCookieStorageAvailable.value=isStorageAvailable(ty,getStorageEngine(ty),o.logger),te.capabilities.storage.isLocalStorageAvailable.value=isStorageAvailable(tm,void 0,o.logger),te.capabilities.storage.isSessionStorageAvailable.value=isStorageAvailable(t_,void 0,o.logger),te.capabilities.isBeaconAvailable.value=!isNullOrUndefined(globalThis.navigator.sendBeacon)&&isFunction(globalThis.navigator.sendBeacon),te.capabilities.isUaCHAvailable.value=hasUAClientHints(),te.capabilities.isCryptoAvailable.value=!isNullOrUndefined(globalThis.crypto)&&isFunction(globalThis.crypto.getRandomValues),te.capabilities.isIE11.value=!!globalThis.navigator.userAgent.match(/Trident.*rv:11\./),te.capabilities.isOnline.value=globalThis.navigator.onLine,te.context.userAgent.value=getUserAgent(),te.context.locale.value=getLanguage(),te.context.screen.value=getScreenDetails(),te.context.timezone.value=getTimezone(),hasUAClientHints()&&getUserAgentClientHint(function(o){te.context["ua-ch"].value=o},te.loadOptions.value.uaChTrackLevel)}),E(function(){!0===te.loadOptions.value.sendAdblockPage&&void 0!==te.lifecycle.sourceConfigUrl.value&&detectAdBlockers(o.httpClient)})}},{key:"prepareBrowserCapabilities",value:function(){var o=this;te.capabilities.isLegacyDOM.value=isLegacyJSEngine();var f=te.loadOptions.value.polyfillURL,v=aQ;if(isDefinedAndNotNull(f)&&(isValidURL(f)?v=f:this.logger.warn("".concat(en).concat(":: ",'The provided polyfill URL "').concat(f,'" is invalid. The default polyfill URL will be used instead.'))),te.loadOptions.value.polyfillIfRequired&&te.capabilities.isLegacyDOM.value&&isValidURL(v)){var P=v!==te.loadOptions.value.polyfillURL;if(P){var k="RS_polyfillCallback_".concat(te.lifecycle.writeKey.value);globalThis[k]=function(){o.onReady(),delete globalThis[k]},v="".concat(v,"&callback=").concat(k)}this.externalSrcLoader.loadJSFile({url:v,id:aK,async:!0,timeout:1e4,callback:function(f){if(f)P||o.onReady();else{var k;o.onError(Error((k=v,'Failed to load the polyfill script with ID "'.concat(aK,'" from URL ').concat(k,"."))))}}})}else this.onReady()}},{key:"attachWindowListeners",value:function(){globalThis.addEventListener("offline",function(){te.capabilities.isOnline.value=!1}),globalThis.addEventListener("online",function(){te.capabilities.isOnline.value=!0}),globalThis.addEventListener("resize",function(o,f){var v,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:250;return function(){for(var k=arguments.length,S=Array(k),A=0;A<k;A++)S[A]=arguments[A];globalThis.clearTimeout(v),v=globalThis.setTimeout(function(){o.apply(f,S)},P)}}(function(){te.context.screen.value=getScreenDetails()},this))}},{key:"onReady",value:function(){this.detectBrowserCapabilities(),te.lifecycle.status.value="browserCapabilitiesReady"}},{key:"onError",value:function(o){this.errorHandler.onError(o,en)}}]),aW=["integrations","anonymousId","originalTimestamp"],aq=["library","consentManagement","userAgent","ua-ch","screen"],aX=["id","anonymous_id","user_id","sent_at","timestamp","received_at","original_timestamp","event","event_text","channel","context_ip","context_request_ip","context_passed_ip","group_id","previous_id"],isNumber=function(o){return"number"==typeof o&&!Number.isNaN(o)},isPositiveInteger=function(o){return isNumber(o)&&o>=0&&Number.isInteger(o)},isCutOffTimeExceeded=function(o){var f=o.cutOff,v=Date.now();return!!((null==f?void 0:f.enabled)&&f.expiresAt&&v>f.expiresAt)},hasSessionExpired=function(o){return!!(!o.expiresAt||Date.now()>o.expiresAt)||isCutOffTimeExceeded(o)},getCutOffExpirationTimestamp=function(o){var f;if(null!=o&&o.enabled)return null!==(f=o.expiresAt)&&void 0!==f?f:isPositiveInteger(o.duration)?Date.now()+o.duration:void 0},generateAutoTrackingSession=function(o){var f=o.timeout,v=o.cutOff,P=Date.now();return _objectSpread2({id:P,expiresAt:P+f,timeout:f,autoTrack:!0},v&&{cutOff:v})},isStorageTypeValidForStoringData=function(o){return!(o!==ty&&o!==tm&&o!==t_&&o!==tP)},generateAnonymousId=function(){return generateUUID()},getContextPageProperties=function(o){var f=getDefaultPageProperties(),v={};return Object.keys(f).forEach(function(P){v[P]=(null==o?void 0:o[P])||f[P]}),v.initial_referrer=(null==o?void 0:o.initial_referrer)||te.session.initialReferrer.value,v.initial_referring_domain=(null==o?void 0:o.initial_referring_domain)||te.session.initialReferringDomain.value,v},getUpdatedPageProperties=function(o,f){var v=(null==f?void 0:f.page)||{},P=getDefaultPageProperties();return Object.keys(P).forEach(function(f){isUndefined(o[f])&&(o[f]=v[f]||P[f])}),isUndefined(o.initial_referrer)&&(o.initial_referrer=v.initial_referrer||te.session.initialReferrer.value),isUndefined(o.initial_referring_domain)&&(o.initial_referring_domain=v.initial_referring_domain||te.session.initialReferringDomain.value),o},checkForReservedElementsInObject=function(o,f,v){isObjectLiteralAndNotNull(o)&&Object.keys(o).forEach(function(o){(aX.includes(o)||aX.includes(o.toLowerCase()))&&v.warn("".concat(ei).concat(":: ",'The "').concat(o,'" property defined under "').concat(f,'" is a reserved keyword. Please choose a different property name to avoid conflicts with reserved keywords (').concat(aX,")."))})},checkForReservedElements=function(o,f){var v=o.properties,P=o.traits,k=o.context.traits;checkForReservedElementsInObject(v,"properties",f),checkForReservedElementsInObject(P,"traits",f),checkForReservedElementsInObject(k,"context.traits",f)},updateTopLevelEventElements=function(o,f){f.anonymousId&&isString(f.anonymousId)&&(o.anonymousId=f.anonymousId),isNonEmptyObject(f.integrations)&&(o.integrations=f.integrations),f.originalTimestamp&&isString(f.originalTimestamp)&&(o.originalTimestamp=f.originalTimestamp)},getMergedContext=function(o,f,v){var P=o;return Object.keys(f).forEach(function(o){if(!aW.includes(o)&&!aq.includes(o)){if("context"!==o)P=mergeDeepRight(P,_defineProperty({},o,f[o]));else if(!isUndefined(f[o])&&isObjectLiteralAndNotNull(f[o])){var k={};Object.keys(f[o]).forEach(function(v){aq.includes(v)||(k[v]=f[o][v])}),P=mergeDeepRight(P,_objectSpread2({},k))}else v.warn("".concat(ei).concat(":: ",'Please make sure that the "context" property in the event API\'s "options" argument is a valid object literal with key-value pairs.'))}}),P},processOptions=function(o,f,v){isObjectLiteralAndNotNull(f)&&(updateTopLevelEventElements(o,f),o.context=getMergedContext(o.context,f,v))},getEventIntegrationsConfig=function(o){var f;return q(te.loadOptions.value.useGlobalIntegrationsConfigInEvents?null!==(f=te.consents.postConsent.value.integrations)&&void 0!==f?f:te.nativeDestinations.loadOnlyIntegrations.value:o||ez)},getEnrichedEvent=function(o,f,v,P){var k,S,A,C={channel:"web",context:_objectSpread2(_objectSpread2({traits:q(te.session.userTraits.value),sessionId:te.session.sessionInfo.value.id||void 0,sessionStart:te.session.sessionInfo.value.sessionStart||void 0},te.consents.enabled.value&&{consentManagement:{deniedConsentIds:q(te.consents.data.value.deniedConsentIds),allowedConsentIds:q(te.consents.data.value.allowedConsentIds),provider:te.consents.provider.value,resolutionStrategy:te.consents.resolutionStrategy.value}}),{},{"ua-ch":te.context["ua-ch"].value,app:te.context.app.value,library:te.context.library.value,userAgent:te.context.userAgent.value,os:te.context.os.value,locale:te.context.locale.value,screen:te.context.screen.value,campaign:extractUTMParameters(globalThis.location.href),page:getContextPageProperties(v),timezone:te.context.timezone.value},te.autoTrack.enabled.value&&{autoTrack:_objectSpread2({},te.autoTrack.pageLifecycle.enabled.value&&{page:{pageViewId:te.autoTrack.pageLifecycle.pageViewId.value}})}),originalTimestamp:getCurrentTimeFormatted(),messageId:generateUUID(),userId:o.userId||te.session.userId.value};isStorageTypeValidForStoringData(null===(k=te.storage.entries.value.anonymousId)||void 0===k?void 0:k.type)?C.anonymousId=te.session.anonymousId.value:C.anonymousId=generateAnonymousId(),te.storage.trulyAnonymousTracking.value&&(C.context.trulyAnonymousTracking=!0),"identify"===o.type&&(C.context.traits=(null===(S=te.storage.entries.value.userTraits)||void 0===S?void 0:S.type)!==tb?q(te.session.userTraits.value):o.context.traits),"group"===o.type&&((o.groupId||te.session.groupId.value)&&(C.groupId=o.groupId||te.session.groupId.value),(o.traits||te.session.groupTraits.value)&&(C.traits=(null===(A=te.storage.entries.value.groupTraits)||void 0===A?void 0:A.type)!==tb?q(te.session.groupTraits.value):o.traits));var I=mergeDeepRight(o,C);return void 0===I.event&&(I.event=null),void 0===I.properties&&(I.properties=null),processOptions(I,f,P),checkForReservedElements(I,P),I.integrations=getEventIntegrationsConfig(I.integrations),I},aJ=_createClass(function RudderEventFactory(o){_classCallCheck(this,RudderEventFactory),this.logger=o},[{key:"generatePageEvent",value:function(o,f,v,P){var k=null!=v?v:{};return getEnrichedEvent({properties:k=getUpdatedPageProperties(k,P),name:f,category:o,type:"page"},P,k,this.logger)}},{key:"generateTrackEvent",value:function(o,f,v){return getEnrichedEvent({properties:f,event:o,type:"track"},v,void 0,this.logger)}},{key:"generateIdentifyEvent",value:function(o,f,v){return getEnrichedEvent({userId:o,type:"identify",context:{traits:f}},v,void 0,this.logger)}},{key:"generateAliasEvent",value:function(o,f,v){var P=getEnrichedEvent({previousId:f,type:"alias"},v,void 0,this.logger);return P.userId=null!=o?o:P.userId,P}},{key:"generateGroupEvent",value:function(o,f,v){var P={type:"group"};return o&&(P.groupId=o),f&&(P.traits=f),getEnrichedEvent(P,v,void 0,this.logger)}},{key:"create",value:function(o){var f;switch(o.type){case"page":f=this.generatePageEvent(o.category,o.name,o.properties,o.options);break;case"track":f=this.generateTrackEvent(o.name,o.properties,o.options);break;case"identify":f=this.generateIdentifyEvent(o.userId,o.traits,o.options);break;case"alias":f=this.generateAliasEvent(o.to,o.from,o.options);break;default:f=this.generateGroupEvent(o.groupId,o.traits,o.options)}return f}}]),aY=_createClass(function EventManager(o,f,v,P){_classCallCheck(this,EventManager),this.eventRepository=o,this.userSessionManager=f,this.errorHandler=v,this.logger=P,this.eventFactory=new aJ(this.logger)},[{key:"init",value:function(){this.eventRepository.init()}},{key:"resume",value:function(){this.eventRepository.resume()}},{key:"addEvent",value:function(o){this.userSessionManager.refreshSession();var f=this.eventFactory.create(o);this.eventRepository.enqueue(f,o.callback)}}]),aZ=_createClass(function UserSessionManager(o,f,v,P,k){_classCallCheck(this,UserSessionManager),this.storeManager=f,this.pluginsManager=o,this.logger=k,this.errorHandler=P,this.httpClient=v,this.onError=this.onError.bind(this),this.serverSideCookieDebounceFuncs={}},[{key:"init",value:function(){this.syncStorageDataToState(),this.registerEffects()}},{key:"syncStorageDataToState",value:function(){this.migrateStorageIfNeeded(),this.migrateDataFromPreviousStorage(),this.setUserId(this.getUserId()),this.setUserTraits(this.getUserTraits()),this.setGroupId(this.getGroupId()),this.setGroupTraits(this.getGroupTraits());var o,f=te.loadOptions.value,v=f.externalAnonymousIdCookieName,P=f.anonymousIdOptions;isDefinedAndNotNull(v)&&"string"==typeof v&&(o=this.getExternalAnonymousIdByCookieName(v)),this.setAnonymousId(null!=o?o:this.getAnonymousId(P)),this.setAuthToken(this.getAuthToken()),this.setInitialReferrerInfo(),this.configureSessionTracking()}},{key:"configureSessionTracking",value:function(){var o;if(this.isPersistenceEnabledForStorageEntry("sessionInfo")){var f,v,P,k=this.getConfiguredSessionTrackingInfo(),S=null!==(f=this.getSessionInfo())&&void 0!==f?f:e0.sessionInfo;(o={autoTrack:k.autoTrack&&!0!==S.manualTrack,timeout:k.timeout,manualTrack:S.manualTrack,expiresAt:S.expiresAt,id:S.id,sessionStart:S.sessionStart}).autoTrack||!0===o.manualTrack?(null===(v=k.cutOff)||void 0===v?void 0:v.enabled)===!0&&(o.cutOff={enabled:!0,duration:k.cutOff.duration,expiresAt:null===(P=S.cutOff)||void 0===P?void 0:P.expiresAt}):o=e0.sessionInfo}else o=e0.sessionInfo;te.session.sessionInfo.value=o,te.session.sessionInfo.value.autoTrack&&this.startOrRenewAutoTracking(te.session.sessionInfo.value)}},{key:"setInitialReferrerInfo",value:function(){var o=this.getInitialReferrer(),f=this.getInitialReferringDomain();if(o&&f)this.setInitialReferrer(o),this.setInitialReferringDomain(f);else{var v=o||getReferrer();this.setInitialReferrer(v),this.setInitialReferringDomain(getReferringDomain(v))}}},{key:"isPersistenceEnabledForStorageEntry",value:function(o){var f;return isStorageTypeValidForStoringData(null===(f=te.storage.entries.value[o])||void 0===f?void 0:f.type)}},{key:"migrateDataFromPreviousStorage",value:function(){var o=this,f=te.storage.entries.value,v=[ty,tm,t_];Object.keys(f).forEach(function(P){var k,S,A=null===(k=f[P])||void 0===k?void 0:k.type,C=null===(S=o.storeManager)||void 0===S?void 0:S.getStore(aw[A]);C&&v.forEach(function(f){var v,k=null===(v=o.storeManager)||void 0===v?void 0:v.getStore(aw[f]);if(k&&f!==A){var S=k.get(tk[P]);isDefinedAndNotNull(S)&&""!==S&&C.set(tk[P],S),k.remove(tk[P])}})})}},{key:"migrateStorageIfNeeded",value:function(o){var f=this;if(te.storage.migrate.value){var v=null!=o?o:[];0===v.length&&[aT,aO,aD].forEach(function(o){var P,k=null===(P=f.storeManager)||void 0===P?void 0:P.getStore(o);k&&v.push(k)}),Object.keys(tk).forEach(function(o){var P=tk[o];v.forEach(function(o){var v,k=null===(v=f.pluginsManager)||void 0===v?void 0:v.invokeSingle("storage.migrate",P,o.engine,f.errorHandler,f.logger);isNullOrUndefined(k)||o.set(P,k)})})}}},{key:"getConfiguredSessionTrackingInfo",value:function(){var o,f,v,P=!1!==te.loadOptions.value.sessions.autoTrack;if(!P)return{autoTrack:P};var k=null===(f=te.loadOptions.value.sessions)||void 0===f?void 0:f.timeout;isPositiveInteger(k)?v=k:(this.logger.warn("".concat(ea).concat(":: ",'The session timeout value "').concat(k,'" is not a number. The default timeout of ').concat(18e5," ms will be used instead.")),v=18e5),0===v&&(this.logger.warn("".concat(ea).concat(":: ","The session timeout value is 0, which disables the automatic session tracking feature. If you want to enable session tracking, please provide a positive integer value for the timeout.")),P=!1),v>0&&v<1e4&&this.logger.warn((o=v,"".concat(ea).concat(":: ","The session timeout value ").concat(o," ms is less than the recommended minimum of ").concat(1e4," ms. Please consider increasing the timeout value to ensure optimal performance and reliability.")));var S=this.getCutOffInfo(v);return{timeout:v,autoTrack:P,cutOff:S}}},{key:"getCutOffInfo",value:function(o){var f,v,P,k=te.loadOptions.value.sessions.cutOff,S=!1;return!0===k.enabled&&((P=k.duration,S=!0,isPositiveInteger(P))?P<o&&(this.logger.warn((f=P,"".concat(ea).concat(":: ",'The session cut off duration value "').concat(f,'" ms is less than the session timeout value "').concat(o,'" ms. The cut off functionality will be disabled.'))),S=!1):(this.logger.warn((v=P,"".concat(ea).concat(":: ",'The session cut off duration value "').concat(v,'" is not a number. The default cut off duration of ').concat(432e5," ms will be used instead."))),P=432e5)),{enabled:S,duration:P}}},{key:"onError",value:function(o,f){this.errorHandler.onError(o,ea,f)}},{key:"getEncryptedCookieData",value:function(o,f){var v=this,P=[];return o.forEach(function(o){var k=null==f?void 0:f.encrypt(stringifyWithoutCircular(o.value,!1,[],v.logger));isDefinedAndNotNull(k)&&P.push({name:o.name,value:k})}),P}},{key:"makeRequestToSetCookie",value:function(o,f){var v,P,k,S,A,C,I,T;null===(v=this.httpClient)||void 0===v||v.getAsyncData({url:te.serverCookies.dataServiceUrl.value,options:{method:"POST",data:stringifyWithoutCircular({reqType:"setCookies",workspaceId:null===(P=te.source.value)||void 0===P?void 0:P.workspaceId,data:{options:{maxAge:null===(k=te.storage.cookie.value)||void 0===k?void 0:k.maxage,path:null===(S=te.storage.cookie.value)||void 0===S?void 0:S.path,domain:null===(A=te.storage.cookie.value)||void 0===A?void 0:A.domain,sameSite:null===(C=te.storage.cookie.value)||void 0===C?void 0:C.samesite,secure:null===(I=te.storage.cookie.value)||void 0===I?void 0:I.secure,expires:null===(T=te.storage.cookie.value)||void 0===T?void 0:T.expires},cookies:o}}),sendRawData:!0,withCredentials:!0},isRawResponse:!0,callback:f})}},{key:"setServerSideCookies",value:function(o,f,v){var P=this;try{var k=this.getEncryptedCookieData(o,v);k.length>0&&this.makeRequestToSetCookie(k,function(k,S){var A,C,I;(null==S||null===(A=S.xhr)||void 0===A?void 0:A.status)===200?o.forEach(function(o){var k,S=null==v?void 0:v.get(o.name),A=stringifyWithoutCircular(o.value,!1,[]);stringifyWithoutCircular(S,!1,[])!==A&&(P.logger.error((k=o.name,"The server failed to set the ".concat(k," cookie. As a fallback, the cookies will be set client side."))),f&&f(o.name,o.value))}):(P.logger.error((I=null==S||null===(C=S.xhr)||void 0===C?void 0:C.status,"The server responded with status ".concat(I," while setting the cookies. As a fallback, the cookies will be set client side."))),o.forEach(function(o){f&&f(o.name,o.value)}))})}catch(v){this.onError(v,"Failed to set/remove cookies via server. As a fallback, the cookies will be managed client side."),o.forEach(function(o){f&&f(o.name,o.value)})}}},{key:"syncValueToStorage",value:function(o,f){var v,P=this,k=te.storage.entries.value,S=null===(v=k[o])||void 0===v?void 0:v.type;if(isStorageTypeValidForStoringData(S)){var A,C,I=null===(A=this.storeManager)||void 0===A?void 0:A.getStore(aw[S]),T=null===(C=k[o])||void 0===C?void 0:C.key;f&&(isString(f)||isNonEmptyObject(f))?te.serverCookies.isEnabledServerSideCookies.value&&S===ty?(this.serverSideCookieDebounceFuncs[o]&&globalThis.clearTimeout(this.serverSideCookieDebounceFuncs[o]),this.serverSideCookieDebounceFuncs[o]=globalThis.setTimeout(function(){P.setServerSideCookies([{name:T,value:f}],function(o,f){null==I||I.set(o,f)},I)},10)):null==I||I.set(T,f):null==I||I.remove(T)}}},{key:"registerEffects",value:function(){var o=this;aR.forEach(function(f){E(function(){o.syncValueToStorage(f,te.session[f].value)})})}},{key:"setAnonymousId",value:function(o,f){var v,P=o;(isString(o)&&P||(P=void 0),this.isPersistenceEnabledForStorageEntry("anonymousId"))?(!P&&f&&(P=null===(v=this.pluginsManager)||void 0===v?void 0:v.invokeSingle("userSession.anonymousIdGoogleLinker",f)),P=P||generateAnonymousId()):P=e0.anonymousId,te.session.anonymousId.value=P}},{key:"getAnonymousId",value:function(o){if(isStorageTypeValidForStoringData(null===(f=te.storage.entries.value.anonymousId)||void 0===f?void 0:f.type)){var f,v,P=te.session.anonymousId.value;P&&P!==e0.anonymousId||(P=this.getEntryValue("anonymousId")),!P&&o&&(P=null===(v=this.pluginsManager)||void 0===v?void 0:v.invokeSingle("storage.getAnonymousId",getStorageEngine,o)),te.session.anonymousId.value=P||generateAnonymousId()}return te.session.anonymousId.value}},{key:"getEntryValue",value:function(o){var f=te.storage.entries.value,v=null===(P=f[o])||void 0===P?void 0:P.type;if(isStorageTypeValidForStoringData(v)){var P,k,S,A,C=null===(k=this.storeManager)||void 0===k?void 0:k.getStore(aw[v]);this.migrateStorageIfNeeded([C]);var I=null===(S=f[o])||void 0===S?void 0:S.key;return null!==(A=null==C?void 0:C.get(I))&&void 0!==A?A:null}return null}},{key:"getExternalAnonymousIdByCookieName",value:function(o){var f,v=getStorageEngine(ty);return null!=v&&v.isEnabled&&null!==(f=v.getItem(o))&&void 0!==f?f:null}},{key:"getUserId",value:function(){return this.getEntryValue("userId")}},{key:"getUserTraits",value:function(){return this.getEntryValue("userTraits")}},{key:"getGroupId",value:function(){return this.getEntryValue("groupId")}},{key:"getGroupTraits",value:function(){return this.getEntryValue("groupTraits")}},{key:"getInitialReferrer",value:function(){return this.getEntryValue("initialReferrer")}},{key:"getInitialReferringDomain",value:function(){return this.getEntryValue("initialReferringDomain")}},{key:"getSessionInfo",value:function(){return this.getEntryValue("sessionInfo")}},{key:"getAuthToken",value:function(){return this.getEntryValue("authToken")}},{key:"getSessionId",value:function(){var o,f,v=null!==(o=this.getSessionInfo())&&void 0!==o?o:e0.sessionInfo;return(v.autoTrack&&!hasSessionExpired(v)||v.manualTrack)&&null!==(f=v.id)&&void 0!==f?f:null}},{key:"refreshSession",value:function(){var o,f=null!==(o=this.getSessionInfo())&&void 0!==o?o:e0.sessionInfo;(f.autoTrack||f.manualTrack)&&(f.autoTrack&&(this.startOrRenewAutoTracking(f),f=te.session.sessionInfo.value),void 0===f.sessionStart?f=_objectSpread2(_objectSpread2({},f),{},{sessionStart:!0}):f.sessionStart&&(f=_objectSpread2(_objectSpread2({},f),{},{sessionStart:!1}))),te.session.sessionInfo.value=f,"readyExecuted"!==te.lifecycle.status.value&&this.syncValueToStorage("sessionInfo",f)}},{key:"reset",value:function(o,f){var v=this,P=te.session,k=P.sessionInfo.value,S=k.manualTrack,A=k.autoTrack,C=k.timeout,I=k.cutOff;r(function(){if(P.userId.value=e0.userId,P.userTraits.value=e0.userTraits,P.groupId.value=e0.groupId,P.groupTraits.value=e0.groupTraits,P.authToken.value=e0.authToken,!0===o&&v.setAnonymousId(),!f){if(A){var k=_objectSpread2(_objectSpread2({},e0.sessionInfo),{},{timeout:C});I&&(k.cutOff={enabled:I.enabled,duration:I.duration}),P.sessionInfo.value=k,v.startOrRenewAutoTracking(P.sessionInfo.value)}else S&&v.startManualTrackingInternal()}})}},{key:"setUserId",value:function(o){te.session.userId.value=this.isPersistenceEnabledForStorageEntry("userId")&&o?o:e0.userId}},{key:"setUserTraits",value:function(o){var f;te.session.userTraits.value=this.isPersistenceEnabledForStorageEntry("userTraits")&&isObjectLiteralAndNotNull(o)?mergeDeepRight(null!==(f=te.session.userTraits.value)&&void 0!==f?f:e0.userTraits,o):e0.userTraits}},{key:"setGroupId",value:function(o){te.session.groupId.value=this.isPersistenceEnabledForStorageEntry("groupId")&&o?o:e0.groupId}},{key:"setGroupTraits",value:function(o){var f;te.session.groupTraits.value=this.isPersistenceEnabledForStorageEntry("groupTraits")&&isObjectLiteralAndNotNull(o)?mergeDeepRight(null!==(f=te.session.groupTraits.value)&&void 0!==f?f:e0.groupTraits,o):e0.groupTraits}},{key:"setInitialReferrer",value:function(o){te.session.initialReferrer.value=this.isPersistenceEnabledForStorageEntry("initialReferrer")&&o?o:e0.initialReferrer}},{key:"setInitialReferringDomain",value:function(o){te.session.initialReferringDomain.value=this.isPersistenceEnabledForStorageEntry("initialReferringDomain")&&o?o:e0.initialReferringDomain}},{key:"startOrRenewAutoTracking",value:function(o){var f=o;if(hasSessionExpired(o))f=generateAutoTrackingSession(o);else{var v=Date.now(),P=o.timeout;f.expiresAt=v+P}if(isCutOffTimeExceeded(f)&&(f.cutOff.expiresAt=void 0),f.cutOff){var k=getCutOffExpirationTimestamp(f.cutOff);f.cutOff.expiresAt=k}te.session.sessionInfo.value=f}},{key:"start",value:function(o){var f,v;te.session.sessionInfo.value={id:(f=o,v=this.logger,f&&isPositiveInteger(f)&&f.toString().length>=10||(v.warn("".concat(ea).concat(":: ","The provided session ID (").concat(f,') is either invalid, not a positive integer, or not at least "').concat(10,'" digits long. A new session ID will be auto-generated instead.')),0))?o:Date.now(),sessionStart:void 0,manualTrack:!0}}},{key:"startManualTrackingInternal",value:function(){this.start(Date.now())}},{key:"end",value:function(){te.session.sessionInfo.value=e0.sessionInfo}},{key:"setAuthToken",value:function(o){te.session.authToken.value=this.isPersistenceEnabledForStorageEntry("authToken")&&o?o:e0.authToken}}]),a0=["BeaconQueue","CustomConsentManager","DeviceModeDestinations","DeviceModeTransformation","ExternalAnonymousId","GoogleLinker","IubendaConsentManager","KetchConsentManager","NativeDestinationQueue","OneTrustConsentManager","StorageEncryption","StorageEncryptionLegacy","StorageMigrator","XhrQueue"],normalizeLoadOptions=function(o,f){var v,P=q(f);return isString(P.setCookieDomain)||(P.setCookieDomain=void 0),["Strict","Lax","None"].includes(P.sameSiteCookie)||(P.sameSiteCookie=void 0),P.secureCookie=getNormalizedBooleanValue(P.secureCookie,o.secureCookie),P.sameDomainCookiesOnly=getNormalizedBooleanValue(P.sameDomainCookiesOnly,o.sameDomainCookiesOnly),["none","default","full"].includes(P.uaChTrackLevel)||(P.uaChTrackLevel=void 0),P.integrations=getNormalizedObjectValue(P.integrations),Array.isArray(P.plugins)||(P.plugins=a0),P.useGlobalIntegrationsConfigInEvents=getNormalizedBooleanValue(P.useGlobalIntegrationsConfigInEvents,o.useGlobalIntegrationsConfigInEvents),P.bufferDataPlaneEventsUntilReady=getNormalizedBooleanValue(P.bufferDataPlaneEventsUntilReady,o.bufferDataPlaneEventsUntilReady),P.sendAdblockPage=getNormalizedBooleanValue(P.sendAdblockPage,o.sendAdblockPage),P.useServerSideCookies=getNormalizedBooleanValue(P.useServerSideCookies,o.useServerSideCookies),isString(P.dataServiceEndpoint)||(P.dataServiceEndpoint=void 0),P.sendAdblockPageOptions=getNormalizedObjectValue(P.sendAdblockPageOptions),P.loadIntegration=getNormalizedBooleanValue(P.loadIntegration,o.loadIntegration),isNonEmptyObject(P.storage)?(P.storage.migrate=getNormalizedBooleanValue(P.storage.migrate,null===(v=o.storage)||void 0===v?void 0:v.migrate),P.storage.cookie=getNormalizedObjectValue(P.storage.cookie),P.storage.encryption=getNormalizedObjectValue(P.storage.encryption),P.storage=_removeUndefinedAndNullValues(P.storage)):P.storage=void 0,P.destinationsQueueOptions=getNormalizedObjectValue(P.destinationsQueueOptions),P.queueOptions=getNormalizedObjectValue(P.queueOptions),P.lockIntegrationsVersion=getNormalizedBooleanValue(P.lockIntegrationsVersion,o.lockIntegrationsVersion),P.lockPluginsVersion=getNormalizedBooleanValue(P.lockPluginsVersion,o.lockPluginsVersion),isNumber(P.dataPlaneEventsBufferTimeout)||(P.dataPlaneEventsBufferTimeout=void 0),P.beaconQueueOptions=getNormalizedObjectValue(P.beaconQueueOptions),P.preConsent=getNormalizedObjectValue(P.preConsent),mergeDeepRight(o,_removeUndefinedAndNullValues(P))},a1="dataplaneEventsQueue",a2="destinationsEventsQueue",getFinalEvent=function(o,f){var v,P=q(o),k=f.nativeDestinations.integrationsConfig.value,S=Object.keys(v=o.integrations).filter(function(o){return!0!==v[o]||!k[o]}).reduce(function(o,f){var P=q(o);return P[f]=v[f],P},{});return P.integrations=mergeDeepRight(k,S),P},shouldBufferEventsForPreConsent=function(o){var f;return o.consents.preConsent.value.enabled&&(null===(f=o.consents.preConsent.value.events)||void 0===f?void 0:f.delivery)==="buffer"},safelyInvokeCallback=function(o,f,v,P){if(isDefined(o)){if(isFunction(o))try{o.apply(void 0,_toConsumableArray(f))}catch(o){P.error("".concat(v).concat(":: ","The callback threw an exception"),o)}else P.error(INVALID_CALLBACK_FN_ERROR(v))}},a4=_createClass(function EventRepository(o,f,v,P,k){_classCallCheck(this,EventRepository),this.pluginsManager=o,this.errorHandler=P,this.httpClient=v,this.logger=k,this.storeManager=f},[{key:"init",value:function(){var o,f=this;this.dataplaneEventsQueue=this.pluginsManager.invokeSingle("".concat(a1,".init"),te,this.httpClient,this.storeManager,this.errorHandler,this.logger),this.dmtEventsQueue=this.pluginsManager.invokeSingle("".concat("transformEvent",".init"),te,this.pluginsManager,this.httpClient,this.storeManager,this.errorHandler,this.logger),this.destinationsEventsQueue=this.pluginsManager.invokeSingle("".concat(a2,".init"),te,this.pluginsManager,this.storeManager,this.dmtEventsQueue,this.errorHandler,this.logger),E(function(){if(!0===te.nativeDestinations.clientDestinationsReady.value){var o,v;null===(o=f.destinationsEventsQueue)||void 0===o||o.start(),null===(v=f.dmtEventsQueue)||void 0===v||v.start()}});var v=shouldBufferEventsForPreConsent(te);E(function(){var P,k,S=!0===te.loadOptions.value.bufferDataPlaneEventsUntilReady&&!1===te.nativeDestinations.clientDestinationsReady.value;!1!==te.nativeDestinations.activeDestinations.value.some(function(o){return isHybridModeDestination(o)})&&!1!==S||v||(null===(P=f.dataplaneEventsQueue)||void 0===P?void 0:P.scheduleTimeoutActive)===!0||(globalThis.clearTimeout(o),null===(k=f.dataplaneEventsQueue)||void 0===k||k.start())}),!0===te.loadOptions.value.bufferDataPlaneEventsUntilReady&&(o=globalThis.setTimeout(function(){var o,v;(null===(o=f.dataplaneEventsQueue)||void 0===o?void 0:o.scheduleTimeoutActive)!==!0&&(null===(v=f.dataplaneEventsQueue)||void 0===v||v.start())},te.loadOptions.value.dataPlaneEventsBufferTimeout))}},{key:"resume",value:function(){var o,f,v,P;(null===(o=this.dataplaneEventsQueue)||void 0===o?void 0:o.scheduleTimeoutActive)!==!0&&(te.consents.postConsent.value.discardPreConsentEvents&&(null===(v=this.dataplaneEventsQueue)||void 0===v||v.clear(),null===(P=this.destinationsEventsQueue)||void 0===P||P.clear()),null===(f=this.dataplaneEventsQueue)||void 0===f||f.start())}},{key:"enqueue",value:function(o,f){var v=getFinalEvent(o,te);this.pluginsManager.invokeSingle("".concat(a1,".enqueue"),te,this.dataplaneEventsQueue,v,this.errorHandler,this.logger);var P=q(o);this.pluginsManager.invokeSingle("".concat(a2,".enqueue"),te,this.destinationsEventsQueue,P,this.errorHandler,this.logger),safelyInvokeCallback(f,[v],"".concat(o.type.charAt(0).toUpperCase()).concat(o.type.slice(1)).concat("API"),this.logger)}}]),dispatchSDKEvent=function(o){var f=new CustomEvent(o,{detail:{analyticsInstance:globalThis.rudderanalytics},bubbles:!0,cancelable:!0,composed:!0});globalThis.document.dispatchEvent(f)},a5=_createClass(function Analytics(){_classCallCheck(this,Analytics),this.preloadBuffer=new eN,this.initialized=!1,this.errorHandler=tg,this.logger=ex,this.externalSrcLoader=new eC(this.errorHandler,this.logger),this.httpClient=tc,this.httpClient.init(this.errorHandler),this.capabilitiesManager=new a$(this.httpClient,this.errorHandler,this.logger)},[{key:"load",value:function(o,f){var v,P=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!te.lifecycle.status.value){if(!(isString(o)&&o.trim().length>0)){this.logger.error("".concat(ed).concat(":: ",'The write key "').concat(o,'" is invalid. It must be a non-empty string. Please check that the write key is correct and try again.'));return}if(!isValidURL(f)){this.logger.error("".concat(ed).concat(":: ",'The data plane URL "').concat(f,'" is invalid. It must be a valid URL string. Please check that the data plane URL is correct and try again.'));return}r(function(){te.lifecycle.writeKey.value=q(o),te.lifecycle.dataPlaneUrl.value=q(f),te.loadOptions.value=normalizeLoadOptions(te.loadOptions.value,P),te.lifecycle.status.value="mounted"}),this.logger.setMinLogLevel(null!==(v=te.loadOptions.value.logLevel)&&void 0!==v?v:eL),setExposedGlobal("state",te,o),this.startLifecycle()}}},{key:"startLifecycle",value:function(){var o=this;E(function(){try{switch(te.lifecycle.status.value){case"mounted":o.onMounted();break;case"browserCapabilitiesReady":o.onBrowserCapabilitiesReady();break;case"configured":o.onConfigured();break;case"pluginsLoading":case"destinationsLoading":break;case"pluginsReady":o.onPluginsReady();break;case"initialized":o.onInitialized();break;case"loaded":o.onLoaded();break;case"destinationsReady":o.onDestinationsReady();break;case"ready":o.onReady()}}catch(f){o.errorHandler.onError(getMutatedError(f,"Failed to load the SDK"),ed)}})}},{key:"onBrowserCapabilitiesReady",value:function(){retrievePreloadBufferEvents(this),this.prepareInternalServices(),this.loadConfig()}},{key:"onLoaded",value:function(){this.processBufferedEvents(),!0===te.consents.preConsent.value.enabled?te.lifecycle.status.value="ready":this.loadDestinations()}},{key:"onMounted",value:function(){this.capabilitiesManager.init()}},{key:"enqueuePreloadBufferEvents",value:function(o){var f=this;Array.isArray(o)&&o.forEach(function(o){return f.preloadBuffer.enqueue(q(o))})}},{key:"processDataInPreloadBuffer",value:function(){for(;this.preloadBuffer.size()>0;){var o=this.preloadBuffer.dequeue();o&&consumePreloadBufferedEvent(_toConsumableArray(o),this)}}},{key:"prepareInternalServices",value:function(){this.pluginsManager=new aI(tv,this.errorHandler,this.logger),this.storeManager=new aG(this.pluginsManager,this.errorHandler,this.logger),this.configManager=new aV(this.httpClient,this.errorHandler,this.logger),this.userSessionManager=new aZ(this.pluginsManager,this.storeManager,this.httpClient,this.errorHandler,this.logger),this.eventRepository=new a4(this.pluginsManager,this.storeManager,this.httpClient,this.errorHandler,this.logger),this.eventManager=new aY(this.eventRepository,this.userSessionManager,this.errorHandler,this.logger)}},{key:"loadConfig",value:function(){var o;te.lifecycle.writeKey.value&&this.httpClient.setAuthHeader(te.lifecycle.writeKey.value),null===(o=this.configManager)||void 0===o||o.init()}},{key:"onPluginsReady",value:function(){var o,f,v,P,k;null===(o=this.storeManager)||void 0===o||o.init(),null===(f=this.userSessionManager)||void 0===f||f.init(),te.consents.enabled.value&&!te.consents.initialized.value&&(null===(P=this.pluginsManager)||void 0===P||P.invokeSingle("consentManager.init",te,this.logger),!1===te.consents.preConsent.value.enabled&&(null===(k=this.pluginsManager)||void 0===k||k.invokeSingle("consentManager.updateConsentsInfo",te,this.storeManager,this.logger))),null===(v=this.eventManager)||void 0===v||v.init(),te.lifecycle.status.value="initialized"}},{key:"onConfigured",value:function(){var o;null===(o=this.pluginsManager)||void 0===o||o.init()}},{key:"onInitialized",value:function(){this.processDataInPreloadBuffer(),safelyInvokeCallback(te.loadOptions.value.onLoaded,[globalThis.rudderanalytics],ec,this.logger),r(function(){te.lifecycle.loaded.value=!0,te.lifecycle.status.value="loaded"}),this.initialized=!0,dispatchSDKEvent("RSA_Initialised")}},{key:"onReady",value:function(){var o=this;te.lifecycle.status.value="readyExecuted",te.eventBuffer.readyCallbacksArray.value.forEach(function(f){safelyInvokeCallback(f,[],eu,o.logger)}),dispatchSDKEvent("RSA_Ready")}},{key:"processBufferedEvents",value:function(){for(var o=te.eventBuffer.toBeProcessedArray.value;o.length>0;){var f=o.shift();if(te.eventBuffer.toBeProcessedArray.value=o,f){var v=f[0];isFunction(this[v])&&this[v].apply(this,_toConsumableArray(f.slice(1)).concat([!0]))}o=te.eventBuffer.toBeProcessedArray.value}}},{key:"loadDestinations",value:function(){if("destinationsLoading"!==te.lifecycle.status.value&&"destinationsReady"!==te.lifecycle.status.value){null===(o=this.pluginsManager)||void 0===o||o.invokeSingle("nativeDestinations.setActiveDestinations",te,this.pluginsManager,this.errorHandler,this.logger);var o,f,v=te.nativeDestinations.activeDestinations.value.length;if(0===v){te.lifecycle.status.value="destinationsReady";return}te.lifecycle.status.value="destinationsLoading",null===(f=this.pluginsManager)||void 0===f||f.invokeSingle("nativeDestinations.load",te,this.externalSrcLoader,this.errorHandler,this.logger),E(function(){(0===v||te.nativeDestinations.initializedDestinations.value.length+te.nativeDestinations.failedDestinations.value.length===v)&&r(function(){te.lifecycle.status.value="destinationsReady",te.nativeDestinations.clientDestinationsReady.value=!0})})}}},{key:"onDestinationsReady",value:function(){"ready"!==te.lifecycle.status.value&&(te.lifecycle.status.value="ready")}},{key:"ready",value:function(o){var f="ready";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[f,o]]);return}if(this.errorHandler.leaveBreadcrumb("New ".concat(f," invocation")),!isFunction(o)){this.logger.error(INVALID_CALLBACK_FN_ERROR(eu));return}"readyExecuted"===te.lifecycle.status.value?safelyInvokeCallback(o,[],eu,this.logger):te.eventBuffer.readyCallbacksArray.value=[].concat(_toConsumableArray(te.eventBuffer.readyCallbacksArray.value),[o])}},{key:"page",value:function(o){var f,v="page";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[v,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(v," event")),te.metrics.triggered.value+=1,null===(f=this.eventManager)||void 0===f||f.addEvent({type:"page",category:o.category,name:o.name,properties:o.properties,options:o.options,callback:o.callback}),!0===te.capabilities.isAdBlocked.value&&o.category!==eb&&this.page(pageArgumentsToCallOptions(eb,"ad-block page request",{path:"/ad-blocked"},te.loadOptions.value.sendAdblockPageOptions))}},{key:"track",value:function(o){var f,v="track";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[v,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(v," event - ").concat(o.name)),te.metrics.triggered.value+=1,null===(f=this.eventManager)||void 0===f||f.addEvent({type:v,name:o.name||void 0,properties:o.properties,options:o.options,callback:o.callback})}},{key:"identify",value:function(o){var f,v,P,k="identify";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[k,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(k," event")),te.metrics.triggered.value+=1,o.userId&&te.session.userId.value&&o.userId!==te.session.userId.value&&this.reset(),isNull(o.userId)||null===(P=this.userSessionManager)||void 0===P||P.setUserId(o.userId),null===(f=this.userSessionManager)||void 0===f||f.setUserTraits(o.traits),null===(v=this.eventManager)||void 0===v||v.addEvent({type:k,userId:o.userId,traits:o.traits,options:o.options,callback:o.callback})}},{key:"alias",value:function(o){var f,v,P,k="alias";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[k,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(k," event")),te.metrics.triggered.value+=1;var S=null!==(f=o.from)&&void 0!==f?f:this.getUserId()||(null===(v=this.userSessionManager)||void 0===v?void 0:v.getAnonymousId());null===(P=this.eventManager)||void 0===P||P.addEvent({type:k,to:o.to,from:S,options:o.options,callback:o.callback})}},{key:"group",value:function(o){var f,v,P,k="group";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[k,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(k," event")),te.metrics.triggered.value+=1,isNull(o.groupId)||null===(P=this.userSessionManager)||void 0===P||P.setGroupId(o.groupId),null===(f=this.userSessionManager)||void 0===f||f.setGroupTraits(o.traits),null===(v=this.eventManager)||void 0===v||v.addEvent({type:k,groupId:o.groupId,traits:o.traits,options:o.options,callback:o.callback})}},{key:"reset",value:function(o){var f,v="reset";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[v,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(v," invocation, resetAnonymousId: ").concat(o)),null===(f=this.userSessionManager)||void 0===f||f.reset(o)}},{key:"getAnonymousId",value:function(o){var f;return null===(f=this.userSessionManager)||void 0===f?void 0:f.getAnonymousId(o)}},{key:"setAnonymousId",value:function(o,f){var v,P="setAnonymousId";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[P,o,f]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(P," invocation")),null===(v=this.userSessionManager)||void 0===v||v.setAnonymousId(o,f)}},{key:"getUserId",value:function(){return te.session.userId.value}},{key:"getUserTraits",value:function(){return te.session.userTraits.value}},{key:"getGroupId",value:function(){return te.session.groupId.value}},{key:"getGroupTraits",value:function(){return te.session.groupTraits.value}},{key:"startSession",value:function(o){var f,v="startSession";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[v,o]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(v," invocation")),null===(f=this.userSessionManager)||void 0===f||f.start(o)}},{key:"endSession",value:function(){var o,f="endSession";if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[[f]]);return}this.errorHandler.leaveBreadcrumb("New ".concat(f," invocation")),null===(o=this.userSessionManager)||void 0===o||o.end()}},{key:"getSessionId",value:function(){var o,f=null===(o=this.userSessionManager)||void 0===o?void 0:o.getSessionId();return null!=f?f:null}},{key:"consent",value:function(o){var f,v,P,k,S=this,A=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!te.lifecycle.loaded.value){te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[["consent",o]]);return}this.errorHandler.leaveBreadcrumb("New consent invocation"),r(function(){te.consents.preConsent.value=_objectSpread2(_objectSpread2({},te.consents.preConsent.value),{},{enabled:!1}),te.consents.postConsent.value=getValidPostConsentOptions(o);var f=getConsentManagementData(te.consents.postConsent.value.consentManagement,S.logger),v=f.initialized,P=f.consentsData;te.consents.initialized.value=v,te.consents.data.value=P}),te.consents.enabled.value&&!te.consents.initialized.value&&(null===(f=this.pluginsManager)||void 0===f||f.invokeSingle("consentManager.updateConsentsInfo",te,this.storeManager,this.logger)),null===(v=this.storeManager)||void 0===v||v.initializeStorageState(),null===(P=this.userSessionManager)||void 0===P||P.syncStorageDataToState(),null===(k=this.eventManager)||void 0===k||k.resume(),this.loadDestinations(),this.sendTrackingEvents(A)}},{key:"sendTrackingEvents",value:function(o){if(te.consents.postConsent.value.trackConsent){var f=trackArgumentsToCallOptions("Consent Management Interaction");o?te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[["track",f]]):this.track(f)}if(te.consents.postConsent.value.sendPageEvent){var v=pageArgumentsToCallOptions();o?te.eventBuffer.toBeProcessedArray.value=[].concat(_toConsumableArray(te.eventBuffer.toBeProcessedArray.value),[["page",v]]):this.page(v)}}},{key:"setAuthToken",value:function(o){var f;null===(f=this.userSessionManager)||void 0===f||f.setAuthToken(o)}}]),a3=function(){function RudderAnalytics(){_classCallCheck(this,RudderAnalytics),_defineProperty(this,"analyticsInstances",{}),_defineProperty(this,"defaultAnalyticsKey",""),_defineProperty(this,"logger",ex);try{if(RudderAnalytics.globalSingleton)return RudderAnalytics.globalSingleton;RudderAnalytics.initializeGlobalResources(),this.setDefaultInstanceKey=this.setDefaultInstanceKey.bind(this),this.getAnalyticsInstance=this.getAnalyticsInstance.bind(this),this.load=this.load.bind(this),this.ready=this.ready.bind(this),this.triggerBufferedLoadEvent=this.triggerBufferedLoadEvent.bind(this),this.page=this.page.bind(this),this.track=this.track.bind(this),this.identify=this.identify.bind(this),this.alias=this.alias.bind(this),this.group=this.group.bind(this),this.reset=this.reset.bind(this),this.getAnonymousId=this.getAnonymousId.bind(this),this.setAnonymousId=this.setAnonymousId.bind(this),this.getUserId=this.getUserId.bind(this),this.getUserTraits=this.getUserTraits.bind(this),this.getGroupId=this.getGroupId.bind(this),this.getGroupTraits=this.getGroupTraits.bind(this),this.startSession=this.startSession.bind(this),this.endSession=this.endSession.bind(this),this.getSessionId=this.getSessionId.bind(this),this.setAuthToken=this.setAuthToken.bind(this),this.consent=this.consent.bind(this),RudderAnalytics.globalSingleton=this,te.autoTrack.pageLifecycle.pageViewId.value=generateUUID(),te.autoTrack.pageLifecycle.pageLoadedTimestamp.value=Date.now(),this.triggerBufferedLoadEvent(),globalThis.rudderanalytics=this}catch(o){dispatchErrorEvent(o)}}return _createClass(RudderAnalytics,[{key:"setDefaultInstanceKey",value:function(o){isString(o)&&o&&(this.defaultAnalyticsKey=o)}},{key:"getAnalyticsInstance",value:function(o){try{var f=o;return isString(f)&&f||(f=this.defaultAnalyticsKey),this.analyticsInstances[f]||(this.analyticsInstances[f]=new a5),this.analyticsInstances[f]}catch(o){dispatchErrorEvent(o);return}}},{key:"load",value:function(o,f,v){try{if(this.analyticsInstances[o])return;this.setDefaultInstanceKey(o),this.trackPageLifecycleEvents(v);var P,k=getExposedGlobal(ek);promotePreloadedConsentEventsToTop(k),setExposedGlobal(ek,q(k)),null===(P=this.getAnalyticsInstance(o))||void 0===P||P.load(o,f,getSanitizedValue(v))}catch(o){dispatchErrorEvent(o)}}},{key:"trackPageLifecycleEvents",value:function(o){var f=null!=o?o:{},v=f.autoTrack,P=f.useBeacon,k=null!=v?v:{},S=k.enabled,A=void 0!==S&&S,C=k.options,I=k.pageLifecycle,T=null!=I?I:{},O=T.events,D=void 0===O?[et.UNLOADED]:O,R=T.enabled,N=void 0===R?A:R,M=T.options,L=void 0===M?void 0===C?{}:C:M;te.autoTrack.pageLifecycle.enabled.value=N,te.autoTrack.enabled.value=A||N,N&&this.setupPageUnloadTracking(D,P,L)}},{key:"setupPageUnloadTracking",value:function(o,f,v){var P=this;(0===o.length||o.includes(et.UNLOADED))&&(!0===f?onPageLeave(function(o){if(!1===o&&te.lifecycle.loaded.value){var f=Date.now(),k=f-te.autoTrack.pageLifecycle.pageLoadedTimestamp.value;P.track(et.UNLOADED,{timeOnPage:k},_objectSpread2(_objectSpread2({},v),{},{originalTimestamp:getFormattedTimestamp(new Date(f))}))}}):this.logger.warn("".concat("RudderStackAnalytics").concat(":: ",'Page Unloaded event can only be tracked when the Beacon transport is active. Please enable "useBeacon" load API option.')))}},{key:"triggerBufferedLoadEvent",value:function(){var o=Array.isArray(globalThis.rudderanalytics)?globalThis.rudderanalytics:[],f=getPreloadedLoadEvent(o);setExposedGlobal(ek,q(_toConsumableArray(o))),f.length>0&&(f.shift(),this.load.apply(null,f))}},{key:"ready",value:function(o){try{var f;null===(f=this.getAnalyticsInstance())||void 0===f||f.ready(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o)}}},{key:"page",value:function(o,f,v,P,k){try{var S;null===(S=this.getAnalyticsInstance())||void 0===S||S.page(pageArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P),getSanitizedValue(k)))}catch(o){dispatchErrorEvent(o)}}},{key:"track",value:function(o,f,v,P){try{var k;null===(k=this.getAnalyticsInstance())||void 0===k||k.track(trackArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))}catch(o){dispatchErrorEvent(o)}}},{key:"identify",value:function(o,f,v,P){try{var k;null===(k=this.getAnalyticsInstance())||void 0===k||k.identify(identifyArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))}catch(o){dispatchErrorEvent(o)}}},{key:"alias",value:function(o,f,v,P){try{var k;null===(k=this.getAnalyticsInstance())||void 0===k||k.alias(aliasArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))}catch(o){dispatchErrorEvent(o)}}},{key:"group",value:function(o,f,v,P){try{var k;null===(k=this.getAnalyticsInstance())||void 0===k||k.group(groupArgumentsToCallOptions(getSanitizedValue(o),getSanitizedValue(f),getSanitizedValue(v),getSanitizedValue(P)))}catch(o){dispatchErrorEvent(o)}}},{key:"reset",value:function(o){try{var f;null===(f=this.getAnalyticsInstance())||void 0===f||f.reset(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o)}}},{key:"getAnonymousId",value:function(o){try{var f;return null===(f=this.getAnalyticsInstance())||void 0===f?void 0:f.getAnonymousId(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o);return}}},{key:"setAnonymousId",value:function(o,f){try{var v;null===(v=this.getAnalyticsInstance())||void 0===v||v.setAnonymousId(getSanitizedValue(o),getSanitizedValue(f))}catch(o){dispatchErrorEvent(o)}}},{key:"getUserId",value:function(){try{var o;return null===(o=this.getAnalyticsInstance())||void 0===o?void 0:o.getUserId()}catch(o){dispatchErrorEvent(o);return}}},{key:"getUserTraits",value:function(){try{var o;return null===(o=this.getAnalyticsInstance())||void 0===o?void 0:o.getUserTraits()}catch(o){dispatchErrorEvent(o);return}}},{key:"getGroupId",value:function(){try{var o;return null===(o=this.getAnalyticsInstance())||void 0===o?void 0:o.getGroupId()}catch(o){dispatchErrorEvent(o);return}}},{key:"getGroupTraits",value:function(){try{var o;return null===(o=this.getAnalyticsInstance())||void 0===o?void 0:o.getGroupTraits()}catch(o){dispatchErrorEvent(o);return}}},{key:"startSession",value:function(o){try{var f;null===(f=this.getAnalyticsInstance())||void 0===f||f.startSession(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o)}}},{key:"endSession",value:function(){try{var o;null===(o=this.getAnalyticsInstance())||void 0===o||o.endSession()}catch(o){dispatchErrorEvent(o)}}},{key:"getSessionId",value:function(){try{var o;return null===(o=this.getAnalyticsInstance())||void 0===o?void 0:o.getSessionId()}catch(o){dispatchErrorEvent(o);return}}},{key:"setAuthToken",value:function(o){try{var f;null===(f=this.getAnalyticsInstance())||void 0===f||f.setAuthToken(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o)}}},{key:"consent",value:function(o){try{var f;null===(f=this.getAnalyticsInstance())||void 0===f||f.consent(getSanitizedValue(o))}catch(o){dispatchErrorEvent(o)}}}],[{key:"initializeGlobalResources",value:function(){tg.init(),aU.configure(),aF.configure(),aB.configure(),aN.configure()}}])}();_defineProperty(a3,"globalSingleton",null)}}]);
//# 